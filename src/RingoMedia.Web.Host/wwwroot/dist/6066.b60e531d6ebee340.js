"use strict";(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[6066],{6066:(I,s,o)=>{o.r(s),o.d(s,{ValidateTwoFactorCodeModule:()=>w});var m=o(60263),d=o(77587),p=o(64369),u=o(40506),g=o(97739),h=o(85079),e=o(6435),f=o(96111),C=o(11405),i=o(34182),v=o(82659),S=o(26133),F=o(69808),y=o(73565);function M(t,r){if(1&t){const n=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",12),e.\u0275\u0275elementStart(1,"label",13),e.\u0275\u0275elementStart(2,"input",14),e.\u0275\u0275listener("ngModelChange",function(l){return e.\u0275\u0275restoreView(n),e.\u0275\u0275nextContext().loginService.authenticateModel.rememberClient=l}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"span",15),e.\u0275\u0275text(4),e.\u0275\u0275pipe(5,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()}if(2&t){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("ngModel",n.loginService.authenticateModel.rememberClient),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(5,2,"RememberThisBrowser")," ")}}function T(t,r){if(1&t&&(e.\u0275\u0275elementStart(0,"span",16),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"localize"),e.\u0275\u0275pipe(3,"localize"),e.\u0275\u0275elementEnd()),2&t){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" ",e.\u0275\u0275pipeBind1(2,2,"RemainingTime"),": ",e.\u0275\u0275pipeBind2(3,4,"SecondShort{0}",n.remainingSeconds),". ")}}const b=[{path:"",component:(()=>{class t extends u.c{constructor(n,a,l,c){super(n),this.loginService=a,this._reCaptchaV3Service=l,this._router=c,this.recaptchaSiteKey=h.g.recaptchaSiteKey,this.submitting=!1,this.remainingSeconds=90}get useCaptcha(){return this.setting.getBoolean("App.UserManagement.UseCaptchaOnLogin")}canActivate(){return!(!this.loginService.authenticateModel||!this.loginService.authenticateResult)}ngOnInit(){if(!this.canActivate())return void this._router.navigate(["account/login"]);this.remainingSeconds=this.appSession.application.twoFactorCodeExpireSeconds;const n=(0,g.H)(1e3,1e3);this.timerSubscription=n.subscribe(()=>{this.remainingSeconds=this.remainingSeconds-1,0===this.remainingSeconds&&this.message.warn(this.l("TimeoutPleaseTryAgain")).then(()=>{this.loginService.authenticateModel.twoFactorVerificationCode=null,this._router.navigate(["account/login"])})})}ngOnDestroy(){this.timerSubscription&&(this.timerSubscription.unsubscribe(),this.timerSubscription=null)}submit(){let n=a=>{this.loginService.authenticateModel.twoFactorVerificationCode=this.code,this.loginService.authenticate(()=>{},null,a)};this.useCaptcha?this._reCaptchaV3Service.execute(this.recaptchaSiteKey,"login",a=>{n(a)}):n(null)}}return t.\u0275fac=function(n){return new(n||t)(e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(f.r),e.\u0275\u0275directiveInject(C.YC),e.\u0275\u0275directiveInject(d.F0))},t.\u0275cmp=e.\u0275\u0275defineComponent({type:t,selectors:[["ng-component"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:18,vars:15,consts:[[1,"login-form"],[1,"pb-13","pt-lg-0","pt-5"],["method","post",1,"login-form","form",3,"ngSubmit"],["twoFactorForm","ngForm"],[1,"mb-5"],["autoFocus","","type","password","autocomplete","new-password","name","code","required","","maxlength","16",1,"form-control","form-control-solid","h-auto","py-7","px-6","rounded-lg","fs-h6",3,"ngModel","placeholder","ngModelChange"],["passwordInput","ngModel"],[3,"formCtrl"],["class","mb-5 mt-4",4,"ngIf"],[1,"pb-lg-0","pb-5"],["type","submit",1,"btn","btn-primary","fw-bolder","fs-h6","px-8","py-4","my-3","me-3",3,"disabled"],["class","remaining-time-counter ml-5",4,"ngIf"],[1,"mb-5","mt-4"],[1,"form-check","form-check-custom","form-check-solid","py-1"],["type","checkbox","name","rememberClient","value","true",1,"form-check-input",3,"ngModel","ngModelChange"],[1,"form-check-label"],[1,"remaining-time-counter","ml-5"]],template:function(n,a){if(1&n&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275elementStart(2,"h3"),e.\u0275\u0275text(3),e.\u0275\u0275pipe(4,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"form",2,3),e.\u0275\u0275listener("ngSubmit",function(){return a.submit()}),e.\u0275\u0275elementStart(7,"div",4),e.\u0275\u0275elementStart(8,"input",5,6),e.\u0275\u0275listener("ngModelChange",function(c){return a.code=c}),e.\u0275\u0275pipe(10,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"validation-messages",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(12,M,6,4,"div",8),e.\u0275\u0275elementStart(13,"div",9),e.\u0275\u0275elementStart(14,"button",10),e.\u0275\u0275text(15),e.\u0275\u0275pipe(16,"localize"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(17,T,4,7,"span",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementEnd()),2&n){const l=e.\u0275\u0275reference(6),c=e.\u0275\u0275reference(9);e.\u0275\u0275property("@routerTransition",void 0),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(4,9,"VerifySecurityCode")," "),e.\u0275\u0275advance(5),e.\u0275\u0275propertyInterpolate1("placeholder","",e.\u0275\u0275pipeBind1(10,11,"Code")," *"),e.\u0275\u0275property("ngModel",a.code),e.\u0275\u0275advance(3),e.\u0275\u0275property("formCtrl",c),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","true"===a.s("Abp.Zero.UserManagement.TwoFactorLogin.IsRememberBrowserEnabled")),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",!l.form.valid),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind1(16,13,"Submit")," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.remainingSeconds>=0)}},directives:[i.\u0275NgNoValidate,i.NgControlStatusGroup,i.NgForm,i.DefaultValueAccessor,v.h,i.RequiredValidator,i.MaxLengthValidator,i.NgControlStatus,i.NgModel,S.s,F.O5,i.CheckboxControlValueAccessor],pipes:[y.F],styles:[".remaining-time-counter[_ngcontent-%COMP%]{color:red}"],data:{animation:[(0,p.RP)()]}}),t})(),pathMatch:"full"}];let V=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=e.\u0275\u0275defineInjector({imports:[[d.Bz.forChild(b)],d.Bz]}),t})();var x=o(12749);let w=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.\u0275\u0275defineNgModule({type:t}),t.\u0275inj=e.\u0275\u0275defineInjector({imports:[[m.o,x.y,V]]}),t})()}}]);