(self.webpackChunkabp_zero_template=self.webpackChunkabp_zero_template||[]).push([[53307],{53307:(_,E,o)=>{"use strict";o.r(E),o.d(E,{AccountModule:()=>Oe,getRecaptchaLanguage:()=>Be});var a=o(69808),u=o(40520),d=o(26647),m=o(34182),g=o(57887),S=o(80607),F=o(11405),W=o(81134),A=o(77587),B=o(85079),N=o(40506),b=o(8736),f=o(6435),C=o(96111),H=o(87940),M=o(49927);function re(P,ne){if(1&P){const w=f.\u0275\u0275getCurrentView();f.\u0275\u0275elementStart(0,"div",3),f.\u0275\u0275listener("click",function(){const me=f.\u0275\u0275restoreView(w).$implicit;return f.\u0275\u0275nextContext(2).changeLanguage(me)}),f.\u0275\u0275element(1,"i"),f.\u0275\u0275elementEnd()}if(2&P){const w=ne.$implicit;f.\u0275\u0275propertyInterpolate("title",w.displayName),f.\u0275\u0275advance(1),f.\u0275\u0275classMap(w.icon),f.\u0275\u0275attribute("aria-label",w.displayName)}}function ce(P,ne){if(1&P&&(f.\u0275\u0275elementStart(0,"div",1),f.\u0275\u0275template(1,re,2,5,"div",2),f.\u0275\u0275elementEnd()),2&P){const w=f.\u0275\u0275nextContext();f.\u0275\u0275advance(1),f.\u0275\u0275property("ngForOf",w.languages)}}let te=(()=>{class P extends N.c{constructor(w){super(w),this.languages=[]}ngOnInit(){this.languages=(0,b.Z)(abp.localization.languages,w=>!1===w.isDisabled),this.currentLanguage=abp.localization.currentLanguage}changeLanguage(w){abp.utils.setCookieValue("Abp.Localization.CultureName",w.name,new Date((new Date).getTime()+15768e7),abp.appPath),location.reload()}}return P.\u0275fac=function(w){return new(w||P)(f.\u0275\u0275directiveInject(f.Injector))},P.\u0275cmp=f.\u0275\u0275defineComponent({type:P,selectors:[["language-switch"]],features:[f.\u0275\u0275InheritDefinitionFeature],decls:1,vars:1,consts:[["class","ms-1 mx-auto",4,"ngIf"],[1,"ms-1","mx-auto"],["class","btn language-switch-btn btn-clean btn-icon p-0 me-1",3,"title","click",4,"ngFor","ngForOf"],[1,"btn","language-switch-btn","btn-clean","btn-icon","p-0","me-1",3,"title","click"]],template:function(w,q){1&w&&f.\u0275\u0275template(0,ce,2,1,"div",0),2&w&&f.\u0275\u0275property("ngIf",q.languages.length>1)},directives:[a.O5,a.sg],styles:[".language-switch-btn[_ngcontent-%COMP%]{width:auto;height:auto}"]}),P})();function G(P,ne){if(1&P&&f.\u0275\u0275element(0,"img",10),2&P){const w=f.\u0275\u0275nextContext();f.\u0275\u0275property("src",w.defaultLogo,f.\u0275\u0275sanitizeUrl)}}function L(P,ne){if(1&P&&f.\u0275\u0275element(0,"img",10),2&P){const w=f.\u0275\u0275nextContext();f.\u0275\u0275property("src",w.remoteServiceBaseUrl+"/TenantCustomization/GetTenantLogo?skin=light&tenantId="+w.appSession.tenant.id+"&id="+w.appSession.tenant.logoId,f.\u0275\u0275sanitizeUrl)}}function x(P,ne){1&P&&f.\u0275\u0275element(0,"div",13)}function Ce(P,ne){if(1&P&&(f.\u0275\u0275elementStart(0,"div",11),f.\u0275\u0275template(1,x,1,0,"div",12),f.\u0275\u0275element(2,"router-outlet"),f.\u0275\u0275elementEnd()),2&P){const w=f.\u0275\u0275nextContext();f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",w.showTenantChange())}}function Pe(P,ne){1&P&&f.\u0275\u0275element(0,"div",13)}function fe(P,ne){if(1&P&&(f.\u0275\u0275elementStart(0,"div",14),f.\u0275\u0275template(1,Pe,1,0,"div",12),f.\u0275\u0275element(2,"router-outlet"),f.\u0275\u0275elementEnd()),2&P){const w=f.\u0275\u0275nextContext();f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",w.showTenantChange())}}let Te=(()=>{class P extends N.c{constructor(w,q,ue,me,qe,Ze){super(w),this._router=q,this._loginService=ue,this._uiCustomizationService=me,this._dateTimeService=qe,this.currentYear=this._dateTimeService.getYear(),this.remoteServiceBaseUrl=B.g.remoteServiceBaseUrl,this.skin=this.appSession.theme.baseSettings.layout.darkMode?"dark":"light",this.defaultLogo=B.g.appBaseUrl+"/assets/common/images/app-logo-on-"+this.skin+".svg",this.backgroundImageName=this.appSession.theme.baseSettings.layout.darkMode?"login-dark":"login",this.tenantChangeDisabledRoutes=["select-edition","buy","upgrade","extend","register-tenant","stripe-purchase","stripe-subscribe","stripe-update-subscription","paypal-purchase","stripe-payment-result","payment-completed","stripe-cancel-payment","session-locked"],this.viewContainerRef=Ze}showTenantChange(){return!(!this._router.url||(0,b.Z)(this.tenantChangeDisabledRoutes,w=>this._router.url.indexOf("/account/"+w)>=0).length)&&abp.multiTenancy.isEnabled&&!this.supportsTenancyNameInUrl()}isSelectEditionPage(){return this._router.url.indexOf("/account/select-edition")>=0}ngOnInit(){this._loginService.init(),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()}goToHome(){window.location.href="/"}getBgUrl(){return"url(./assets/metronic/themes/"+this.currentTheme.baseSettings.theme+"/images/bg/bg-4.jpg)"}supportsTenancyNameInUrl(){return B.g.appBaseUrlFormat&&B.g.appBaseUrlFormat.indexOf(B.g.tenancyNamePlaceHolderInUrl)>=0}}return P.\u0275fac=function(w){return new(w||P)(f.\u0275\u0275directiveInject(f.Injector),f.\u0275\u0275directiveInject(A.F0),f.\u0275\u0275directiveInject(C.r),f.\u0275\u0275directiveInject(H.n),f.\u0275\u0275directiveInject(M.C),f.\u0275\u0275directiveInject(f.ViewContainerRef))},P.\u0275cmp=f.\u0275\u0275defineComponent({type:P,selectors:[["ng-component"]],features:[f.\u0275\u0275InheritDefinitionFeature],decls:11,vars:15,consts:[[1,"d-flex","flex-column","flex-root"],[1,"d-flex","flex-column","flex-column-fluid","bgi-position-y-bottom","position-x-center","bgi-no-repeat","bgi-size-contain","bgi-attachment-fixed"],[1,"d-flex","flex-center","flex-column","flex-column-fluid","p-10"],["href","",1,"d-flex","justify-content-center",3,"click"],["alt","logo","class","h-40px",3,"src",4,"ngIf"],["class","container-xxl mx-auto",4,"ngIf"],["class","w-lg-500px bg-body rounded shadow-sm p-10 p-lg-15 mx-auto",4,"ngIf"],[1,"d-flex","flex-center","flex-column-auto","p-10"],[1,"d-flex","align-items-center","fw-bold","fs-6"],[1,"mx-auto"],["alt","logo",1,"h-40px",3,"src"],[1,"container-xxl","mx-auto"],["class","tenant-change-box mb-5 tenant-change-box",4,"ngIf"],[1,"tenant-change-box","mb-5","tenant-change-box"],[1,"w-lg-500px","bg-body","rounded","shadow-sm","p-10","p-lg-15","mx-auto"]],template:function(w,q){1&w&&(f.\u0275\u0275elementStart(0,"div",0),f.\u0275\u0275elementStart(1,"div",1),f.\u0275\u0275elementStart(2,"div",2),f.\u0275\u0275elementStart(3,"a",3),f.\u0275\u0275listener("click",function(){return q.goToHome()}),f.\u0275\u0275template(4,G,1,1,"img",4),f.\u0275\u0275template(5,L,1,1,"img",4),f.\u0275\u0275elementEnd(),f.\u0275\u0275template(6,Ce,3,1,"div",5),f.\u0275\u0275template(7,fe,3,1,"div",6),f.\u0275\u0275elementEnd(),f.\u0275\u0275elementStart(8,"div",7),f.\u0275\u0275elementStart(9,"div",8),f.\u0275\u0275element(10,"language-switch",9),f.\u0275\u0275elementEnd(),f.\u0275\u0275elementEnd(),f.\u0275\u0275elementEnd(),f.\u0275\u0275elementEnd()),2&w&&(f.\u0275\u0275advance(1),f.\u0275\u0275styleMapInterpolate1("background-image: url(/assets/metronic/assets/media/svg/illustrations/",q.backgroundImageName,".png)"),f.\u0275\u0275advance(1),f.\u0275\u0275classProp("pb-lg-20",!q.isSelectEditionPage())("pb-0",q.isSelectEditionPage()),f.\u0275\u0275advance(1),f.\u0275\u0275classProp("mb-12",!q.isSelectEditionPage()),f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",!q.appSession.tenant||!q.appSession.tenant.logoId),f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",q.appSession.tenant&&q.appSession.tenant.logoId),f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",q.isSelectEditionPage()),f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",!q.isSelectEditionPage()),f.\u0275\u0275advance(1),f.\u0275\u0275classProp("pt-0",q.isSelectEditionPage()))},directives:[a.O5,te,A.lC],styles:[".login.login-1 .login-aside .aside-img{min-height:450px}.login.login-1 .login-signin,.login.login-1 .login-signup,.login.login-1 .login-forgot,.login.login-1.login-signin-on .login-signup{display:none}.login.login-1.login-signin-on .login-signin{display:block}.login.login-1.login-signin-on .login-forgot{display:none}.login.login-1.login-signup-on .login-signup{display:block}.login.login-1.login-signup-on .login-signin,.login.login-1.login-signup-on .login-forgot,.login.login-1.login-forgot-on .login-signup,.login.login-1.login-forgot-on .login-signin{display:none}.login.login-1.login-forgot-on .login-forgot{display:block}@media (min-width: 992px){.login.login-1 .login-aside{width:100%;max-width:600px}.login.login-1 .login-content{width:100%;max-width:500px}.login.login-1 .login-content .login-form{width:100%;max-width:450px}}@media (min-width: 992px) and (max-width: 1399.98px){.login.login-1 .login-aside{width:100%;max-width:450px}}@media (max-width: 991.98px){.login.login-1 .login-content .login-form{width:100%;max-width:400px}}@media (max-width: 575.98px){.login.login-1 .aside-img{min-height:300px!important;background-size:400px}.login.login-1 .login-content .login-form{width:100%;max-width:100%}}.has-danger .form-control-feedback{color:#fd397a;margin-top:.2rem;font-size:.85rem;text-align:left}ul.text-danger{list-style:none;color:#f4516c;margin-top:.2rem;font-size:.85rem;text-align:left;padding-left:0}.captcha-container{margin:auto;width:70%}\n"],encapsulation:2}),P})();var O=o(74461),U=o(34845);let k=(()=>{class P{constructor(w,q,ue){this._permissionChecker=w,this._router=q,this._sessionService=ue}canActivate(w,q){return!(!w.queryParams.ss||"true"!==w.queryParams.ss)||!this._sessionService.user||(this._router.navigate([this.selectBestRoute()]),!1)}selectBestRoute(){return this._permissionChecker.isGranted("Pages.Administration.Host.Dashboard")?"/app/admin/hostDashboard":this._permissionChecker.isGranted("Pages.Tenant.Dashboard")?"/app/main/dashboard":"/app/notifications"}}return P.\u0275fac=function(w){return new(w||P)(f.\u0275\u0275inject(O.qT),f.\u0275\u0275inject(A.F0),f.\u0275\u0275inject(U.c))},P.\u0275prov=f.\u0275\u0275defineInjectable({token:P,factory:P.\u0275fac}),P})(),I=(()=>{class P{constructor(w,q){this.router=w,this._uiCustomizationService=q,w.events.subscribe(ue=>{setTimeout(()=>{this.toggleBodyCssClass(ue.url)},0)})}toggleBodyCssClass(w){w?w.indexOf("/account/")>=0?this.setAccountModuleBodyClassInternal():document.body.className=this._uiCustomizationService.getAppModuleBodyClass():this.setAccountModuleBodyClassInternal()}setAccountModuleBodyClassInternal(){let q="";document.body.className.indexOf("swal2-toast-shown")>=0&&(q+=" swal2-toast-shown"),document.body.className=this._uiCustomizationService.getAccountModuleBodyClass()+" "+q}}return P.\u0275fac=function(w){return new(w||P)(f.\u0275\u0275inject(A.F0),f.\u0275\u0275inject(H.n))},P.\u0275mod=f.\u0275\u0275defineNgModule({type:P}),P.\u0275inj=f.\u0275\u0275defineInjector({imports:[[A.Bz.forChild([{path:"",component:Te,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadChildren:()=>o.e(92139).then(o.bind(o,92139)).then(ne=>ne.LoginModule),canActivate:[k]},{path:"send-code",loadChildren:()=>o.e(15524).then(o.bind(o,15524)).then(ne=>ne.SendTwoFactorCodeModule),canActivate:[k]},{path:"verify-code",loadChildren:()=>o.e(6066).then(o.bind(o,6066)).then(ne=>ne.ValidateTwoFactorCodeModule),canActivate:[k]},{path:"session-locked",loadChildren:()=>o.e(38404).then(o.bind(o,38404)).then(ne=>ne.SessionLockScreenModule)},{path:"**",redirectTo:"login"}]}])],A.Bz]}),P})();var D=o(20486),z=o(77959),y=o(41777),ve=o(75730),Ae=o(59783),se=o(85921),ge=o(31424);const He=["input"];function Z(P,ne){if(1&P){const w=f.\u0275\u0275getCurrentView();f.\u0275\u0275elementStart(0,"i",4),f.\u0275\u0275listener("click",function(){return f.\u0275\u0275restoreView(w),f.\u0275\u0275nextContext().onMaskToggle()}),f.\u0275\u0275elementEnd()}if(2&P){const w=f.\u0275\u0275nextContext();f.\u0275\u0275property("ngClass",w.toggleIconClass())}}function Me(P,ne){1&P&&f.\u0275\u0275elementContainer(0)}function Re(P,ne){1&P&&f.\u0275\u0275elementContainer(0)}function $e(P,ne){if(1&P&&(f.\u0275\u0275elementContainerStart(0),f.\u0275\u0275template(1,Re,1,0,"ng-container",6),f.\u0275\u0275elementContainerEnd()),2&P){const w=f.\u0275\u0275nextContext(2);f.\u0275\u0275advance(1),f.\u0275\u0275property("ngTemplateOutlet",w.contentTemplate)}}const Mt=function(P){return{width:P}};function lt(P,ne){if(1&P&&(f.\u0275\u0275elementStart(0,"div",9),f.\u0275\u0275element(1,"div",0),f.\u0275\u0275elementEnd(),f.\u0275\u0275elementStart(2,"div",10),f.\u0275\u0275text(3),f.\u0275\u0275elementEnd()),2&P){const w=f.\u0275\u0275nextContext(2);f.\u0275\u0275advance(1),f.\u0275\u0275property("ngClass",w.strengthClass())("ngStyle",f.\u0275\u0275pureFunction1(3,Mt,w.meter?w.meter.width:"")),f.\u0275\u0275advance(2),f.\u0275\u0275textInterpolate(w.infoText)}}function ut(P,ne){1&P&&f.\u0275\u0275elementContainer(0)}const je=function(P,ne){return{showTransitionParams:P,hideTransitionParams:ne}},xe=function(P){return{value:"visible",params:P}};function pe(P,ne){if(1&P){const w=f.\u0275\u0275getCurrentView();f.\u0275\u0275elementStart(0,"div",4,5),f.\u0275\u0275listener("click",function(ue){return f.\u0275\u0275restoreView(w),f.\u0275\u0275nextContext().onOverlayClick(ue)})("@overlayAnimation.start",function(ue){return f.\u0275\u0275restoreView(w),f.\u0275\u0275nextContext().onAnimationStart(ue)})("@overlayAnimation.done",function(ue){return f.\u0275\u0275restoreView(w),f.\u0275\u0275nextContext().onAnimationEnd(ue)}),f.\u0275\u0275template(2,Me,1,0,"ng-container",6),f.\u0275\u0275template(3,$e,2,1,"ng-container",7),f.\u0275\u0275template(4,lt,4,5,"ng-template",null,8,f.\u0275\u0275templateRefExtractor),f.\u0275\u0275template(6,ut,1,0,"ng-container",6),f.\u0275\u0275elementEnd()}if(2&P){const w=f.\u0275\u0275reference(5),q=f.\u0275\u0275nextContext();f.\u0275\u0275property("ngClass","p-password-panel p-component")("@overlayAnimation",f.\u0275\u0275pureFunction1(9,xe,f.\u0275\u0275pureFunction2(6,je,q.showTransitionOptions,q.hideTransitionOptions))),f.\u0275\u0275advance(2),f.\u0275\u0275property("ngTemplateOutlet",q.headerTemplate),f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",q.contentTemplate)("ngIfElse",w),f.\u0275\u0275advance(3),f.\u0275\u0275property("ngTemplateOutlet",q.footerTemplate)}}const We={provide:m.NG_VALUE_ACCESSOR,useExisting:(0,f.forwardRef)(()=>At),multi:!0};let At=(()=>{class P{constructor(w,q,ue,me){this.cd=w,this.config=q,this.el=ue,this.overlayService=me,this.mediumRegex="^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{6,})",this.strongRegex="^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})",this.feedback=!0,this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.onFocus=new f.EventEmitter,this.onBlur=new f.EventEmitter,this.overlayVisible=!1,this.focused=!1,this.unmasked=!1,this.value=null,this.onModelChange=()=>{},this.onModelTouched=()=>{}}ngAfterContentInit(){this.templates.forEach(w=>{switch(w.getType()){case"content":default:this.contentTemplate=w.template;break;case"header":this.headerTemplate=w.template;break;case"footer":this.footerTemplate=w.template}})}ngOnInit(){this.infoText=this.promptText(),this.mediumCheckRegExp=new RegExp(this.mediumRegex),this.strongCheckRegExp=new RegExp(this.strongRegex),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.updateUI(this.value||"")})}onAnimationStart(w){switch(w.toState){case"visible":this.overlay=w.element,se.P9.set("overlay",this.overlay,this.config.zIndex.overlay),this.appendContainer(),this.alignOverlay(),this.bindScrollListener(),this.bindResizeListener();break;case"void":this.unbindScrollListener(),this.unbindResizeListener(),this.overlay=null}}onAnimationEnd(w){"void"===w.toState&&se.P9.clear(w.element)}appendContainer(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):document.getElementById(this.appendTo).appendChild(this.overlay))}alignOverlay(){this.appendTo?(this.overlay.style.minWidth=ve.p.getOuterWidth(this.input.nativeElement)+"px",ve.p.absolutePosition(this.overlay,this.input.nativeElement)):ve.p.relativePosition(this.overlay,this.input.nativeElement)}onInput(w){this.value=w.target.value,this.onModelChange(this.value),this.onModelTouched()}onInputFocus(w){this.focused=!0,this.feedback&&(this.overlayVisible=!0),this.onFocus.emit(w)}onInputBlur(w){this.focused=!1,this.feedback&&(this.overlayVisible=!1),this.onBlur.emit(w)}onKeyDown(w){"Escape"===w.key&&(this.overlayVisible=!1)}onKeyUp(w){this.feedback&&(this.updateUI(w.target.value),this.overlayVisible||(this.overlayVisible=!0))}updateUI(w){let q=null,ue=null;switch(this.testStrength(w)){case 1:q=this.weakText(),ue={strength:"weak",width:"33.33%"};break;case 2:q=this.mediumText(),ue={strength:"medium",width:"66.66%"};break;case 3:q=this.strongText(),ue={strength:"strong",width:"100%"};break;default:q=this.promptText(),ue=null}this.meter=ue,this.infoText=q}onMaskToggle(){this.unmasked=!this.unmasked}onOverlayClick(w){this.overlayService.add({originalEvent:w,target:this.el.nativeElement})}testStrength(w){let q=0;return this.strongCheckRegExp.test(w)?q=3:this.mediumCheckRegExp.test(w)?q=2:w.length&&(q=1),q}writeValue(w){this.value=void 0===w?null:w,this.feedback&&this.updateUI(this.value||""),this.cd.markForCheck()}registerOnChange(w){this.onModelChange=w}registerOnTouched(w){this.onModelTouched=w}setDisabledState(w){this.disabled=w}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new ve.V(this.input.nativeElement,()=>{this.overlayVisible&&(this.overlayVisible=!1)})),this.scrollHandler.bindScrollListener()}bindResizeListener(){this.resizeListener||(this.resizeListener=()=>{this.overlayVisible&&(this.overlayVisible=!1)},window.addEventListener("resize",this.resizeListener))}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}unbindResizeListener(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}unbindOutsideClickListener(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null)}containerClass(){return{"p-password p-component p-inputwrapper":!0,"p-input-icon-right":this.toggleMask}}inputFieldClass(){return{"p-password-input":!0,"p-disabled":this.disabled}}toggleIconClass(){return this.unmasked?"pi pi-eye-slash":"pi pi-eye"}strengthClass(){return`p-password-strength ${this.meter?this.meter.strength:""}`}filled(){return null!=this.value&&this.value.toString().length>0}promptText(){return this.promptLabel||this.getTranslation(Ae.ws.PASSWORD_PROMPT)}weakText(){return this.weakLabel||this.getTranslation(Ae.ws.WEAK)}mediumText(){return this.mediumLabel||this.getTranslation(Ae.ws.MEDIUM)}strongText(){return this.strongLabel||this.getTranslation(Ae.ws.STRONG)}restoreAppend(){this.overlay&&this.appendTo&&("body"===this.appendTo?document.body.removeChild(this.overlay):document.getElementById(this.appendTo).removeChild(this.overlay))}inputType(){return this.unmasked?"text":"password"}getTranslation(w){return this.config.getTranslation(w)}ngOnDestroy(){this.overlay&&(se.P9.clear(this.overlay),this.overlay=null),this.restoreAppend(),this.unbindResizeListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.translationSubscription&&this.translationSubscription.unsubscribe()}}return P.\u0275fac=function(w){return new(w||P)(f.\u0275\u0275directiveInject(f.ChangeDetectorRef),f.\u0275\u0275directiveInject(Ae.b4),f.\u0275\u0275directiveInject(f.ElementRef),f.\u0275\u0275directiveInject(Ae.F0))},P.\u0275cmp=f.\u0275\u0275defineComponent({type:P,selectors:[["p-password"]],contentQueries:function(w,q,ue){if(1&w&&f.\u0275\u0275contentQuery(ue,Ae.jx,4),2&w){let me;f.\u0275\u0275queryRefresh(me=f.\u0275\u0275loadQuery())&&(q.templates=me)}},viewQuery:function(w,q){if(1&w&&f.\u0275\u0275viewQuery(He,5),2&w){let ue;f.\u0275\u0275queryRefresh(ue=f.\u0275\u0275loadQuery())&&(q.input=ue.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(w,q){2&w&&f.\u0275\u0275classProp("p-inputwrapper-filled",q.filled())("p-inputwrapper-focus",q.focused)},inputs:{disabled:"disabled",promptLabel:"promptLabel",mediumRegex:"mediumRegex",strongRegex:"strongRegex",weakLabel:"weakLabel",mediumLabel:"mediumLabel",strongLabel:"strongLabel",inputId:"inputId",feedback:"feedback",appendTo:"appendTo",toggleMask:"toggleMask",inputStyleClass:"inputStyleClass",styleClass:"styleClass",style:"style",inputStyle:"inputStyle",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",placeholder:"placeholder"},outputs:{onFocus:"onFocus",onBlur:"onBlur"},features:[f.\u0275\u0275ProvidersFeature([We])],decls:5,vars:14,consts:[[3,"ngClass","ngStyle"],["pInputText","",3,"ngClass","ngStyle","value","input","focus","blur","keyup","keydown"],["input",""],[3,"ngClass","click",4,"ngIf"],[3,"ngClass","click"],["overlay",""],[4,"ngTemplateOutlet"],[4,"ngIf","ngIfElse"],["content",""],[1,"p-password-meter"],["className","p-password-info"]],template:function(w,q){1&w&&(f.\u0275\u0275elementStart(0,"div",0),f.\u0275\u0275elementStart(1,"input",1,2),f.\u0275\u0275listener("input",function(me){return q.onInput(me)})("focus",function(me){return q.onInputFocus(me)})("blur",function(me){return q.onInputBlur(me)})("keyup",function(me){return q.onKeyUp(me)})("keydown",function(me){return q.onKeyDown(me)}),f.\u0275\u0275elementEnd(),f.\u0275\u0275template(3,Z,1,1,"i",3),f.\u0275\u0275template(4,pe,7,11,"div",3),f.\u0275\u0275elementEnd()),2&w&&(f.\u0275\u0275classMap(q.styleClass),f.\u0275\u0275property("ngClass",q.containerClass())("ngStyle",q.style),f.\u0275\u0275advance(1),f.\u0275\u0275classMap(q.inputStyleClass),f.\u0275\u0275property("ngClass",q.inputFieldClass())("ngStyle",q.inputStyle)("value",q.value),f.\u0275\u0275attribute("id",q.inputId)("type",q.inputType())("placeholder",q.placeholder),f.\u0275\u0275advance(2),f.\u0275\u0275property("ngIf",q.toggleMask),f.\u0275\u0275advance(1),f.\u0275\u0275property("ngIf",q.overlayVisible))},directives:[a.mk,a.PC,ge.o,a.O5,a.tP],styles:[".p-password{position:relative;display:inline-flex}.p-password-panel{position:absolute;top:0;left:0}.p-password .p-password-panel{min-width:100%}.p-password-meter{height:10px}.p-password-strength{height:100%;width:0%;transition:width 1s ease-in-out}.p-fluid .p-password{display:flex}\n"],encapsulation:2,data:{animation:[(0,y.X$)("overlayAnimation",[(0,y.eR)(":enter",[(0,y.oB)({opacity:0,transform:"scaleY(0.8)"}),(0,y.jt)("{{showTransitionParams}}")]),(0,y.eR)(":leave",[(0,y.jt)("{{hideTransitionParams}}",(0,y.oB)({opacity:0}))])])]},changeDetection:0}),P})(),Yt=(()=>{class P{}return P.\u0275fac=function(w){return new(w||P)},P.\u0275mod=f.\u0275\u0275defineNgModule({type:P}),P.\u0275inj=f.\u0275\u0275defineInjector({imports:[[a.ez,ge.j],Ae.m8]}),P})();var Et=o(79883),ht=o(12749);function Be(){return(new z.O).map("recaptcha",abp.localization.currentLanguage.name)}let Oe=(()=>{class P{}return P.\u0275fac=function(w){return new(w||P)},P.\u0275mod=f.\u0275\u0275defineNgModule({type:P}),P.\u0275inj=f.\u0275\u0275defineInjector({providers:[C.r,k],imports:[[a.ez,m.FormsModule,u.JF,u.Ed,F.e7,W.zk.forRoot(),d.t,S.A,g.L,I,D.zr.forRoot(),Yt,Et._,ht.y]]}),P})()},96111:(_,E,o)=>{"use strict";o.d(E,{r:()=>kn});var a=o(85079),u=o(87737),d=o(37857),m=o(32351),g=o(27988),S=o(25736),F=o(93858),W=o(78706);const B=function(n,e){var t=-1,r=(0,W.Z)(n)?Array(n.length):[];return(0,F.Z)(n,function(i,s,c){r[++t]=e(i,s,c)}),r};var N=o(14177);const f=function(n,e){return((0,N.Z)(n)?g.Z:B)(n,(0,S.Z)(e,3))};var C=o(8736),H=o(40537),M=o(20486),re=o(70685),ce=function(n,e){return(ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])})(n,e)};function te(n,e){function t(){this.constructor=n}ce(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var G=function(){return G=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},G.apply(this,arguments)};function L(n,e,t,r){return new(t||(t=Promise))(function(s,c){function l(v){try{p(r.next(v))}catch(T){c(T)}}function h(v){try{p(r.throw(v))}catch(T){c(T)}}function p(v){v.done?s(v.value):function(s){return s instanceof t?s:new t(function(c){c(s)})}(v.value).then(l,h)}p((r=r.apply(n,e||[])).next())})}function x(n,e){var r,i,s,c,t={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(p){return function(v){return function(p){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=2&p[0]?i.return:p[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,p[1])).done)return s;switch(i=0,s&&(p=[2&p[0],s.value]),p[0]){case 0:case 1:s=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,i=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(!(s=(s=t.trys).length>0&&s[s.length-1])&&(6===p[0]||2===p[0])){t=0;continue}if(3===p[0]&&(!s||p[1]>s[0]&&p[1]<s[3])){t.label=p[1];break}if(6===p[0]&&t.label<s[1]){t.label=s[1],s=p;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(p);break}s[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(v){p=[6,v],i=0}finally{r=s=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([p,v])}}}function Ce(n,e){var t="function"==typeof Symbol&&n[Symbol.iterator];if(!t)return n;var i,c,r=t.call(n),s=[];try{for(;(void 0===e||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(l){c={error:l}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(c)throw c.error}}return s}function Pe(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(Ce(arguments[e]));return n}var fe=(()=>{return(n=fe||(fe={})).AcquireTokenByCode="acquireTokenByCode",n.AcquireTokenByRefreshToken="acquireTokenByRefreshToken",n.AcquireTokenSilent="acquireTokenSilent",n.AcquireTokenSilentAsync="acquireTokenSilentAsync",n.AcquireTokenPopup="acquireTokenPopup",n.CryptoOptsGetPublicKeyThumbprint="cryptoOptsGetPublicKeyThumbprint",n.CryptoOptsSignJwt="cryptoOptsSignJwt",n.SilentCacheClientAcquireToken="silentCacheClientAcquireToken",n.SilentIframeClientAcquireToken="silentIframeClientAcquireToken",n.SilentRefreshClientAcquireToken="silentRefreshClientAcquireToken",n.SsoSilent="ssoSilent",n.StandardInteractionClientGetDiscoveredAuthority="standardInteractionClientGetDiscoveredAuthority",n.FetchAccountIdWithNativeBroker="fetchAccountIdWithNativeBroker",n.NativeInteractionClientAcquireToken="nativeInteractionClientAcquireToken",fe;var n})(),Te=(()=>{return(n=Te||(Te={}))[n.NotStarted=0]="NotStarted",n[n.InProgress=1]="InProgress",n[n.Completed=2]="Completed",Te;var n})(),O=function(n,e){return(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])})(n,e)};function U(n,e){function t(){this.constructor=n}O(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}var k=function(){return k=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},k.apply(this,arguments)};function I(n,e,t,r){return new(t||(t=Promise))(function(s,c){function l(v){try{p(r.next(v))}catch(T){c(T)}}function h(v){try{p(r.throw(v))}catch(T){c(T)}}function p(v){v.done?s(v.value):function(s){return s instanceof t?s:new t(function(c){c(s)})}(v.value).then(l,h)}p((r=r.apply(n,e||[])).next())})}function D(n,e){var r,i,s,c,t={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return c={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function l(p){return function(v){return function(p){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=2&p[0]?i.return:p[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,p[1])).done)return s;switch(i=0,s&&(p=[2&p[0],s.value]),p[0]){case 0:case 1:s=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,i=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(!(s=(s=t.trys).length>0&&s[s.length-1])&&(6===p[0]||2===p[0])){t=0;continue}if(3===p[0]&&(!s||p[1]>s[0]&&p[1]<s[3])){t.label=p[1];break}if(6===p[0]&&t.label<s[1]){t.label=s[1],s=p;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(p);break}s[2]&&t.ops.pop(),t.trys.pop();continue}p=e.call(n,t)}catch(v){p=[6,v],i=0}finally{r=s=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([p,v])}}}function z(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var r=Array(n),i=0;for(e=0;e<t;e++)for(var s=arguments[e],c=0,l=s.length;c<l;c++,i++)r[i]=s[c];return r}var y={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token"},ve=[y.OPENID_SCOPE,y.PROFILE_SCOPE,y.OFFLINE_ACCESS_SCOPE],Ae=z(ve,[y.EMAIL_SCOPE]),se=(()=>{return(n=se||(se={})).CONTENT_TYPE="Content-Type",n.RETRY_AFTER="Retry-After",n.CCS_HEADER="X-AnchorMailbox",n.WWWAuthenticate="WWW-Authenticate",n.AuthenticationInfo="Authentication-Info",se;var n})(),ge=(()=>{return(n=ge||(ge={})).ID_TOKEN="idtoken",n.CLIENT_INFO="client.info",n.ADAL_ID_TOKEN="adal.idtoken",n.ERROR="error",n.ERROR_DESC="error.description",n.ACTIVE_ACCOUNT="active-account",ge;var n})(),He=(()=>{return(n=He||(He={})).COMMON="common",n.ORGANIZATIONS="organizations",n.CONSUMERS="consumers",He;var n})(),Z=(()=>{return(n=Z||(Z={})).CLIENT_ID="client_id",n.REDIRECT_URI="redirect_uri",n.RESPONSE_TYPE="response_type",n.RESPONSE_MODE="response_mode",n.GRANT_TYPE="grant_type",n.CLAIMS="claims",n.SCOPE="scope",n.ERROR="error",n.ERROR_DESCRIPTION="error_description",n.ACCESS_TOKEN="access_token",n.ID_TOKEN="id_token",n.REFRESH_TOKEN="refresh_token",n.EXPIRES_IN="expires_in",n.STATE="state",n.NONCE="nonce",n.PROMPT="prompt",n.SESSION_STATE="session_state",n.CLIENT_INFO="client_info",n.CODE="code",n.CODE_CHALLENGE="code_challenge",n.CODE_CHALLENGE_METHOD="code_challenge_method",n.CODE_VERIFIER="code_verifier",n.CLIENT_REQUEST_ID="client-request-id",n.X_CLIENT_SKU="x-client-SKU",n.X_CLIENT_VER="x-client-VER",n.X_CLIENT_OS="x-client-OS",n.X_CLIENT_CPU="x-client-CPU",n.X_CLIENT_CURR_TELEM="x-client-current-telemetry",n.X_CLIENT_LAST_TELEM="x-client-last-telemetry",n.X_MS_LIB_CAPABILITY="x-ms-lib-capability",n.X_APP_NAME="x-app-name",n.X_APP_VER="x-app-ver",n.POST_LOGOUT_URI="post_logout_redirect_uri",n.ID_TOKEN_HINT="id_token_hint",n.DEVICE_CODE="device_code",n.CLIENT_SECRET="client_secret",n.CLIENT_ASSERTION="client_assertion",n.CLIENT_ASSERTION_TYPE="client_assertion_type",n.TOKEN_TYPE="token_type",n.REQ_CNF="req_cnf",n.OBO_ASSERTION="assertion",n.REQUESTED_TOKEN_USE="requested_token_use",n.ON_BEHALF_OF="on_behalf_of",n.FOCI="foci",n.CCS_HEADER="X-AnchorMailbox",n.RETURN_SPA_CODE="return_spa_code",n.NATIVE_BROKER="nativebroker",n.LOGOUT_HINT="logout_hint",Z;var n})(),Me=(()=>{return(n=Me||(Me={})).ACCESS_TOKEN="access_token",n.XMS_CC="xms_cc",Me;var n})(),Re={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create"},$e=(()=>{return(n=$e||($e={})).ACCOUNT="account",n.SID="sid",n.LOGIN_HINT="login_hint",n.ID_TOKEN="id_token",n.DOMAIN_HINT="domain_hint",n.ORGANIZATIONS="organizations",n.CONSUMERS="consumers",n.ACCOUNT_ID="accountIdentifier",n.HOMEACCOUNT_ID="homeAccountIdentifier",$e;var n})(),Mt={PLAIN:"plain",S256:"S256"},lt=(()=>{return(n=lt||(lt={})).QUERY="query",n.FRAGMENT="fragment",n.FORM_POST="form_post",lt;var n})(),ut=(()=>{return(n=ut||(ut={})).IMPLICIT_GRANT="implicit",n.AUTHORIZATION_CODE_GRANT="authorization_code",n.CLIENT_CREDENTIALS_GRANT="client_credentials",n.RESOURCE_OWNER_PASSWORD_GRANT="password",n.REFRESH_TOKEN_GRANT="refresh_token",n.DEVICE_CODE_GRANT="device_code",n.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer",ut;var n})(),je=(()=>{return(n=je||(je={})).MSSTS_ACCOUNT_TYPE="MSSTS",n.ADFS_ACCOUNT_TYPE="ADFS",n.MSAV1_ACCOUNT_TYPE="MSA",n.GENERIC_ACCOUNT_TYPE="Generic",je;var n})(),xe=(()=>{return(n=xe||(xe={})).CACHE_KEY_SEPARATOR="-",n.CLIENT_INFO_SEPARATOR=".",xe;var n})(),pe=(()=>{return(n=pe||(pe={})).ID_TOKEN="IdToken",n.ACCESS_TOKEN="AccessToken",n.ACCESS_TOKEN_WITH_AUTH_SCHEME="AccessToken_With_AuthScheme",n.REFRESH_TOKEN="RefreshToken",pe;var n})(),ot=(()=>{return(n=ot||(ot={})).ACCOUNT="Account",n.CREDENTIAL="Credential",n.ID_TOKEN="IdToken",n.ACCESS_TOKEN="AccessToken",n.REFRESH_TOKEN="RefreshToken",n.APP_METADATA="AppMetadata",n.TEMPORARY="TempCache",n.TELEMETRY="Telemetry",n.UNDEFINED="Undefined",n.THROTTLING="Throttling",ot;var n})(),We=(()=>{return(n=We||(We={}))[n.ADFS=1001]="ADFS",n[n.MSA=1002]="MSA",n[n.MSSTS=1003]="MSSTS",n[n.GENERIC=1004]="GENERIC",n[n.ACCESS_TOKEN=2001]="ACCESS_TOKEN",n[n.REFRESH_TOKEN=2002]="REFRESH_TOKEN",n[n.ID_TOKEN=2003]="ID_TOKEN",n[n.APP_METADATA=3001]="APP_METADATA",n[n.UNDEFINED=9999]="UNDEFINED",We;var n})(),At="appmetadata",Be=(()=>{return(n=Be||(Be={})).CONFIG="config",n.CACHE="cache",n.NETWORK="network",Be;var n})(),Oe={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},P=(()=>{return(n=P||(P={})).BEARER="Bearer",n.POP="pop",n.SSH="ssh-cert",P;var n})(),q=(()=>{return(n=q||(q={})).username="username",n.password="password",q;var n})(),ue=(()=>{return(n=ue||(ue={}))[n.httpSuccess=200]="httpSuccess",n[n.httpBadRequest=400]="httpBadRequest",ue;var n})(),me=(()=>{return(n=me||(me={})).FAILED_AUTO_DETECTION="1",n.INTERNAL_CACHE="2",n.ENVIRONMENT_VARIABLE="3",n.IMDS="4",me;var n})(),qe=(()=>{return(n=qe||(qe={})).CONFIGURED_MATCHES_DETECTED="1",n.CONFIGURED_NO_AUTO_DETECTION="2",n.CONFIGURED_NOT_DETECTED="3",n.AUTO_DETECTION_REQUESTED_SUCCESSFUL="4",n.AUTO_DETECTION_REQUESTED_FAILED="5",qe;var n})(),Ze=(()=>{return(n=Ze||(Ze={})).NO_CACHE_HIT="0",n.FORCE_REFRESH="1",n.NO_CACHED_ACCESS_TOKEN="2",n.CACHED_ACCESS_TOKEN_EXPIRED="3",n.REFRESH_CACHED_ACCESS_TOKEN="4",Ze;var n})(),xt_CHANNEL_ID="53ee284d-920a-4b59-9d30-a60315b26836",et=(()=>{return(n=et||(et={})).HandshakeRequest="Handshake",n.HandshakeResponse="HandshakeResponse",n.GetToken="GetToken",n.Response="Response",et;var n})(),Ue=(()=>{return(n=Ue||(Ue={})).LocalStorage="localStorage",n.SessionStorage="sessionStorage",n.MemoryStorage="memoryStorage",Ue;var n})(),Je=(()=>{return(n=Je||(Je={})).GET="GET",n.POST="POST",Je;var n})(),_e=(()=>{return(n=_e||(_e={})).AUTHORITY="authority",n.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",n.SESSION_STATE="session.state",n.REQUEST_STATE="request.state",n.NONCE_IDTOKEN="nonce.id_token",n.ORIGIN_URI="request.origin",n.RENEW_STATUS="token.renew.status",n.URL_HASH="urlHash",n.REQUEST_PARAMS="request.params",n.SCOPES="scopes",n.INTERACTION_STATUS_KEY="interaction.status",n.CCS_CREDENTIAL="ccs.credential",n.CORRELATION_ID="request.correlationId",n.NATIVE_REQUEST="request.native",_e;var n})(),dt=(()=>{return(n=dt||(dt={})).WRAPPER_SKU="wrapper.sku",n.WRAPPER_VER="wrapper.version",dt;var n})(),Se=(()=>{return(n=Se||(Se={}))[n.acquireTokenRedirect=861]="acquireTokenRedirect",n[n.acquireTokenPopup=862]="acquireTokenPopup",n[n.ssoSilent=863]="ssoSilent",n[n.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",n[n.handleRedirectPromise=865]="handleRedirectPromise",n[n.acquireTokenByCode=866]="acquireTokenByCode",n[n.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",n[n.logout=961]="logout",n[n.logoutPopup=962]="logoutPopup",Se;var n})(),X=(()=>{return(n=X||(X={})).Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none",X;var n})(),ar={scopes:ve},Rt="jwk",Ut="msal.db",Le=function(){function n(){}return n.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},n}(),cr=function(){function n(e){this.cryptoObj=e}return n.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,Le.decimalToHex(e[0])+Le.decimalToHex(e[1])+Le.decimalToHex(e[2])+Le.decimalToHex(e[3])+"-"+Le.decimalToHex(e[4])+Le.decimalToHex(e[5])+"-"+Le.decimalToHex(e[6])+Le.decimalToHex(e[7])+"-"+Le.decimalToHex(e[8])+Le.decimalToHex(e[9])+"-"+Le.decimalToHex(e[10])+Le.decimalToHex(e[11])+Le.decimalToHex(e[12])+Le.decimalToHex(e[13])+Le.decimalToHex(e[14])+Le.decimalToHex(e[15])}catch(l){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",i=0,s=y.EMPTY_STRING,c=0;c<36;c++)"-"!==t[c]&&"4"!==t[c]&&(i=16*Math.random()|0),"x"===t[c]?s+=r[i]:"y"===t[c]?(i&=3,s+=r[i|=8]):s+=t[c];return s}},n.prototype.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},n}(),_t=function(){function n(){}return n.stringToUtf8Arr=function(e){for(var t,r=0,i=e.length,s=0;s<i;s++)r+=(t=e.charCodeAt(s))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var c=new Uint8Array(r),l=0,h=0;l<r;h++)(t=e.charCodeAt(h))<128?c[l++]=t:t<2048?(c[l++]=192+(t>>>6),c[l++]=128+(63&t)):t<65536?(c[l++]=224+(t>>>12),c[l++]=128+(t>>>6&63),c[l++]=128+(63&t)):t<2097152?(c[l++]=240+(t>>>18),c[l++]=128+(t>>>12&63),c[l++]=128+(t>>>6&63),c[l++]=128+(63&t)):t<67108864?(c[l++]=248+(t>>>24),c[l++]=128+(t>>>18&63),c[l++]=128+(t>>>12&63),c[l++]=128+(t>>>6&63),c[l++]=128+(63&t)):(c[l++]=252+(t>>>30),c[l++]=128+(t>>>24&63),c[l++]=128+(t>>>18&63),c[l++]=128+(t>>>12&63),c[l++]=128+(t>>>6&63),c[l++]=128+(63&t));return c},n.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);return t},n.utf8ArrToString=function(e){for(var t=y.EMPTY_STRING,r=void 0,i=e.length,s=0;s<i;s++)r=e[s],t+=String.fromCharCode(r>251&&r<254&&s+5<i?1073741824*(r-252)+(e[++s]-128<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:r>247&&r<252&&s+4<i?(r-248<<24)+(e[++s]-128<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:r>239&&r<248&&s+3<i?(r-240<<18)+(e[++s]-128<<12)+(e[++s]-128<<6)+e[++s]-128:r>223&&r<240&&s+2<i?(r-224<<12)+(e[++s]-128<<6)+e[++s]-128:r>191&&r<224&&s+1<i?(r-192<<6)+e[++s]-128:r);return t},n}(),lr=function(){function n(){}return n.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,y.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_"))},n.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,y.EMPTY_STRING).replace(/\+/g,"-").replace(/\//g,"_")},n.prototype.encode=function(e){var t=_t.stringToUtf8Arr(e);return this.base64EncArr(t)},n.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r=y.EMPTY_STRING,i=void 0,s=e.length,c=0,l=0;l<s;l++)c|=e[l]<<(16>>>(i=l%3)&24),(2===i||e.length-l==1)&&(r+=String.fromCharCode(this.uint6ToB64(c>>>18&63),this.uint6ToB64(c>>>12&63),this.uint6ToB64(c>>>6&63),this.uint6ToB64(63&c)),c=0);return 0===t?r:r.substring(0,r.length-t)+(1===t?"=":"==")},n.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},n}(),br=function(){function n(){}return n.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return _t.utf8ArrToString(r)},n.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,y.EMPTY_STRING),i=r.length,s=t?Math.ceil((3*i+1>>>2)/t)*t:3*i+1>>>2,c=new Uint8Array(s),l=void 0,h=void 0,p=0,v=0,T=0;T<i;T++)if(h=3&T,p|=this.b64ToUint6(r.charCodeAt(T))<<18-6*h,3===h||i-T==1){for(l=0;l<3&&v<s;l++,v++)c[v]=p>>>(16>>>l&24)&255;p=0}return c},n.prototype.b64ToUint6=function(e){return e>64&&e<91?e-65:e>96&&e<123?e-71:e>47&&e<58?e+4:43===e?62:47===e?63:0},n}(),ur_unexpectedError_code="unexpected_error",ur_unexpectedError_desc="Unexpected error in authentication.",ae=function(n){function e(t,r,i){var s=this;return s=n.call(this,r?t+": "+r:t)||this,Object.setPrototypeOf(s,e.prototype),s.errorCode=t||y.EMPTY_STRING,s.errorMessage=r||y.EMPTY_STRING,s.subError=i||y.EMPTY_STRING,s.name="AuthError",s}return U(e,n),e.prototype.setCorrelationId=function(t){this.correlationId=t},e.createUnexpectedError=function(t){return new e(ur_unexpectedError_code,ur_unexpectedError_desc+": "+t)},e}(Error),Y_clientInfoDecodingError_code="client_info_decoding_error",Y_clientInfoDecodingError_desc="The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.",Y_clientInfoEmptyError_code="client_info_empty_error",Y_clientInfoEmptyError_desc="The client info was empty. Please review the trace to determine the root cause.",Y_tokenParsingError_code="token_parsing_error",Y_tokenParsingError_desc="Token cannot be parsed. Please review stack trace to determine root cause.",Y_nullOrEmptyToken_code="null_or_empty_token",Y_nullOrEmptyToken_desc="The token is null or empty. Please review the trace to determine the root cause.",Y_endpointResolutionError_code="endpoints_resolution_error",Y_endpointResolutionError_desc="Error: could not resolve endpoints. Please check network and try again.",Y_networkError_code="network_error",Y_networkError_desc="Network request failed. Please check network trace to determine root cause.",Y_unableToGetOpenidConfigError_code="openid_config_error",Y_unableToGetOpenidConfigError_desc="Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",Y_hashNotDeserialized_code="hash_not_deserialized",Y_hashNotDeserialized_desc="The hash parameters could not be deserialized. Please review the trace to determine the root cause.",Y_invalidStateError_code="invalid_state",Y_invalidStateError_desc="State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState().",Y_stateMismatchError_code="state_mismatch",Y_stateMismatchError_desc="State mismatch error. Please check your network. Continued requests may cause cache overflow.",Y_stateNotFoundError_code="state_not_found",Y_stateNotFoundError_desc="State not found",Y_nonceMismatchError_code="nonce_mismatch",Y_nonceMismatchError_desc="Nonce mismatch error. This may be caused by a race condition in concurrent requests.",Y_nonceNotFoundError_code="nonce_not_found",Y_nonceNotFoundError_desc="nonce not found",Y_multipleMatchingTokens_code="multiple_matching_tokens",Y_multipleMatchingTokens_desc="The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",Y_multipleMatchingAccounts_code="multiple_matching_accounts",Y_multipleMatchingAccounts_desc="The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",Y_multipleMatchingAppMetadata_code="multiple_matching_appMetadata",Y_multipleMatchingAppMetadata_desc="The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",Y_tokenRequestCannotBeMade_code="request_cannot_be_made",Y_tokenRequestCannotBeMade_desc="Token request cannot be made without authorization code or refresh token.",Y_appendEmptyScopeError_code="cannot_append_empty_scope",Y_appendEmptyScopeError_desc="Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info.",Y_removeEmptyScopeError_code="cannot_remove_empty_scope",Y_removeEmptyScopeError_desc="Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info.",Y_appendScopeSetError_code="cannot_append_scopeset",Y_appendScopeSetError_desc="Cannot append ScopeSet due to error.",Y_emptyInputScopeSetError_code="empty_input_scopeset",Y_emptyInputScopeSetError_desc="Empty input ScopeSet cannot be processed.",Y_DeviceCodePollingCancelled_code="device_code_polling_cancelled",Y_DeviceCodePollingCancelled_desc="Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",Y_DeviceCodeExpired_code="device_code_expired",Y_DeviceCodeExpired_desc="Device code is expired.",Y_DeviceCodeUnknownError_code="device_code_unknown_error",Y_DeviceCodeUnknownError_desc="Device code stopped polling for unknown reasons.",Y_NoAccountInSilentRequest_code="no_account_in_silent_request",Y_NoAccountInSilentRequest_desc="Please pass an account object, silent flow is not supported without account information",Y_invalidCacheRecord_code="invalid_cache_record",Y_invalidCacheRecord_desc="Cache record object was null or undefined.",Y_invalidCacheEnvironment_code="invalid_cache_environment",Y_invalidCacheEnvironment_desc="Invalid environment when attempting to create cache entry",Y_noAccountFound_code="no_account_found",Y_noAccountFound_desc="No account found in cache for given key.",Y_CachePluginError_code="no cache plugin set on CacheManager",Y_CachePluginError_desc="ICachePlugin needs to be set before using readFromStorage or writeFromStorage",Y_noCryptoObj_code="no_crypto_object",Y_noCryptoObj_desc="No crypto object detected. This is required for the following operation: ",Y_invalidCacheType_code="invalid_cache_type",Y_invalidCacheType_desc="Invalid cache type",Y_unexpectedAccountType_code="unexpected_account_type",Y_unexpectedAccountType_desc="Unexpected account type.",Y_unexpectedCredentialType_code="unexpected_credential_type",Y_unexpectedCredentialType_desc="Unexpected credential type.",Y_invalidAssertion_code="invalid_assertion",Y_invalidAssertion_desc="Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",Y_invalidClientCredential_code="invalid_client_credential",Y_invalidClientCredential_desc="Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",Y_tokenRefreshRequired_code="token_refresh_required",Y_tokenRefreshRequired_desc="Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",Y_userTimeoutReached_code="user_timeout_reached",Y_userTimeoutReached_desc="User defined timeout for device code polling reached",Y_tokenClaimsRequired_code="token_claims_cnf_required_for_signedjwt",Y_tokenClaimsRequired_desc="Cannot generate a POP jwt if the token_claims are not populated",Y_noAuthorizationCodeFromServer_code="authorization_code_missing_from_server_response",Y_noAuthorizationCodeFromServer_desc="Server response does not contain an authorization code to proceed",Y_bindingKeyNotRemovedError_code="binding_key_not_removed",Y_bindingKeyNotRemovedError_desc="Could not remove the credential's binding key from storage.",Y_logoutNotSupported_code="end_session_endpoint_not_supported",Y_logoutNotSupported_desc="Provided authority does not support logout.",ee=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.name="ClientAuthError",Object.setPrototypeOf(i,e.prototype),i}return U(e,n),e.createClientInfoDecodingError=function(t){return new e(Y_clientInfoDecodingError_code,Y_clientInfoDecodingError_desc+" Failed with error: "+t)},e.createClientInfoEmptyError=function(){return new e(Y_clientInfoEmptyError_code,""+Y_clientInfoEmptyError_desc)},e.createTokenParsingError=function(t){return new e(Y_tokenParsingError_code,Y_tokenParsingError_desc+" Failed with error: "+t)},e.createTokenNullOrEmptyError=function(t){return new e(Y_nullOrEmptyToken_code,Y_nullOrEmptyToken_desc+" Raw Token Value: "+t)},e.createEndpointDiscoveryIncompleteError=function(t){return new e(Y_endpointResolutionError_code,Y_endpointResolutionError_desc+" Detail: "+t)},e.createNetworkError=function(t,r){return new e(Y_networkError_code,Y_networkError_desc+" | Fetch client threw: "+r+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToGetOpenidConfigError=function(t){return new e(Y_unableToGetOpenidConfigError_code,Y_unableToGetOpenidConfigError_desc+" Attempted to retrieve endpoints from: "+t)},e.createHashNotDeserializedError=function(t){return new e(Y_hashNotDeserialized_code,Y_hashNotDeserialized_desc+" Given Object: "+t)},e.createInvalidStateError=function(t,r){return new e(Y_invalidStateError_code,Y_invalidStateError_desc+" Invalid State: "+t+", Root Err: "+r)},e.createStateMismatchError=function(){return new e(Y_stateMismatchError_code,Y_stateMismatchError_desc)},e.createStateNotFoundError=function(t){return new e(Y_stateNotFoundError_code,Y_stateNotFoundError_desc+":  "+t)},e.createNonceMismatchError=function(){return new e(Y_nonceMismatchError_code,Y_nonceMismatchError_desc)},e.createNonceNotFoundError=function(t){return new e(Y_nonceNotFoundError_code,Y_nonceNotFoundError_desc+":  "+t)},e.createMultipleMatchingTokensInCacheError=function(){return new e(Y_multipleMatchingTokens_code,Y_multipleMatchingTokens_desc+".")},e.createMultipleMatchingAccountsInCacheError=function(){return new e(Y_multipleMatchingAccounts_code,Y_multipleMatchingAccounts_desc)},e.createMultipleMatchingAppMetadataInCacheError=function(){return new e(Y_multipleMatchingAppMetadata_code,Y_multipleMatchingAppMetadata_desc)},e.createTokenRequestCannotBeMadeError=function(){return new e(Y_tokenRequestCannotBeMade_code,Y_tokenRequestCannotBeMade_desc)},e.createAppendEmptyScopeToSetError=function(t){return new e(Y_appendEmptyScopeError_code,Y_appendEmptyScopeError_desc+" Given Scope: "+t)},e.createRemoveEmptyScopeFromSetError=function(t){return new e(Y_removeEmptyScopeError_code,Y_removeEmptyScopeError_desc+" Given Scope: "+t)},e.createAppendScopeSetError=function(t){return new e(Y_appendScopeSetError_code,Y_appendScopeSetError_desc+" Detail Error: "+t)},e.createEmptyInputScopeSetError=function(){return new e(Y_emptyInputScopeSetError_code,""+Y_emptyInputScopeSetError_desc)},e.createDeviceCodeCancelledError=function(){return new e(Y_DeviceCodePollingCancelled_code,""+Y_DeviceCodePollingCancelled_desc)},e.createDeviceCodeExpiredError=function(){return new e(Y_DeviceCodeExpired_code,""+Y_DeviceCodeExpired_desc)},e.createDeviceCodeUnknownError=function(){return new e(Y_DeviceCodeUnknownError_code,""+Y_DeviceCodeUnknownError_desc)},e.createNoAccountInSilentRequestError=function(){return new e(Y_NoAccountInSilentRequest_code,""+Y_NoAccountInSilentRequest_desc)},e.createNullOrUndefinedCacheRecord=function(){return new e(Y_invalidCacheRecord_code,Y_invalidCacheRecord_desc)},e.createInvalidCacheEnvironmentError=function(){return new e(Y_invalidCacheEnvironment_code,Y_invalidCacheEnvironment_desc)},e.createNoAccountFoundError=function(){return new e(Y_noAccountFound_code,Y_noAccountFound_desc)},e.createCachePluginError=function(){return new e(Y_CachePluginError_code,""+Y_CachePluginError_desc)},e.createNoCryptoObjectError=function(t){return new e(Y_noCryptoObj_code,""+Y_noCryptoObj_desc+t)},e.createInvalidCacheTypeError=function(){return new e(Y_invalidCacheType_code,""+Y_invalidCacheType_desc)},e.createUnexpectedAccountTypeError=function(){return new e(Y_unexpectedAccountType_code,""+Y_unexpectedAccountType_desc)},e.createUnexpectedCredentialTypeError=function(){return new e(Y_unexpectedCredentialType_code,""+Y_unexpectedCredentialType_desc)},e.createInvalidAssertionError=function(){return new e(Y_invalidAssertion_code,""+Y_invalidAssertion_desc)},e.createInvalidCredentialError=function(){return new e(Y_invalidClientCredential_code,""+Y_invalidClientCredential_desc)},e.createRefreshRequiredError=function(){return new e(Y_tokenRefreshRequired_code,Y_tokenRefreshRequired_desc)},e.createUserTimeoutReachedError=function(){return new e(Y_userTimeoutReached_code,Y_userTimeoutReached_desc)},e.createTokenClaimsRequiredError=function(){return new e(Y_tokenClaimsRequired_code,Y_tokenClaimsRequired_desc)},e.createNoAuthCodeInServerResponseError=function(){return new e(Y_noAuthorizationCodeFromServer_code,Y_noAuthorizationCodeFromServer_desc)},e.createBindingKeyNotRemovedError=function(){return new e(Y_bindingKeyNotRemovedError_code,Y_bindingKeyNotRemovedError_desc)},e.createLogoutNotSupportedError=function(){return new e(Y_logoutNotSupported_code,Y_logoutNotSupported_desc)},e}(ae),J=function(){function n(){}return n.decodeAuthToken=function(e){if(n.isEmpty(e))throw ee.createTokenNullOrEmptyError(e);var r=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!r||r.length<4)throw ee.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:r[1],JWSPayload:r[2],JWSSig:r[3]}},n.isEmpty=function(e){return void 0===e||!e||0===e.length},n.isEmptyObj=function(e){if(e&&!n.isEmpty(e))try{var t=JSON.parse(e);return 0===Object.keys(t).length}catch(r){}return!0},n.startsWith=function(e,t){return 0===e.indexOf(t)},n.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},n.queryStringToObject=function(e){var t={},r=e.split("&"),i=function(s){return decodeURIComponent(s.replace(/\+/g," "))};return r.forEach(function(s){if(s.trim()){var c=s.split(/=(.+)/g,2),l=c[0],h=c[1];l&&h&&(t[i(l)]=i(h))}}),t},n.trimArrayEntries=function(e){return e.map(function(t){return t.trim()})},n.removeEmptyStringsFromArray=function(e){return e.filter(function(t){return!n.isEmpty(t)})},n.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(t){return null}},n.matchPattern=function(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)},n}(),j_pkceNotGenerated_code="pkce_not_created",j_pkceNotGenerated_desc="The PKCE code challenge and verifier could not be generated.",j_cryptoDoesNotExist_code="crypto_nonexistent",j_cryptoDoesNotExist_desc="The crypto object or function is not available.",j_httpMethodNotImplementedError_code="http_method_not_implemented",j_httpMethodNotImplementedError_desc="The HTTP method given has not been implemented in this library.",j_emptyNavigateUriError_code="empty_navigate_uri",j_emptyNavigateUriError_desc="Navigation URI is empty. Please check stack trace for more info.",j_hashEmptyError_code="hash_empty_error",j_hashEmptyError_desc="Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash.",j_hashDoesNotContainStateError_code="no_state_in_hash",j_hashDoesNotContainStateError_desc="Hash does not contain state. Please verify that the request originated from msal.",j_hashDoesNotContainKnownPropertiesError_code="hash_does_not_contain_known_properties",j_hashDoesNotContainKnownPropertiesError_desc="Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.",j_unableToParseStateError_code="unable_to_parse_state",j_unableToParseStateError_desc="Unable to parse state. Please verify that the request originated from msal.",j_stateInteractionTypeMismatchError_code="state_interaction_type_mismatch",j_stateInteractionTypeMismatchError_desc="Hash contains state but the interaction type does not match the caller.",j_interactionInProgress_code="interaction_in_progress",j_interactionInProgress_desc="Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.  For more visit: aka.ms/msaljs/browser-errors.",j_popupWindowError_code="popup_window_error",j_popupWindowError_desc="Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",j_emptyWindowError_code="empty_window_error",j_emptyWindowError_desc="window.open returned null or undefined window object.",j_userCancelledError_code="user_cancelled",j_userCancelledError_desc="User cancelled the flow.",j_monitorPopupTimeoutError_code="monitor_window_timeout",j_monitorPopupTimeoutError_desc="Token acquisition in popup failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",j_monitorIframeTimeoutError_code="monitor_window_timeout",j_monitorIframeTimeoutError_desc="Token acquisition in iframe failed due to timeout. For more visit: aka.ms/msaljs/browser-errors.",j_redirectInIframeError_code="redirect_in_iframe",j_redirectInIframeError_desc="Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",j_blockTokenRequestsInHiddenIframeError_code="block_iframe_reload",j_blockTokenRequestsInHiddenIframeError_desc="Request was blocked inside an iframe because MSAL detected an authentication response. For more visit: aka.ms/msaljs/browser-errors",j_blockAcquireTokenInPopupsError_code="block_nested_popups",j_blockAcquireTokenInPopupsError_desc="Request was blocked inside a popup because MSAL detected it was running in a popup.",j_iframeClosedPrematurelyError_code="iframe_closed_prematurely",j_iframeClosedPrematurelyError_desc="The iframe being monitored was closed prematurely.",j_silentLogoutUnsupportedError_code="silent_logout_unsupported",j_silentLogoutUnsupportedError_desc="Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",j_noAccountError_code="no_account_error",j_noAccountError_desc="No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",j_silentPromptValueError_code="silent_prompt_value_error",j_silentPromptValueError_desc="The value given for the prompt value is not valid for silent requests - must be set to 'none'.",j_noTokenRequestCacheError_code="no_token_request_cache_error",j_noTokenRequestCacheError_desc="No token request found in cache.",j_unableToParseTokenRequestCacheError_code="unable_to_parse_token_request_cache_error",j_unableToParseTokenRequestCacheError_desc="The cached token request could not be parsed.",j_noCachedAuthorityError_code="no_cached_authority_error",j_noCachedAuthorityError_desc="No cached authority found.",j_authRequestNotSet_code="auth_request_not_set_error",j_authRequestNotSet_desc="Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",j_invalidCacheType_code="invalid_cache_type",j_invalidCacheType_desc="Invalid cache type",j_notInBrowserEnvironment_code="non_browser_environment",j_notInBrowserEnvironment_desc="Login and token requests are not supported in non-browser environments.",j_databaseNotOpen_code="database_not_open",j_databaseNotOpen_desc="Database is not open!",j_noNetworkConnectivity_code="no_network_connectivity",j_noNetworkConnectivity_desc="No network connectivity. Check your internet connection.",j_postRequestFailed_code="post_request_failed",j_postRequestFailed_desc="Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",j_getRequestFailed_code="get_request_failed",j_getRequestFailed_desc="Network request failed. Please check the network trace to determine root cause.",j_failedToParseNetworkResponse_code="failed_to_parse_response",j_failedToParseNetworkResponse_desc="Failed to parse network response. Check network trace.",j_unableToLoadTokenError_code="unable_to_load_token",j_unableToLoadTokenError_desc="Error loading token to cache.",j_signingKeyNotFoundInStorage_code="crypto_key_not_found",j_signingKeyNotFoundInStorage_desc="Cryptographic Key or Keypair not found in browser storage.",j_authCodeRequired_code="auth_code_required",j_authCodeRequired_desc="An authorization code must be provided (as the `code` property on the request) to this flow.",j_authCodeOrNativeAccountRequired_code="auth_code_or_nativeAccountId_required",j_authCodeOrNativeAccountRequired_desc="An authorization code or nativeAccountId must be provided to this flow.",j_databaseUnavailable_code="database_unavailable",j_databaseUnavailable_desc="IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",j_unableToAcquireTokenFromNativePlatform_code="unable_to_acquire_token_from_native_platform",j_unableToAcquireTokenFromNativePlatform_desc="Unable to acquire token from native platform. For a list of possible reasons visit aka.ms/msaljs/browser-errors.",j_nativeHandshakeTimeout_code="native_handshake_timeout",j_nativeHandshakeTimeout_desc="Timed out while attempting to establish connection to browser extension",j_nativeExtensionNotInstalled_code="native_extension_not_installed",j_nativeExtensionNotInstalled_desc="Native extension is not installed. If you think this is a mistake call the initialize function.",j_nativeConnectionNotEstablished_code="native_connection_not_established",j_nativeConnectionNotEstablished_desc="Connection to native platform has not been established. Please install a compatible browser extension and run initialize(). For more please visit aka.ms/msaljs/browser-errors.",j_nativeBrokerCalledBeforeInitialize_code="native_broker_called_before_initialize",j_nativeBrokerCalledBeforeInitialize_desc="You must call and await the initialize function before attempting to call any other MSAL API when native brokering is enabled. For more please visit aka.ms/msaljs/browser-errors.",j_nativePromptNotSupported_code="native_prompt_not_supported",j_nativePromptNotSupported_desc="The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",Q=function(n){function e(t,r){var i=n.call(this,t,r)||this;return Object.setPrototypeOf(i,e.prototype),i.name="BrowserAuthError",i}return te(e,n),e.createPkceNotGeneratedError=function(t){return new e(j_pkceNotGenerated_code,j_pkceNotGenerated_desc+" Detail:"+t)},e.createCryptoNotAvailableError=function(t){return new e(j_cryptoDoesNotExist_code,j_cryptoDoesNotExist_desc+" Detail:"+t)},e.createHttpMethodNotImplementedError=function(t){return new e(j_httpMethodNotImplementedError_code,j_httpMethodNotImplementedError_desc+" Given Method: "+t)},e.createEmptyNavigationUriError=function(){return new e(j_emptyNavigateUriError_code,j_emptyNavigateUriError_desc)},e.createEmptyHashError=function(t){return new e(j_hashEmptyError_code,j_hashEmptyError_desc+" Given Url: "+t)},e.createHashDoesNotContainStateError=function(){return new e(j_hashDoesNotContainStateError_code,j_hashDoesNotContainStateError_desc)},e.createHashDoesNotContainKnownPropertiesError=function(){return new e(j_hashDoesNotContainKnownPropertiesError_code,j_hashDoesNotContainKnownPropertiesError_desc)},e.createUnableToParseStateError=function(){return new e(j_unableToParseStateError_code,j_unableToParseStateError_desc)},e.createStateInteractionTypeMismatchError=function(){return new e(j_stateInteractionTypeMismatchError_code,j_stateInteractionTypeMismatchError_desc)},e.createInteractionInProgressError=function(){return new e(j_interactionInProgress_code,j_interactionInProgress_desc)},e.createPopupWindowError=function(t){var r=j_popupWindowError_desc;return r=J.isEmpty(t)?r:r+" Details: "+t,new e(j_popupWindowError_code,r)},e.createEmptyWindowCreatedError=function(){return new e(j_emptyWindowError_code,j_emptyWindowError_desc)},e.createUserCancelledError=function(){return new e(j_userCancelledError_code,j_userCancelledError_desc)},e.createMonitorPopupTimeoutError=function(){return new e(j_monitorPopupTimeoutError_code,j_monitorPopupTimeoutError_desc)},e.createMonitorIframeTimeoutError=function(){return new e(j_monitorIframeTimeoutError_code,j_monitorIframeTimeoutError_desc)},e.createRedirectInIframeError=function(t){return new e(j_redirectInIframeError_code,j_redirectInIframeError_desc+" (window.parent !== window) => "+t)},e.createBlockReloadInHiddenIframeError=function(){return new e(j_blockTokenRequestsInHiddenIframeError_code,j_blockTokenRequestsInHiddenIframeError_desc)},e.createBlockAcquireTokenInPopupsError=function(){return new e(j_blockAcquireTokenInPopupsError_code,j_blockAcquireTokenInPopupsError_desc)},e.createIframeClosedPrematurelyError=function(){return new e(j_iframeClosedPrematurelyError_code,j_iframeClosedPrematurelyError_desc)},e.createSilentLogoutUnsupportedError=function(){return new e(j_silentLogoutUnsupportedError_code,j_silentLogoutUnsupportedError_desc)},e.createNoAccountError=function(){return new e(j_noAccountError_code,j_noAccountError_desc)},e.createSilentPromptValueError=function(t){return new e(j_silentPromptValueError_code,j_silentPromptValueError_desc+" Given value: "+t)},e.createUnableToParseTokenRequestCacheError=function(){return new e(j_unableToParseTokenRequestCacheError_code,j_unableToParseTokenRequestCacheError_desc)},e.createNoTokenRequestCacheError=function(){return new e(j_noTokenRequestCacheError_code,j_noTokenRequestCacheError_desc)},e.createAuthRequestNotSetError=function(){return new e(j_authRequestNotSet_code,j_authRequestNotSet_desc)},e.createNoCachedAuthorityError=function(){return new e(j_noCachedAuthorityError_code,j_noCachedAuthorityError_desc)},e.createInvalidCacheTypeError=function(){return new e(j_invalidCacheType_code,""+j_invalidCacheType_desc)},e.createNonBrowserEnvironmentError=function(){return new e(j_notInBrowserEnvironment_code,j_notInBrowserEnvironment_desc)},e.createDatabaseNotOpenError=function(){return new e(j_databaseNotOpen_code,j_databaseNotOpen_desc)},e.createNoNetworkConnectivityError=function(){return new e(j_noNetworkConnectivity_code,j_noNetworkConnectivity_desc)},e.createPostRequestFailedError=function(t,r){return new e(j_postRequestFailed_code,j_postRequestFailed_desc+" | Network client threw: "+t+" | Attempted to reach: "+r.split("?")[0])},e.createGetRequestFailedError=function(t,r){return new e(j_getRequestFailed_code,j_getRequestFailed_desc+" | Network client threw: "+t+" | Attempted to reach: "+r.split("?")[0])},e.createFailedToParseNetworkResponseError=function(t){return new e(j_failedToParseNetworkResponse_code,j_failedToParseNetworkResponse_desc+" | Attempted to reach: "+t.split("?")[0])},e.createUnableToLoadTokenError=function(t){return new e(j_unableToLoadTokenError_code,j_unableToLoadTokenError_desc+" | "+t)},e.createSigningKeyNotFoundInStorageError=function(t){return new e(j_signingKeyNotFoundInStorage_code,j_signingKeyNotFoundInStorage_desc+" | No match found for KeyId: "+t)},e.createAuthCodeRequiredError=function(){return new e(j_authCodeRequired_code,j_authCodeRequired_desc)},e.createAuthCodeOrNativeAccountIdRequiredError=function(){return new e(j_authCodeOrNativeAccountRequired_code,j_authCodeOrNativeAccountRequired_desc)},e.createDatabaseUnavailableError=function(){return new e(j_databaseUnavailable_code,j_databaseUnavailable_desc)},e.createUnableToAcquireTokenFromNativePlatformError=function(){return new e(j_unableToAcquireTokenFromNativePlatform_code,j_unableToAcquireTokenFromNativePlatform_desc)},e.createNativeHandshakeTimeoutError=function(){return new e(j_nativeHandshakeTimeout_code,j_nativeHandshakeTimeout_desc)},e.createNativeExtensionNotInstalledError=function(){return new e(j_nativeExtensionNotInstalled_code,j_nativeExtensionNotInstalled_desc)},e.createNativeConnectionNotEstablishedError=function(){return new e(j_nativeConnectionNotEstablished_code,j_nativeConnectionNotEstablished_desc)},e.createNativeBrokerCalledBeforeInitialize=function(){return new e(j_nativeBrokerCalledBeforeInitialize_code,j_nativeBrokerCalledBeforeInitialize_desc)},e.createNativePromptParameterNotSupportedError=function(){return new e(j_nativePromptNotSupported_code,j_nativePromptNotSupported_desc)},e}(ae),Nr=function(){function n(e){this.base64Encode=new lr,this.cryptoObj=e}return n.prototype.generateCodes=function(){return L(this,void 0,void 0,function(){var e,t;return x(this,function(r){switch(r.label){case 0:return e=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(e)];case 1:return t=r.sent(),[2,{verifier:e,challenge:t}]}})})},n.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(r){throw Q.createPkceNotGeneratedError(r)}},n.prototype.generateCodeChallengeFromVerifier=function(e){return L(this,void 0,void 0,function(){var t,r;return x(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(e)];case 1:return t=i.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=i.sent(),Q.createPkceNotGeneratedError(r);case 3:return[2]}})})},n}(),Vt="SHA-256",Mr=new Uint8Array([1,0,1]),Lt=function(){function n(e){if(this.logger=e,!this.hasCryptoAPI())throw Q.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:Vt,modulusLength:2048,publicExponent:Mr}}return n.prototype.sha256Digest=function(e){return L(this,void 0,void 0,function(){var t;return x(this,function(r){return t=_t.stringToUtf8Arr(e),[2,this.hasIECrypto()?this.getMSCryptoDigest(Vt,t):this.getSubtleCryptoDigest(Vt,t)]})})},n.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw Q.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},n.prototype.generateKeyPair=function(e,t){return L(this,void 0,void 0,function(){return x(this,function(r){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(e,t):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,e,t)]})})},n.prototype.exportJwk=function(e){return L(this,void 0,void 0,function(){return x(this,function(t){return[2,this.hasIECrypto()?this.msCryptoExportJwk(e):window.crypto.subtle.exportKey(Rt,e)]})})},n.prototype.importJwk=function(e,t,r){return L(this,void 0,void 0,function(){var i,s;return x(this,function(c){return i=n.getJwkString(e),s=_t.stringToArrayBuffer(i),[2,this.hasIECrypto()?this.msCryptoImportKey(s,t,r):window.crypto.subtle.importKey(Rt,e,this._keygenAlgorithmOptions,t,r)]})})},n.prototype.sign=function(e,t){return L(this,void 0,void 0,function(){return x(this,function(r){return[2,this.hasIECrypto()?this.msCryptoSign(e,t):window.crypto.subtle.sign(this._keygenAlgorithmOptions,e,t)]})})},n.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},n.prototype.hasIECrypto=function(){return"msCrypto"in window},n.prototype.hasBrowserCrypto=function(){return"crypto"in window},n.prototype.getSubtleCryptoDigest=function(e,t){return L(this,void 0,void 0,function(){return x(this,function(r){return[2,window.crypto.subtle.digest(e,t)]})})},n.prototype.getMSCryptoDigest=function(e,t){return L(this,void 0,void 0,function(){return x(this,function(r){return[2,new Promise(function(i,s){var c=window.msCrypto.subtle.digest(e,t.buffer);c.addEventListener("complete",function(l){i(l.target.result)}),c.addEventListener("error",function(l){s(l)})})]})})},n.prototype.msCryptoGenerateKey=function(e,t){return L(this,void 0,void 0,function(){var r=this;return x(this,function(i){return[2,new Promise(function(s,c){var l=window.msCrypto.subtle.generateKey(r._keygenAlgorithmOptions,e,t);l.addEventListener("complete",function(h){s(h.target.result)}),l.addEventListener("error",function(h){c(h)})})]})})},n.prototype.msCryptoExportJwk=function(e){return L(this,void 0,void 0,function(){return x(this,function(t){return[2,new Promise(function(r,i){var s=window.msCrypto.subtle.exportKey(Rt,e);s.addEventListener("complete",function(c){var h=_t.utf8ArrToString(new Uint8Array(c.target.result)).replace(/\r/g,y.EMPTY_STRING).replace(/\n/g,y.EMPTY_STRING).replace(/\t/g,y.EMPTY_STRING).split(" ").join(y.EMPTY_STRING).replace("\0",y.EMPTY_STRING);try{r(JSON.parse(h))}catch(p){i(p)}}),s.addEventListener("error",function(c){i(c)})})]})})},n.prototype.msCryptoImportKey=function(e,t,r){return L(this,void 0,void 0,function(){var i=this;return x(this,function(s){return[2,new Promise(function(c,l){var h=window.msCrypto.subtle.importKey(Rt,e,i._keygenAlgorithmOptions,t,r);h.addEventListener("complete",function(p){c(p.target.result)}),h.addEventListener("error",function(p){l(p)})})]})})},n.prototype.msCryptoSign=function(e,t){return L(this,void 0,void 0,function(){var r=this;return x(this,function(i){return[2,new Promise(function(s,c){var l=window.msCrypto.subtle.sign(r._keygenAlgorithmOptions,e,t);l.addEventListener("complete",function(h){s(h.target.result)}),l.addEventListener("error",function(h){c(h)})})]})})},n.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},n}(),xr=function(){function n(){this.dbName=Ut,this.version=1,this.tableName="msal.db.keys",this.dbOpen=!1}return n.prototype.open=function(){return L(this,void 0,void 0,function(){var e=this;return x(this,function(t){return[2,new Promise(function(r,i){var s=window.indexedDB.open(e.dbName,e.version);s.addEventListener("upgradeneeded",function(c){c.target.result.createObjectStore(e.tableName)}),s.addEventListener("success",function(c){e.db=c.target.result,e.dbOpen=!0,r()}),s.addEventListener("error",function(){return i(Q.createDatabaseUnavailableError())})})]})})},n.prototype.closeConnection=function(){var e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)},n.prototype.validateDbIsOpen=function(){return L(this,void 0,void 0,function(){return x(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:return[2,e.sent()];case 2:return[2]}})})},n.prototype.getItem=function(e){return L(this,void 0,void 0,function(){var t=this;return x(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(i,s){if(!t.db)return s(Q.createDatabaseNotOpenError());var h=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).get(e);h.addEventListener("success",function(p){var v=p;t.closeConnection(),i(v.target.result)}),h.addEventListener("error",function(p){t.closeConnection(),s(p)})})]}})})},n.prototype.setItem=function(e,t){return L(this,void 0,void 0,function(){var r=this;return x(this,function(i){switch(i.label){case 0:return[4,this.validateDbIsOpen()];case 1:return i.sent(),[2,new Promise(function(s,c){if(!r.db)return c(Q.createDatabaseNotOpenError());var p=r.db.transaction([r.tableName],"readwrite").objectStore(r.tableName).put(t,e);p.addEventListener("success",function(){r.closeConnection(),s()}),p.addEventListener("error",function(v){r.closeConnection(),c(v)})})]}})})},n.prototype.removeItem=function(e){return L(this,void 0,void 0,function(){var t=this;return x(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(i,s){if(!t.db)return s(Q.createDatabaseNotOpenError());var h=t.db.transaction([t.tableName],"readwrite").objectStore(t.tableName).delete(e);h.addEventListener("success",function(){t.closeConnection(),i()}),h.addEventListener("error",function(p){t.closeConnection(),s(p)})})]}})})},n.prototype.getKeys=function(){return L(this,void 0,void 0,function(){var e=this;return x(this,function(t){switch(t.label){case 0:return[4,this.validateDbIsOpen()];case 1:return t.sent(),[2,new Promise(function(r,i){if(!e.db)return i(Q.createDatabaseNotOpenError());var l=e.db.transaction([e.tableName],"readonly").objectStore(e.tableName).getAllKeys();l.addEventListener("success",function(h){var p=h;e.closeConnection(),r(p.target.result)}),l.addEventListener("error",function(h){e.closeConnection(),i(h)})})]}})})},n.prototype.containsKey=function(e){return L(this,void 0,void 0,function(){var t=this;return x(this,function(r){switch(r.label){case 0:return[4,this.validateDbIsOpen()];case 1:return r.sent(),[2,new Promise(function(i,s){if(!t.db)return s(Q.createDatabaseNotOpenError());var h=t.db.transaction([t.tableName],"readonly").objectStore(t.tableName).count(e);h.addEventListener("success",function(p){var v=p;t.closeConnection(),i(1===v.target.result)}),h.addEventListener("error",function(p){t.closeConnection(),s(p)})})]}})})},n.prototype.deleteDatabase=function(){return L(this,void 0,void 0,function(){return x(this,function(r){switch(r.label){case 0:return this.db&&this.dbOpen&&this.closeConnection(),[4,window.indexedDB.databases()];case 1:return r.sent().find(function(i){return i.name===Ut})?[2,new Promise(function(i,s){var c=window.indexedDB.deleteDatabase(Ut);c.addEventListener("success",function(){return i(!0)}),c.addEventListener("error",function(){return s(!1)})})]:[2,!0]}})})},n}(),Qt=function(){function n(){this.cache=new Map}return n.prototype.getItem=function(e){return this.cache.get(e)||null},n.prototype.setItem=function(e,t){this.cache.set(e,t)},n.prototype.removeItem=function(e){this.cache.delete(e)},n.prototype.getKeys=function(){var e=[];return this.cache.forEach(function(t,r){e.push(r)}),e},n.prototype.containsKey=function(e){return this.cache.has(e)},n.prototype.clear=function(){this.cache.clear()},n}(),hr=function(){function n(e,t){this.inMemoryCache=new Qt,this.indexedDBCache=new xr,this.logger=e,this.storeName=t}return n.prototype.handleDatabaseAccessError=function(e){if(!(e instanceof Q&&e.errorCode===j_databaseUnavailable_code))throw e;this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.")},n.prototype.getItem=function(e){return L(this,void 0,void 0,function(){var t,r;return x(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.getItem(e))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.getItem(e)];case 2:return[2,i.sent()];case 3:return r=i.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}})})},n.prototype.setItem=function(e,t){return L(this,void 0,void 0,function(){var r;return x(this,function(i){switch(i.label){case 0:this.inMemoryCache.setItem(e,t),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.indexedDBCache.setItem(e,t)];case 2:return i.sent(),[3,4];case 3:return r=i.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2]}})})},n.prototype.removeItem=function(e){return L(this,void 0,void 0,function(){var t;return x(this,function(r){switch(r.label){case 0:this.inMemoryCache.removeItem(e),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.removeItem(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2]}})})},n.prototype.getKeys=function(){return L(this,void 0,void 0,function(){var e,t;return x(this,function(r){switch(r.label){case 0:if(0!==(e=this.inMemoryCache.getKeys()).length)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),this.logger.verbose("In-memory cache is empty, now querying persistent storage."),[4,this.indexedDBCache.getKeys()];case 2:return[2,r.sent()];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[3,4];case 4:return[2,e]}})})},n.prototype.containsKey=function(e){return L(this,void 0,void 0,function(){var t,r;return x(this,function(i){switch(i.label){case 0:if(t=this.inMemoryCache.containsKey(e))return[3,4];i.label=1;case 1:return i.trys.push([1,3,,4]),this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),[4,this.indexedDBCache.containsKey(e)];case 2:return[2,i.sent()];case 3:return r=i.sent(),this.handleDatabaseAccessError(r),[3,4];case 4:return[2,t]}})})},n.prototype.clear=function(){return L(this,void 0,void 0,function(){var e,t;return x(this,function(r){switch(r.label){case 0:this.logger.verbose("Deleting in-memory keystore "+this.storeName),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore "+this.storeName+" deleted"),this.logger.verbose("Deleting persistent keystore "+this.storeName),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.indexedDBCache.deleteDatabase()];case 2:return(e=r.sent())&&this.logger.verbose("Persistent keystore "+this.storeName+" deleted"),[2,e];case 3:return t=r.sent(),this.handleDatabaseAccessError(t),[2,!1];case 4:return[2]}})})},n}(),bt=(()=>{return(n=bt||(bt={})).asymmetricKeys="asymmetricKeys",n.symmetricKeys="symmetricKeys",bt;var n})(),Ur=function(){function n(e,t){this.logger=e,this.browserCrypto=new Lt(this.logger),this.b64Encode=new lr,this.b64Decode=new br,this.guidGenerator=new cr(this.browserCrypto),this.pkceGenerator=new Nr(this.browserCrypto),this.cache={asymmetricKeys:new hr(this.logger,bt.asymmetricKeys),symmetricKeys:new hr(this.logger,bt.symmetricKeys)},this.performanceClient=t}return n.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},n.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},n.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},n.prototype.generatePkceCodes=function(){return L(this,void 0,void 0,function(){return x(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},n.prototype.getPublicKeyThumbprint=function(e){var t;return L(this,void 0,void 0,function(){var r,i,s,l,h,p,v;return x(this,function(T){switch(T.label){case 0:return r=null===(t=this.performanceClient)||void 0===t?void 0:t.startMeasurement(fe.CryptoOptsGetPublicKeyThumbprint,e.correlationId),[4,this.browserCrypto.generateKeyPair(n.EXTRACTABLE,n.POP_KEY_USAGES)];case 1:return i=T.sent(),[4,this.browserCrypto.exportJwk(i.publicKey)];case 2:return s=T.sent(),l=Lt.getJwkString({e:s.e,kty:s.kty,n:s.n}),[4,this.hashString(l)];case 3:return h=T.sent(),[4,this.browserCrypto.exportJwk(i.privateKey)];case 4:return p=T.sent(),[4,this.browserCrypto.importJwk(p,!1,["sign"])];case 5:return v=T.sent(),[4,this.cache.asymmetricKeys.setItem(h,{privateKey:v,publicKey:i.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri})];case 6:return T.sent(),r&&r.endMeasurement({success:!0}),[2,h]}})})},n.prototype.removeTokenBindingKey=function(e){return L(this,void 0,void 0,function(){return x(this,function(r){switch(r.label){case 0:return[4,this.cache.asymmetricKeys.removeItem(e)];case 1:return r.sent(),[4,this.cache.asymmetricKeys.containsKey(e)];case 2:return[2,!r.sent()]}})})},n.prototype.clearKeystore=function(){return L(this,void 0,void 0,function(){var e;return x(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),this.logger.verbose("Deleting in-memory and persistent asymmetric key stores"),[4,this.cache.asymmetricKeys.clear()];case 1:return t.sent(),this.logger.verbose("Successfully deleted asymmetric key stores"),this.logger.verbose("Deleting in-memory and persistent symmetric key stores"),[4,this.cache.symmetricKeys.clear()];case 2:return t.sent(),this.logger.verbose("Successfully deleted symmetric key stores"),[2,!0];case 3:return(e=t.sent())instanceof Error?this.logger.error("Clearing keystore failed with error: "+e.message):this.logger.error("Clearing keystore failed with unknown error"),[2,!1];case 4:return[2]}})})},n.prototype.signJwt=function(e,t,r){var i;return L(this,void 0,void 0,function(){var s,c,l,h,v,T,R,V,$,le,oe;return x(this,function(ie){switch(ie.label){case 0:return s=null===(i=this.performanceClient)||void 0===i?void 0:i.startMeasurement(fe.CryptoOptsSignJwt,r),[4,this.cache.asymmetricKeys.getItem(t)];case 1:if(!(c=ie.sent()))throw Q.createSigningKeyNotFoundInStorageError(t);return[4,this.browserCrypto.exportJwk(c.publicKey)];case 2:return l=ie.sent(),h=Lt.getJwkString(l),v=this.b64Encode.urlEncode(JSON.stringify({alg:l.alg,type:Rt})),e.cnf={jwk:JSON.parse(h)},T=this.b64Encode.urlEncode(JSON.stringify(e)),V=_t.stringToArrayBuffer(R=v+"."+T),[4,this.browserCrypto.sign(c.privateKey,V)];case 3:return $=ie.sent(),le=this.b64Encode.urlEncodeArr(new Uint8Array($)),oe=R+"."+le,s&&s.endMeasurement({success:!0}),[2,oe]}})})},n.prototype.hashString=function(e){return L(this,void 0,void 0,function(){var t,r;return x(this,function(i){switch(i.label){case 0:return[4,this.browserCrypto.sha256Digest(e)];case 1:return t=i.sent(),r=new Uint8Array(t),[2,this.b64Encode.urlEncodeArr(r)]}})})},n.POP_KEY_USAGES=["sign","verify"],n.EXTRACTABLE=!0,n}(),Ne=(()=>{return(n=Ne||(Ne={}))[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace",Ne;var n})(),dr=function(){function n(e,t,r){this.level=Ne.Info,this.localCallback=e.loggerCallback||function(){},this.piiLoggingEnabled=e.piiLoggingEnabled||!1,this.level="number"==typeof e.logLevel?e.logLevel:Ne.Info,this.correlationId=e.correlationId||y.EMPTY_STRING,this.packageName=t||y.EMPTY_STRING,this.packageVersion=r||y.EMPTY_STRING}return n.prototype.clone=function(e,t,r){return new n({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)},n.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var i,r=(new Date).toUTCString();i=J.isEmpty(t.correlationId)?J.isEmpty(this.correlationId)?"["+r+"]":"["+r+"] : ["+this.correlationId+"]":"["+r+"] : ["+t.correlationId+"]",this.executeCallback(t.logLevel,i+" : "+this.packageName+"@"+this.packageVersion+" : "+Ne[t.logLevel]+" - "+e,t.containsPii||!1)}},n.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},n.prototype.error=function(e,t){this.logMessage(e,{logLevel:Ne.Error,containsPii:!1,correlationId:t||y.EMPTY_STRING})},n.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:Ne.Error,containsPii:!0,correlationId:t||y.EMPTY_STRING})},n.prototype.warning=function(e,t){this.logMessage(e,{logLevel:Ne.Warning,containsPii:!1,correlationId:t||y.EMPTY_STRING})},n.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:Ne.Warning,containsPii:!0,correlationId:t||y.EMPTY_STRING})},n.prototype.info=function(e,t){this.logMessage(e,{logLevel:Ne.Info,containsPii:!1,correlationId:t||y.EMPTY_STRING})},n.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:Ne.Info,containsPii:!0,correlationId:t||y.EMPTY_STRING})},n.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:Ne.Verbose,containsPii:!1,correlationId:t||y.EMPTY_STRING})},n.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:Ne.Verbose,containsPii:!0,correlationId:t||y.EMPTY_STRING})},n.prototype.trace=function(e,t){this.logMessage(e,{logLevel:Ne.Trace,containsPii:!1,correlationId:t||y.EMPTY_STRING})},n.prototype.tracePii=function(e,t){this.logMessage(e,{logLevel:Ne.Trace,containsPii:!0,correlationId:t||y.EMPTY_STRING})},n.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},n}(),pr=function(){function n(e,t,r,i,s,c){this.authority=t,this.libraryName=i,this.libraryVersion=s,this.applicationTelemetry=c,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.measurementsById=new Map}return n.prototype.startMeasurement=function(e,t){var i,s,r=this,c=t||this.generateId();t||this.logger.info("PerformanceClient: No correlation id provided for "+e+", generating",c),this.logger.trace("PerformanceClient: Performance measurement started for "+e,c);var l=this.startPerformanceMeasuremeant(e,c);l.startMeasurement();var h={eventId:this.generateId(),status:Te.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,appName:null===(i=this.applicationTelemetry)||void 0===i?void 0:i.appName,appVersion:null===(s=this.applicationTelemetry)||void 0===s?void 0:s.appVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:c};return this.cacheEventByCorrelationId(h),this.cacheMeasurement(h,l),{endMeasurement:function(p){var v=r.endMeasurement(k(k({},h),p));return v&&r.cacheEventByCorrelationId(v),v},flushMeasurement:function(){return r.flushMeasurements(h.name,h.correlationId)},discardMeasurement:function(){return r.discardMeasurements(h.correlationId)},measurement:l,event:h}},n.prototype.endMeasurement=function(e){var t=this.measurementsById.get(e.eventId);if(t){this.measurementsById.delete(e.eventId),t.endMeasurement();var r=t.flushMeasurement();if(null!==r)return this.logger.trace("PerformanceClient: Performance measurement ended for "+e.name+": "+r+" ms",e.correlationId),k(k({durationMs:Math.round(r)},e),{status:Te.Completed});this.logger.trace("PerformanceClient: Performance measurement not taken",e.correlationId)}else this.logger.trace("PerformanceClient: Measurement not found for "+e.eventId,e.correlationId);return null},n.prototype.cacheEventByCorrelationId=function(e){var t=this.eventsByCorrelationId.get(e.correlationId);t?(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" added/updated",e.correlationId),t.set(e.eventId,e)):(this.logger.trace("PerformanceClient: Performance measurement for "+e.name+" started",e.correlationId),this.eventsByCorrelationId.set(e.correlationId,(new Map).set(e.eventId,e)))},n.prototype.cacheMeasurement=function(e,t){this.measurementsById.set(e.eventId,t)},n.prototype.flushMeasurements=function(e,t){var r=this;this.logger.trace("PerformanceClient: Performance measurements flushed for "+e,t);var i=this.eventsByCorrelationId.get(t);if(i){this.discardMeasurements(t);var s=[];i.forEach(function(v){if(v.name!==e&&v.status!==Te.Completed){r.logger.trace("PerformanceClient: Incomplete submeasurement "+v.name+" found for "+e,t);var T=r.endMeasurement(v);T&&s.push(T)}s.push(v)});var c=s.sort(function(v,T){return v.startTimeMs-T.startTimeMs}),l=c.filter(function(v){return v.name===e&&v.status===Te.Completed});if(l.length>0){l.length>1&&this.logger.verbose("PerformanceClient: Multiple distinct top-level performance events found, using the first",t);var h=l[0];this.logger.verbose("PerformanceClient: Measurement found for "+e,t);var p=c.reduce(function(v,T){if(T.name!==e){r.logger.trace("PerformanceClient: Complete submeasurement found for "+T.name,t);var R=T.name+"DurationMs";v[R]?r.logger.verbose("PerformanceClient: Submeasurement for "+e+" already exists for "+T.name+", ignoring",t):v[R]=T.durationMs}return v},h);this.emitEvents([p],p.correlationId)}else this.logger.verbose("PerformanceClient: No completed top-level measurements found for "+e,t)}else this.logger.verbose("PerformanceClient: No measurements found",t)},n.prototype.discardMeasurements=function(e){this.logger.trace("PerformanceClient: Performance measurements discarded",e),this.eventsByCorrelationId.delete(e)},n.prototype.addPerformanceCallback=function(e){var t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("PerformanceClient: Performance callback registered with id: "+t),t},n.prototype.removePerformanceCallback=function(e){var t=this.callbacks.delete(e);return this.logger.verbose(t?"PerformanceClient: Performance callback "+e+" removed.":"PerformanceClient: Performance callback "+e+" not removed."),t},n.prototype.emitEvents=function(e,t){var r=this;this.logger.verbose("PerformanceClient: Emitting performance events",t),this.callbacks.forEach(function(i,s){r.logger.trace("PerformanceClient: Emitting event to callback "+s,t),i.apply(null,[e])})},n}(),Lr=function(){function n(){}return n.prototype.startMeasurement=function(){},n.prototype.endMeasurement=function(){},n.prototype.flushMeasurement=function(){return null},n}(),Dr=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return U(e,n),e.prototype.generateId=function(){return"callback-id"},e.prototype.startPerformanceMeasuremeant=function(){return new Lr},e}(pr),Dt={createNewGuid:function(){throw ae.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw ae.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw ae.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})},getPublicKeyThumbprint:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")})})},removeTokenBindingKey:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Crypto interface - removeTokenBindingKey() has not been implemented")})})},clearKeystore:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Crypto interface - clearKeystore() has not been implemented")})})},signJwt:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Crypto interface - signJwt() has not been implemented")})})},hashString:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Crypto interface - hashString() has not been implemented")})})}},pt=function(n){function e(t,r,i){var s=n.call(this,t,r,i)||this;return s.name="ServerError",Object.setPrototypeOf(s,e.prototype),s}return U(e,n),e}(ae),fr=["interaction_required","consent_required","login_required"],Hr=["message_only","additional_action","basic_action","user_password_expired","consent_required"],Jt_noTokensFoundError_code="no_tokens_found",Jt_noTokensFoundError_desc="No refresh token found in the cache. Please sign-in.",ct=function(n){function e(t,r,i){var s=n.call(this,t,r,i)||this;return s.name="InteractionRequiredAuthError",Object.setPrototypeOf(s,e.prototype),s}return U(e,n),e.isInteractionRequiredError=function(t,r,i){var s=!!t&&fr.indexOf(t)>-1,c=!!i&&Hr.indexOf(i)>-1,l=!!r&&fr.some(function(h){return r.indexOf(h)>-1});return s||l||c},e.createNoTokensFoundError=function(){return new e(Jt_noTokensFoundError_code,Jt_noTokensFoundError_desc)},e}(ae);function Ht(n,e){if(J.isEmpty(n))throw ee.createClientInfoEmptyError();try{var t=e.base64Decode(n);return JSON.parse(t)}catch(r){throw ee.createClientInfoDecodingError(r)}}function Ot(n){if(J.isEmpty(n))throw ee.createClientInfoDecodingError("Home account ID was empty.");var e=n.split(xe.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?y.EMPTY_STRING:e[1]}}var tt=(()=>{return(n=tt||(tt={}))[n.Default=0]="Default",n[n.Adfs=1]="Adfs",tt;var n})(),De=function(){function n(){}return n.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},n.prototype.generateAccountKey=function(){return n.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})},n.prototype.generateType=function(){switch(this.authorityType){case je.ADFS_ACCOUNT_TYPE:return We.ADFS;case je.MSAV1_ACCOUNT_TYPE:return We.MSA;case je.MSSTS_ACCOUNT_TYPE:return We.MSSTS;case je.GENERIC_ACCOUNT_TYPE:return We.GENERIC;default:throw ee.createUnexpectedAccountTypeError()}},n.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,idTokenClaims:this.idTokenClaims,nativeAccountId:this.nativeAccountId}},n.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||y.EMPTY_STRING,e.tenantId||y.EMPTY_STRING].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},n.createAccount=function(e,t,r,i,s,c,l,h,p){var v,T,R,V,$,le,oe=new n;oe.authorityType=je.MSSTS_ACCOUNT_TYPE,oe.clientInfo=e,oe.homeAccountId=t,oe.nativeAccountId=p;var ie=h||i&&i.getPreferredCache();if(!ie)throw ee.createInvalidCacheEnvironmentError();return oe.environment=ie,oe.realm=(null===(v=null==r?void 0:r.claims)||void 0===v?void 0:v.tid)||y.EMPTY_STRING,oe.oboAssertion=s,r&&(oe.idTokenClaims=r.claims,oe.localAccountId=(null===(T=null==r?void 0:r.claims)||void 0===T?void 0:T.oid)||(null===(R=null==r?void 0:r.claims)||void 0===R?void 0:R.sub)||y.EMPTY_STRING,oe.username=(null===(V=null==r?void 0:r.claims)||void 0===V?void 0:V.preferred_username)||((null===($=null==r?void 0:r.claims)||void 0===$?void 0:$.emails)?r.claims.emails[0]:y.EMPTY_STRING),oe.name=null===(le=null==r?void 0:r.claims)||void 0===le?void 0:le.name),oe.cloudGraphHostName=c,oe.msGraphHost=l,oe},n.createGenericAccount=function(e,t,r,i,s,c,l){var h,p,v,T,R=new n;R.authorityType=r&&r.authorityType===tt.Adfs?je.ADFS_ACCOUNT_TYPE:je.GENERIC_ACCOUNT_TYPE,R.homeAccountId=e,R.realm=y.EMPTY_STRING,R.oboAssertion=i;var V=l||r&&r.getPreferredCache();if(!V)throw ee.createInvalidCacheEnvironmentError();return t&&(R.localAccountId=(null===(h=null==t?void 0:t.claims)||void 0===h?void 0:h.oid)||(null===(p=null==t?void 0:t.claims)||void 0===p?void 0:p.sub)||y.EMPTY_STRING,R.username=(null===(v=null==t?void 0:t.claims)||void 0===v?void 0:v.upn)||y.EMPTY_STRING,R.name=(null===(T=null==t?void 0:t.claims)||void 0===T?void 0:T.name)||y.EMPTY_STRING,R.idTokenClaims=null==t?void 0:t.claims),R.environment=V,R.cloudGraphHostName=s,R.msGraphHost=c,R},n.generateHomeAccountId=function(e,t,r,i,s){var c,l=(null===(c=null==s?void 0:s.claims)||void 0===c?void 0:c.sub)?s.claims.sub:y.EMPTY_STRING;if(t===tt.Adfs)return l;if(e)try{var h=Ht(e,i);if(!J.isEmpty(h.uid)&&!J.isEmpty(h.utid))return""+h.uid+xe.CLIENT_INFO_SEPARATOR+h.utid}catch(p){}return r.verbose("No client info in response"),l},n.isAccountEntity=function(e){return!!e&&e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},n.accountInfoIsEqual=function(e,t,r){if(!e||!t)return!1;var i=!0;if(r){var s=e.idTokenClaims||{},c=t.idTokenClaims||{};i=s.iat===c.iat&&s.nonce===c.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i},n}(),Nt=function(){function n(){}return n.prototype.generateAccountId=function(){return n.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},n.prototype.generateCredentialId=function(){return n.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},n.prototype.generateTarget=function(){return n.generateTargetForCacheKey(this.target)},n.prototype.generateCredentialKey=function(){return n.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId,this.tokenType,this.requestedClaimsHash)},n.prototype.generateType=function(){switch(this.credentialType){case pe.ID_TOKEN:return We.ID_TOKEN;case pe.ACCESS_TOKEN:case pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:return We.ACCESS_TOKEN;case pe.REFRESH_TOKEN:return We.REFRESH_TOKEN;default:throw ee.createUnexpectedCredentialTypeError()}},n.getCredentialType=function(e){return-1!==e.indexOf(pe.ACCESS_TOKEN.toLowerCase())?-1!==e.indexOf(pe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())?pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:pe.ACCESS_TOKEN:-1!==e.indexOf(pe.ID_TOKEN.toLowerCase())?pe.ID_TOKEN:-1!==e.indexOf(pe.REFRESH_TOKEN.toLowerCase())?pe.REFRESH_TOKEN:y.NOT_DEFINED},n.generateCredentialCacheKey=function(e,t,r,i,s,c,l,h,p){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,i,s,l),this.generateTargetForCacheKey(c),this.generateClaimsHashForCacheKey(p),this.generateSchemeForCacheKey(h)].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},n.generateAccountIdForCacheKey=function(e,t){return[e,t].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},n.generateCredentialIdForCacheKey=function(e,t,r,i){return[e,e===pe.REFRESH_TOKEN&&i||t,r||y.EMPTY_STRING].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},n.generateTargetForCacheKey=function(e){return(e||y.EMPTY_STRING).toLowerCase()},n.generateClaimsHashForCacheKey=function(e){return(e||y.EMPTY_STRING).toLowerCase()},n.generateSchemeForCacheKey=function(e){return e&&e.toLowerCase()!==P.BEARER.toLowerCase()?e.toLowerCase():y.EMPTY_STRING},n}(),de_redirectUriNotSet_code="redirect_uri_empty",de_redirectUriNotSet_desc="A redirect URI is required for all calls, and none has been set.",de_postLogoutUriNotSet_code="post_logout_uri_empty",de_postLogoutUriNotSet_desc="A post logout redirect has not been set.",de_claimsRequestParsingError_code="claims_request_parsing_error",de_claimsRequestParsingError_desc="Could not parse the given claims request object.",de_authorityUriInsecure_code="authority_uri_insecure",de_authorityUriInsecure_desc="Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",de_urlParseError_code="url_parse_error",de_urlParseError_desc="URL could not be parsed into appropriate segments.",de_urlEmptyError_code="empty_url_error",de_urlEmptyError_desc="URL was empty or null.",de_emptyScopesError_code="empty_input_scopes_error",de_emptyScopesError_desc="Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",de_clientIdSingleScopeError_code="clientid_input_scopes_error",de_clientIdSingleScopeError_desc="Client ID can only be provided as a single scope.",de_invalidPrompt_code="invalid_prompt_value",de_invalidPrompt_desc="Supported prompt values are 'login', 'select_account', 'consent', 'create' and 'none'.  Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",de_invalidClaimsRequest_code="invalid_claims",de_invalidClaimsRequest_desc="Given claims parameter must be a stringified JSON object.",de_tokenRequestEmptyError_code="token_request_empty",de_tokenRequestEmptyError_desc="Token request was empty and not found in cache.",de_logoutRequestEmptyError_code="logout_request_empty",de_logoutRequestEmptyError_desc="The logout request was null or undefined.",de_invalidCodeChallengeMethod_code="invalid_code_challenge_method",de_invalidCodeChallengeMethod_desc='code_challenge_method passed is invalid. Valid values are "plain" and "S256".',de_invalidCodeChallengeParams_code="pkce_params_missing",de_invalidCodeChallengeParams_desc="Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",de_invalidCloudDiscoveryMetadata_code="invalid_cloud_discovery_metadata",de_invalidCloudDiscoveryMetadata_desc="Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",de_invalidAuthorityMetadata_code="invalid_authority_metadata",de_invalidAuthorityMetadata_desc="Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",de_untrustedAuthority_code="untrusted_authority",de_untrustedAuthority_desc="The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",de_invalidAzureCloudInstance_code="invalid_azure_cloud_instance",de_invalidAzureCloudInstance_desc="Invalid AzureCloudInstance provided. Please refer MSAL JS docs: aks.ms/msaljs/azure_cloud_instance for valid values",de_missingSshJwk_code="missing_ssh_jwk",de_missingSshJwk_desc="Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",de_missingSshKid_code="missing_ssh_kid",de_missingSshKid_desc="Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",de_missingNonceAuthenticationHeader_code="missing_nonce_authentication_header",de_missingNonceAuthenticationHeader_desc="Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",de_invalidAuthenticationHeader_code="invalid_authentication_header",de_invalidAuthenticationHeader_desc="Invalid authentication header provided",we=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.name="ClientConfigurationError",Object.setPrototypeOf(i,e.prototype),i}return U(e,n),e.createRedirectUriEmptyError=function(){return new e(de_redirectUriNotSet_code,de_redirectUriNotSet_desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(de_postLogoutUriNotSet_code,de_postLogoutUriNotSet_desc)},e.createClaimsRequestParsingError=function(t){return new e(de_claimsRequestParsingError_code,de_claimsRequestParsingError_desc+" Given value: "+t)},e.createInsecureAuthorityUriError=function(t){return new e(de_authorityUriInsecure_code,de_authorityUriInsecure_desc+" Given URI: "+t)},e.createUrlParseError=function(t){return new e(de_urlParseError_code,de_urlParseError_desc+" Given Error: "+t)},e.createUrlEmptyError=function(){return new e(de_urlEmptyError_code,de_urlEmptyError_desc)},e.createEmptyScopesArrayError=function(){return new e(de_emptyScopesError_code,""+de_emptyScopesError_desc)},e.createClientIdSingleScopeError=function(t){return new e(de_clientIdSingleScopeError_code,de_clientIdSingleScopeError_desc+" Given Scopes: "+t)},e.createInvalidPromptError=function(t){return new e(de_invalidPrompt_code,de_invalidPrompt_desc+" Given value: "+t)},e.createInvalidClaimsRequestError=function(){return new e(de_invalidClaimsRequest_code,de_invalidClaimsRequest_desc)},e.createEmptyLogoutRequestError=function(){return new e(de_logoutRequestEmptyError_code,de_logoutRequestEmptyError_desc)},e.createEmptyTokenRequestError=function(){return new e(de_tokenRequestEmptyError_code,de_tokenRequestEmptyError_desc)},e.createInvalidCodeChallengeMethodError=function(){return new e(de_invalidCodeChallengeMethod_code,de_invalidCodeChallengeMethod_desc)},e.createInvalidCodeChallengeParamsError=function(){return new e(de_invalidCodeChallengeParams_code,de_invalidCodeChallengeParams_desc)},e.createInvalidCloudDiscoveryMetadataError=function(){return new e(de_invalidCloudDiscoveryMetadata_code,de_invalidCloudDiscoveryMetadata_desc)},e.createInvalidAuthorityMetadataError=function(){return new e(de_invalidAuthorityMetadata_code,de_invalidAuthorityMetadata_desc)},e.createUntrustedAuthorityError=function(){return new e(de_untrustedAuthority_code,de_untrustedAuthority_desc)},e.createInvalidAzureCloudInstanceError=function(){return new e(de_invalidAzureCloudInstance_code,de_invalidAzureCloudInstance_desc)},e.createMissingSshJwkError=function(){return new e(de_missingSshJwk_code,de_missingSshJwk_desc)},e.createMissingSshKidError=function(){return new e(de_missingSshKid_code,de_missingSshKid_desc)},e.createMissingNonceAuthenticationHeadersError=function(){return new e(de_missingNonceAuthenticationHeader_code,de_missingNonceAuthenticationHeader_desc)},e.createInvalidAuthenticationHeaderError=function(t,r){return new e(de_invalidAuthenticationHeader_code,de_invalidAuthenticationHeader_desc+". Invalid header: "+t+". Details: "+r)},e}(ee),Ge=function(){function n(e){var t=this,r=e?J.trimArrayEntries(z(e)):[],i=r?J.removeEmptyStringsFromArray(r):[];this.validateInputScopes(i),this.scopes=new Set,i.forEach(function(s){return t.scopes.add(s)})}return n.fromString=function(e){return new n((e||y.EMPTY_STRING).split(" "))},n.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw we.createEmptyScopesArrayError()},n.prototype.containsScope=function(e){var r=new n(this.printScopesLowerCase().split(" "));return!J.isEmpty(e)&&r.scopes.has(e.toLowerCase())},n.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(r){return t.containsScope(r)})},n.prototype.containsOnlyOIDCScopes=function(){var e=this,t=0;return Ae.forEach(function(r){e.containsScope(r)&&(t+=1)}),this.scopes.size===t},n.prototype.appendScope=function(e){J.isEmpty(e)||this.scopes.add(e.trim())},n.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(r){return t.appendScope(r)})}catch(r){throw ee.createAppendScopeSetError(r)}},n.prototype.removeScope=function(e){if(J.isEmpty(e))throw ee.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},n.prototype.removeOIDCScopes=function(){var e=this;Ae.forEach(function(t){e.scopes.delete(t)})},n.prototype.unionScopeSets=function(e){if(!e)throw ee.createEmptyInputScopeSetError();var t=new Set;return e.scopes.forEach(function(r){return t.add(r.toLowerCase())}),this.scopes.forEach(function(r){return t.add(r.toLowerCase())}),t},n.prototype.intersectingScopeSets=function(e){if(!e)throw ee.createEmptyInputScopeSetError();e.containsOnlyOIDCScopes()||e.removeOIDCScopes();var t=this.unionScopeSets(e),r=e.getScopeCount(),i=this.getScopeCount();return t.size<i+r},n.prototype.getScopeCount=function(){return this.scopes.size},n.prototype.asArray=function(){var e=[];return this.scopes.forEach(function(t){return e.push(t)}),e},n.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):y.EMPTY_STRING},n.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},n}(),st=function(){function n(e,t){if(J.isEmpty(e))throw ee.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=n.extractTokenClaims(e,t)}return n.extractTokenClaims=function(e,t){var r=J.decodeAuthToken(e);try{var s=t.base64Decode(r.JWSPayload);return JSON.parse(s)}catch(c){throw ee.createTokenParsingError(c)}},n}(),Xe=function(){function n(e,t){this.clientId=e,this.cryptoImpl=t}return n.prototype.getAllAccounts=function(){var e=this,t=this.getAccountsFilteredBy(),r=Object.keys(t).map(function(c){return t[c]});return r.length<1?[]:r.map(function(c){var h=n.toObject(new De,c).getAccountInfo(),p=e.readIdTokenFromCache(e.clientId,h);return p&&!h.idTokenClaims&&(h.idTokenClaims=new st(p.secret,e.cryptoImpl).claims),h})},n.prototype.saveCacheRecord=function(e){return I(this,void 0,void 0,function(){return D(this,function(t){switch(t.label){case 0:if(!e)throw ee.createNullOrUndefinedCacheRecord();return e.account&&this.setAccount(e.account),e.idToken&&this.setIdTokenCredential(e.idToken),e.accessToken?[4,this.saveAccessToken(e.accessToken)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e.refreshToken&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata),[2]}})})},n.prototype.saveAccessToken=function(e){return I(this,void 0,void 0,function(){var t,r,i,s,c=this;return D(this,function(l){switch(l.label){case 0:return t=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash}),r=Ge.fromString(e.target),(i=Object.keys(t.accessTokens).map(function(h){return t.accessTokens[h]}))?(s=[],i.forEach(function(h){Ge.fromString(h.target).intersectingScopeSets(r)&&s.push(c.removeCredential(h))}),[4,Promise.all(s)]):[3,2];case 1:l.sent(),l.label=2;case 2:return this.setAccessTokenCredential(e),[2]}})})},n.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:y.EMPTY_STRING,e?e.environment:y.EMPTY_STRING,e?e.realm:y.EMPTY_STRING)},n.prototype.getAccountsFilteredByInternal=function(e,t,r){var i=this,s=this.getKeys(),c={};return s.forEach(function(l){var h=i.getAccount(l);!h||e&&!i.matchHomeAccountId(h,e)||t&&!i.matchEnvironment(h,t)||r&&!i.matchRealm(h,r)||(c[l]=h)}),c},n.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion,e.tokenType,e.keyId,e.requestedClaimsHash)},n.prototype.getCredentialsFilteredByInternal=function(e,t,r,i,s,c,l,h,p,v,T){var R=this,V=this.getKeys(),$={idTokens:{},accessTokens:{},refreshTokens:{}};return V.forEach(function(le){var oe=Nt.getCredentialType(le);if(oe!==y.NOT_DEFINED){var ie=R.getSpecificCredential(le,oe);if(ie&&(!h||R.matchOboAssertion(ie,h))&&(!e||R.matchHomeAccountId(ie,e))&&(!t||R.matchEnvironment(ie,t))&&(!c||R.matchRealm(ie,c))&&(!r||R.matchCredentialType(ie,r))&&(!i||R.matchClientId(ie,i))&&(!s||R.matchFamilyId(ie,s))&&(!l||R.matchTarget(ie,l))&&(!T&&!ie.requestedClaimsHash||ie.requestedClaimsHash===T)&&(r!==pe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!(p&&!R.matchTokenType(ie,p)||p===P.SSH&&v&&!R.matchKeyId(ie,v)))){var be=R.updateCredentialCacheKey(le,ie);switch(oe){case pe.ID_TOKEN:$.idTokens[be]=ie;break;case pe.ACCESS_TOKEN:case pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:$.accessTokens[be]=ie;break;case pe.REFRESH_TOKEN:$.refreshTokens[be]=ie}}}}),$},n.prototype.getAppMetadataFilteredBy=function(e){return this.getAppMetadataFilteredByInternal(e.environment,e.clientId)},n.prototype.getAppMetadataFilteredByInternal=function(e,t){var r=this,i=this.getKeys(),s={};return i.forEach(function(c){if(r.isAppMetadata(c)){var l=r.getAppMetadata(c);!l||e&&!r.matchEnvironment(l,e)||t&&!r.matchClientId(l,t)||(s[c]=l)}}),s},n.prototype.getAuthorityMetadataByAlias=function(e){var t=this,r=this.getAuthorityMetadataKeys(),i=null;return r.forEach(function(s){if(t.isAuthorityMetadata(s)&&-1!==s.indexOf(t.clientId)){var c=t.getAuthorityMetadata(s);!c||-1!==c.aliases.indexOf(e)&&(i=c)}}),i},n.prototype.removeAllAccounts=function(){return I(this,void 0,void 0,function(){var e,t,r=this;return D(this,function(i){switch(i.label){case 0:return e=this.getKeys(),t=[],e.forEach(function(s){!r.getAccount(s)||t.push(r.removeAccount(s))}),[4,Promise.all(t)];case 1:return i.sent(),[2,!0]}})})},n.prototype.removeAccount=function(e){return I(this,void 0,void 0,function(){var t;return D(this,function(r){switch(r.label){case 0:if(!(t=this.getAccount(e)))throw ee.createNoAccountFoundError();return[4,this.removeAccountContext(t)];case 1:return[2,r.sent()&&this.removeItem(e,ot.ACCOUNT)]}})})},n.prototype.removeAccountContext=function(e){return I(this,void 0,void 0,function(){var t,r,i,s=this;return D(this,function(c){switch(c.label){case 0:return t=this.getKeys(),r=e.generateAccountId(),i=[],t.forEach(function(l){var h=Nt.getCredentialType(l);if(h!==y.NOT_DEFINED){var p=s.getSpecificCredential(l,h);p&&r===p.generateAccountId()&&i.push(s.removeCredential(p))}}),[4,Promise.all(i)];case 1:return c.sent(),[2,!0]}})})},n.prototype.removeCredential=function(e){return I(this,void 0,void 0,function(){var t,i;return D(this,function(s){switch(s.label){case 0:if(t=e.generateCredentialKey(),e.credentialType.toLowerCase()!==pe.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())return[3,4];if(e.tokenType!==P.POP)return[3,4];if(!(i=e.keyId))return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.cryptoImpl.removeTokenBindingKey(i)];case 2:return s.sent(),[3,4];case 3:throw s.sent(),ee.createBindingKeyNotRemovedError();case 4:return[2,this.removeItem(t,ot.CREDENTIAL)]}})})},n.prototype.removeAppMetadata=function(){var e=this;return this.getKeys().forEach(function(r){e.isAppMetadata(r)&&e.removeItem(r,ot.APP_METADATA)}),!0},n.prototype.readCacheRecord=function(e,t,r,i){var s=this.readAccountFromCache(e),c=this.readIdTokenFromCache(t,e),l=this.readAccessTokenFromCache(t,e,r),h=this.readRefreshTokenFromCache(t,e,!1),p=this.readAppMetadataFromCache(i,t);return s&&c&&(s.idTokenClaims=new st(c.secret,this.cryptoImpl).claims),{account:s,idToken:c,accessToken:l,refreshToken:h,appMetadata:p}},n.prototype.readAccountFromCache=function(e){var t=De.generateAccountCacheKey(e);return this.getAccount(t)},n.prototype.readIdTokenFromCache=function(e,t){var i=this.getCredentialsFilteredBy({homeAccountId:t.homeAccountId,environment:t.environment,credentialType:pe.ID_TOKEN,clientId:e,realm:t.tenantId}),s=Object.keys(i.idTokens).map(function(l){return i.idTokens[l]}),c=s.length;if(c<1)return null;if(c>1)throw ee.createMultipleMatchingTokensInCacheError();return s[0]},n.prototype.readAccessTokenFromCache=function(e,t,r){var i=new Ge(r.scopes||[]),s=r.authenticationScheme||P.BEARER,c=s&&s.toLowerCase()!==P.BEARER.toLowerCase()?pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:pe.ACCESS_TOKEN,l={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:c,clientId:e,realm:t.tenantId,target:i.printScopesLowerCase(),tokenType:s,keyId:r.sshKid,requestedClaimsHash:r.requestedClaimsHash},h=this.getCredentialsFilteredBy(l),p=Object.keys(h.accessTokens).map(function(T){return h.accessTokens[T]}),v=p.length;if(v<1)return null;if(v>1)throw ee.createMultipleMatchingTokensInCacheError();return p[0]},n.prototype.readRefreshTokenFromCache=function(e,t,r){var c=this.getCredentialsFilteredBy({homeAccountId:t.homeAccountId,environment:t.environment,credentialType:pe.REFRESH_TOKEN,clientId:e,familyId:r?"1":void 0}),l=Object.keys(c.refreshTokens).map(function(p){return c.refreshTokens[p]});return l.length<1?null:l[0]},n.prototype.readAppMetadataFromCache=function(e,t){var i=this.getAppMetadataFilteredBy({environment:e,clientId:t}),s=Object.keys(i).map(function(l){return i[l]}),c=s.length;if(c<1)return null;if(c>1)throw ee.createMultipleMatchingAppMetadataInCacheError();return s[0]},n.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return!(!r||"1"!==r.familyId)},n.prototype.matchHomeAccountId=function(e,t){return!(!e.homeAccountId||t!==e.homeAccountId)},n.prototype.matchOboAssertion=function(e,t){return!(!e.oboAssertion||t!==e.oboAssertion)},n.prototype.matchEnvironment=function(e,t){var r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)},n.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},n.prototype.matchClientId=function(e,t){return!(!e.clientId||t!==e.clientId)},n.prototype.matchFamilyId=function(e,t){return!(!e.familyId||t!==e.familyId)},n.prototype.matchRealm=function(e,t){return!(!e.realm||t!==e.realm)},n.prototype.matchTarget=function(e,t){if(e.credentialType!==pe.ACCESS_TOKEN&&e.credentialType!==pe.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target)return!1;var i=Ge.fromString(e.target),s=Ge.fromString(t);return s.containsOnlyOIDCScopes()?s.removeScope(y.OFFLINE_ACCESS_SCOPE):s.removeOIDCScopes(),i.containsScopeSet(s)},n.prototype.matchTokenType=function(e,t){return!(!e.tokenType||e.tokenType!==t)},n.prototype.matchKeyId=function(e,t){return!(!e.keyId||e.keyId!==t)},n.prototype.isAppMetadata=function(e){return-1!==e.indexOf(At)},n.prototype.isAuthorityMetadata=function(e){return-1!==e.indexOf("authority-metadata")},n.prototype.generateAuthorityMetadataCacheKey=function(e){return"authority-metadata-"+this.clientId+"-"+e},n.prototype.getSpecificCredential=function(e,t){switch(t){case pe.ID_TOKEN:return this.getIdTokenCredential(e);case pe.ACCESS_TOKEN:case pe.ACCESS_TOKEN_WITH_AUTH_SCHEME:return this.getAccessTokenCredential(e);case pe.REFRESH_TOKEN:return this.getRefreshTokenCredential(e);default:return null}},n.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},n}(),Fr=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return U(e,n),e.prototype.setAccount=function(){throw ae.createUnexpectedError("Storage interface - setAccount() has not been implemented for the cacheStorage interface.")},e.prototype.getAccount=function(){throw ae.createUnexpectedError("Storage interface - getAccount() has not been implemented for the cacheStorage interface.")},e.prototype.setIdTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - setIdTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.getIdTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - getIdTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.setAccessTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - setAccessTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.getAccessTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - getAccessTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.setRefreshTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - setRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.getRefreshTokenCredential=function(){throw ae.createUnexpectedError("Storage interface - getRefreshTokenCredential() has not been implemented for the cacheStorage interface.")},e.prototype.setAppMetadata=function(){throw ae.createUnexpectedError("Storage interface - setAppMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.getAppMetadata=function(){throw ae.createUnexpectedError("Storage interface - getAppMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.setServerTelemetry=function(){throw ae.createUnexpectedError("Storage interface - setServerTelemetry() has not been implemented for the cacheStorage interface.")},e.prototype.getServerTelemetry=function(){throw ae.createUnexpectedError("Storage interface - getServerTelemetry() has not been implemented for the cacheStorage interface.")},e.prototype.setAuthorityMetadata=function(){throw ae.createUnexpectedError("Storage interface - setAuthorityMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.getAuthorityMetadata=function(){throw ae.createUnexpectedError("Storage interface - getAuthorityMetadata() has not been implemented for the cacheStorage interface.")},e.prototype.getAuthorityMetadataKeys=function(){throw ae.createUnexpectedError("Storage interface - getAuthorityMetadataKeys() has not been implemented for the cacheStorage interface.")},e.prototype.setThrottlingCache=function(){throw ae.createUnexpectedError("Storage interface - setThrottlingCache() has not been implemented for the cacheStorage interface.")},e.prototype.getThrottlingCache=function(){throw ae.createUnexpectedError("Storage interface - getThrottlingCache() has not been implemented for the cacheStorage interface.")},e.prototype.removeItem=function(){throw ae.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},e.prototype.containsKey=function(){throw ae.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},e.prototype.getKeys=function(){throw ae.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},e.prototype.clear=function(){return I(this,void 0,void 0,function(){return D(this,function(r){throw ae.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")})})},e.prototype.updateCredentialCacheKey=function(){throw ae.createUnexpectedError("Storage interface - updateCredentialCacheKey() has not been implemented for the cacheStorage interface.")},e}(Xe),Ft=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return U(e,n),e.createIdTokenEntity=function(t,r,i,s,c,l){var h=new e;return h.credentialType=pe.ID_TOKEN,h.homeAccountId=t,h.environment=r,h.clientId=s,h.secret=i,h.realm=c,h.oboAssertion=l,h},e.isIdTokenEntity=function(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===pe.ID_TOKEN},e}(Nt),Ye=function(){function n(){}return n.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},n.isTokenExpired=function(e,t){var r=Number(e)||0;return n.nowSeconds()+t>r},n.wasClockTurnedBack=function(e){return Number(e)>n.nowSeconds()},n.delay=function(e,t){return new Promise(function(r){return setTimeout(function(){return r(t)},e)})},n}(),Kt=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return U(e,n),e.createAccessTokenEntity=function(t,r,i,s,c,l,h,p,v,T,R,V,$,le,oe){var ie,be,Ee=new e;Ee.homeAccountId=t,Ee.credentialType=pe.ACCESS_TOKEN,Ee.secret=i;var Ke=Ye.nowSeconds();if(Ee.cachedAt=Ke.toString(),Ee.expiresOn=h.toString(),Ee.extendedExpiresOn=p.toString(),T&&(Ee.refreshOn=T.toString()),Ee.environment=r,Ee.clientId=s,Ee.realm=c,Ee.target=l,Ee.oboAssertion=V,Ee.tokenType=J.isEmpty(R)?P.BEARER:R,le&&(Ee.requestedClaims=le,Ee.requestedClaimsHash=oe),(null===(ie=Ee.tokenType)||void 0===ie?void 0:ie.toLowerCase())!==P.BEARER.toLowerCase())switch(Ee.credentialType=pe.ACCESS_TOKEN_WITH_AUTH_SCHEME,Ee.tokenType){case P.POP:var Qe=st.extractTokenClaims(i,v);if(!(null===(be=null==Qe?void 0:Qe.cnf)||void 0===be?void 0:be.kid))throw ee.createTokenClaimsRequiredError();Ee.keyId=Qe.cnf.kid;break;case P.SSH:Ee.keyId=$}return Ee},e.isAccessTokenEntity=function(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("realm")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.hasOwnProperty("target")&&(t.credentialType===pe.ACCESS_TOKEN||t.credentialType===pe.ACCESS_TOKEN_WITH_AUTH_SCHEME)},e}(Nt),Xt=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return U(e,n),e.createRefreshTokenEntity=function(t,r,i,s,c,l){var h=new e;return h.clientId=s,h.credentialType=pe.REFRESH_TOKEN,h.environment=r,h.homeAccountId=t,h.secret=i,h.oboAssertion=l,c&&(h.familyId=c),h},e.isRefreshTokenEntity=function(t){return!!t&&t.hasOwnProperty("homeAccountId")&&t.hasOwnProperty("environment")&&t.hasOwnProperty("credentialType")&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("secret")&&t.credentialType===pe.REFRESH_TOKEN},e}(Nt),$t=function(){function n(){}return n.prototype.generateAppMetadataKey=function(){return n.generateAppMetadataCacheKey(this.environment,this.clientId)},n.generateAppMetadataCacheKey=function(e,t){return[At,e,t].join(xe.CACHE_KEY_SEPARATOR).toLowerCase()},n.createAppMetadataEntity=function(e,t,r){var i=new n;return i.clientId=e,i.environment=t,r&&(i.familyId=r),i},n.isAppMetadataEntity=function(e,t){return!!t&&0===e.indexOf(At)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},n}(),Bt=function(){function n(){this.failedRequests=[],this.errors=[],this.cacheHits=0}return n.isServerTelemetryEntity=function(e,t){var r=0===e.indexOf(Oe.CACHE_KEY),i=!0;return t&&(i=t.hasOwnProperty("failedRequests")&&t.hasOwnProperty("errors")&&t.hasOwnProperty("cacheHits")),r&&i},n}(),Zt=function(){function n(){this.expiresAt=Ye.nowSeconds()+86400}return n.prototype.updateCloudDiscoveryMetadata=function(e,t){this.aliases=e.aliases,this.preferred_cache=e.preferred_cache,this.preferred_network=e.preferred_network,this.aliasesFromNetwork=t},n.prototype.updateEndpointMetadata=function(e,t){this.authorization_endpoint=e.authorization_endpoint,this.token_endpoint=e.token_endpoint,this.end_session_endpoint=e.end_session_endpoint,this.issuer=e.issuer,this.endpointsFromNetwork=t},n.prototype.updateCanonicalAuthority=function(e){this.canonical_authority=e},n.prototype.resetExpiresAt=function(){this.expiresAt=Ye.nowSeconds()+86400},n.prototype.isExpired=function(){return this.expiresAt<=Ye.nowSeconds()},n.isAuthorityMetadataEntity=function(e,t){return!!t&&0===e.indexOf("authority-metadata")&&t.hasOwnProperty("aliases")&&t.hasOwnProperty("preferred_cache")&&t.hasOwnProperty("preferred_network")&&t.hasOwnProperty("canonical_authority")&&t.hasOwnProperty("authorization_endpoint")&&t.hasOwnProperty("token_endpoint")&&t.hasOwnProperty("issuer")&&t.hasOwnProperty("aliasesFromNetwork")&&t.hasOwnProperty("endpointsFromNetwork")&&t.hasOwnProperty("expiresAt")},n}(),gr=function(){function n(){}return n.isThrottlingEntity=function(e,t){var r=!1;e&&(r=0===e.indexOf("throttling"));var i=!0;return t&&(i=t.hasOwnProperty("throttleTime")),r&&i},n}(),at=function(){function n(){}return n.setRequestState=function(e,t,r){var i=n.generateLibraryState(e,r);return J.isEmpty(t)?i:""+i+y.RESOURCE_DELIM+t},n.generateLibraryState=function(e,t){if(!e)throw ee.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid()};t&&(r.meta=t);var i=JSON.stringify(r);return e.base64Encode(i)},n.parseRequestState=function(e,t){if(!e)throw ee.createNoCryptoObjectError("parseRequestState");if(J.isEmpty(t))throw ee.createInvalidStateError(t,"Null, undefined or empty state");try{var r=t.split(y.RESOURCE_DELIM),i=r[0],s=r.length>1?r.slice(1).join(y.RESOURCE_DELIM):y.EMPTY_STRING,c=e.base64Decode(i),l=JSON.parse(c);return{userRequestState:J.isEmpty(s)?y.EMPTY_STRING:s,libraryState:l}}catch(h){throw ee.createInvalidStateError(t,h)}},n}(),Fe=(()=>{return(n=Fe||(Fe={})).HOME_ACCOUNT_ID="home_account_id",n.UPN="UPN",Fe;var n})(),Ve_redirectUriNotSet_code="redirect_uri_empty",Ve_redirectUriNotSet_desc="A redirect URI is required for all calls, and none has been set.",Ve_postLogoutUriNotSet_code="post_logout_uri_empty",Ve_postLogoutUriNotSet_desc="A post logout redirect has not been set.",Ve_storageNotSupportedError_code="storage_not_supported",Ve_storageNotSupportedError_desc="Given storage configuration option was not supported.",Ve_noRedirectCallbacksSet_code="no_redirect_callbacks",Ve_noRedirectCallbacksSet_desc="No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.",Ve_stubPcaInstanceCalled_code="stubbed_public_client_application_called",Ve_stubPcaInstanceCalled_desc="Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",Ve_inMemRedirectUnavailable_code="in_mem_redirect_unavailable",Ve_inMemRedirectUnavailable_desc="Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true.",er=function(n){function e(t,r){var i=n.call(this,t,r)||this;return i.name="BrowserConfigurationAuthError",Object.setPrototypeOf(i,e.prototype),i}return te(e,n),e.createRedirectUriEmptyError=function(){return new e(Ve_redirectUriNotSet_code,Ve_redirectUriNotSet_desc)},e.createPostLogoutRedirectUriEmptyError=function(){return new e(Ve_postLogoutUriNotSet_code,Ve_postLogoutUriNotSet_desc)},e.createStorageNotSupportedError=function(t){return new e(Ve_storageNotSupportedError_code,Ve_storageNotSupportedError_desc+" Given Location: "+t)},e.createRedirectCallbacksNotSetError=function(){return new e(Ve_noRedirectCallbacksSet_code,Ve_noRedirectCallbacksSet_desc)},e.createStubPcaInstanceCalledError=function(){return new e(Ve_stubPcaInstanceCalled_code,Ve_stubPcaInstanceCalled_desc)},e.createInMemoryRedirectUnavailableError=function(){return new e(Ve_inMemRedirectUnavailable_code,Ve_inMemRedirectUnavailable_desc)},e}(ae),mr=function(){function n(e){this.validateWindowStorage(e),this.windowStorage=window[e]}return n.prototype.validateWindowStorage=function(e){if(e!==Ue.LocalStorage&&e!==Ue.SessionStorage)throw er.createStorageNotSupportedError(e);if(!window[e])throw er.createStorageNotSupportedError(e)},n.prototype.getItem=function(e){return this.windowStorage.getItem(e)},n.prototype.setItem=function(e,t){this.windowStorage.setItem(e,t)},n.prototype.removeItem=function(e){this.windowStorage.removeItem(e)},n.prototype.getKeys=function(){return Object.keys(this.windowStorage)},n.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},n}(),ye=function(){function n(e){if(this._urlString=e,J.isEmpty(this._urlString))throw we.createUrlEmptyError();J.isEmpty(this.getHash())&&(this._urlString=n.canonicalizeUri(e))}return Object.defineProperty(n.prototype,"urlString",{get:function(){return this._urlString},enumerable:!1,configurable:!0}),n.canonicalizeUri=function(e){if(e){var t=e.toLowerCase();return J.endsWith(t,"?")?t=t.slice(0,-1):J.endsWith(t,"?/")&&(t=t.slice(0,-2)),J.endsWith(t,"/")||(t+="/"),t}return e},n.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(t){throw we.createUrlParseError(t)}if(!e.HostNameAndPort||!e.PathSegments)throw we.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw we.createInsecureAuthorityUriError(this.urlString)},n.appendQueryString=function(e,t){return J.isEmpty(t)?e:e.indexOf("?")<0?e+"?"+t:e+"&"+t},n.removeHashFromUrl=function(e){return n.canonicalizeUri(e.split("#")[0])},n.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return e&&0!==r.length&&(r[0]===He.COMMON||r[0]===He.ORGANIZATIONS)&&(r[0]=e),n.constructAuthorityUriFromObject(t)},n.prototype.getHash=function(){return n.parseHash(this.urlString)},n.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw we.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},i=r.AbsolutePath.split("/");return i=i.filter(function(s){return s&&s.length>0}),r.PathSegments=i,!J.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},n.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw we.createUrlParseError("Given url string: "+e);return r[2]},n.getAbsoluteUrl=function(e,t){if(e[0]===y.FORWARD_SLASH){var i=new n(t).getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e},n.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return r>-1?e.substring(r+2):t>-1?e.substring(t+1):y.EMPTY_STRING},n.constructAuthorityUriFromObject=function(e){return new n(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},n.getDeserializedHash=function(e){if(J.isEmpty(e))return{};var t=n.parseHash(e),r=J.queryStringToObject(J.isEmpty(t)?e:t);if(!r)throw ee.createHashNotDeserializedError(JSON.stringify(r));return r},n.hashContainsKnownProperties=function(e){if(J.isEmpty(e)||e.indexOf("=")<0)return!1;var t=n.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},n}(),vr=function(){function n(){}return n.extractBrowserRequestState=function(e,t){if(J.isEmpty(t))return null;try{return at.parseRequestState(e,t).libraryState.meta}catch(i){throw ee.createInvalidStateError(t,i)}},n.parseServerResponseFromHash=function(e){if(!e)return{};var t=new ye(e);return ye.getDeserializedHash(t.getHash())},n}(),Er=function(n){function e(t,r,i,s){var c=n.call(this,t,i)||this;return c.COOKIE_LIFE_MULTIPLIER=864e5,c.cacheConfig=r,c.logger=s,c.internalStorage=new Qt,c.browserStorage=c.setupBrowserStorage(c.cacheConfig.cacheLocation),c.temporaryCacheStorage=c.setupTemporaryCacheStorage(c.cacheConfig.cacheLocation),c.migrateCacheEntries(),c}return te(e,n),e.prototype.setupBrowserStorage=function(t){switch(t){case Ue.LocalStorage:case Ue.SessionStorage:try{return new mr(t)}catch(r){this.logger.verbose(r);break}}return this.cacheConfig.cacheLocation=Ue.MemoryStorage,new Qt},e.prototype.setupTemporaryCacheStorage=function(t){switch(t){case Ue.LocalStorage:case Ue.SessionStorage:try{return new mr(Ue.SessionStorage)}catch(r){return this.logger.verbose(r),this.internalStorage}default:return this.internalStorage}},e.prototype.migrateCacheEntries=function(){var t=this,i=y.CACHE_PREFIX+"."+ge.CLIENT_INFO,s=y.CACHE_PREFIX+"."+ge.ERROR,c=y.CACHE_PREFIX+"."+ge.ERROR_DESC,T=[this.browserStorage.getItem(y.CACHE_PREFIX+"."+ge.ID_TOKEN),this.browserStorage.getItem(i),this.browserStorage.getItem(s),this.browserStorage.getItem(c)];[ge.ID_TOKEN,ge.CLIENT_INFO,ge.ERROR,ge.ERROR_DESC].forEach(function(V,$){return t.migrateCacheEntry(V,T[$])})},e.prototype.migrateCacheEntry=function(t,r){r&&this.setTemporaryCache(t,r,!0)},e.prototype.validateAndParseJson=function(t){try{var r=JSON.parse(t);return r&&"object"==typeof r?r:null}catch(i){return null}},e.prototype.getItem=function(t){return this.browserStorage.getItem(t)},e.prototype.setItem=function(t,r){this.browserStorage.setItem(t,r)},e.prototype.getAccount=function(t){var r=this.getItem(t);if(!r)return null;var i=this.validateAndParseJson(r);return i&&De.isAccountEntity(i)?Xe.toObject(new De,i):null},e.prototype.setAccount=function(t){this.logger.trace("BrowserCacheManager.setAccount called");var r=t.generateAccountKey();this.setItem(r,JSON.stringify(t))},e.prototype.getIdTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null;var i=this.validateAndParseJson(r);return i&&Ft.isIdTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),Xe.toObject(new Ft,i)):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null)},e.prototype.setIdTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t))},e.prototype.getAccessTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null;var i=this.validateAndParseJson(r);return i&&Kt.isAccessTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),Xe.toObject(new Kt,i)):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null)},e.prototype.setAccessTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t))},e.prototype.getRefreshTokenCredential=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null;var i=this.validateAndParseJson(r);return i&&Xt.isRefreshTokenEntity(i)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),Xe.toObject(new Xt,i)):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null)},e.prototype.setRefreshTokenCredential=function(t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");var r=t.generateCredentialKey();this.setItem(r,JSON.stringify(t))},e.prototype.getAppMetadata=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(r);return i&&$t.isAppMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),Xe.toObject(new $t,i)):(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null)},e.prototype.setAppMetadata=function(t){this.logger.trace("BrowserCacheManager.setAppMetadata called");var r=t.generateAppMetadataKey();this.setItem(r,JSON.stringify(t))},e.prototype.getServerTelemetry=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;var i=this.validateAndParseJson(r);return i&&Bt.isServerTelemetryEntity(t,i)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),Xe.toObject(new Bt,i)):(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null)},e.prototype.setServerTelemetry=function(t,r){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(t,JSON.stringify(r))},e.prototype.getAuthorityMetadata=function(t){var r=this.internalStorage.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;var i=this.validateAndParseJson(r);return i&&Zt.isAuthorityMetadataEntity(t,i)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),Xe.toObject(new Zt,i)):null},e.prototype.getAuthorityMetadataKeys=function(){var t=this;return this.internalStorage.getKeys().filter(function(i){return t.isAuthorityMetadata(i)})},e.prototype.setWrapperMetadata=function(t,r){this.internalStorage.setItem(dt.WRAPPER_SKU,t),this.internalStorage.setItem(dt.WRAPPER_VER,r)},e.prototype.getWrapperMetadata=function(){return[this.internalStorage.getItem(dt.WRAPPER_SKU)||y.EMPTY_STRING,this.internalStorage.getItem(dt.WRAPPER_VER)||y.EMPTY_STRING]},e.prototype.setAuthorityMetadata=function(t,r){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(t,JSON.stringify(r))},e.prototype.getActiveAccount=function(){var t=this.generateCacheKey(ge.ACTIVE_ACCOUNT),r=this.browserStorage.getItem(t);return r&&this.getAccountInfoByFilter({localAccountId:r})[0]||null},e.prototype.setActiveAccount=function(t){var r=this.generateCacheKey(ge.ACTIVE_ACCOUNT);t?(this.logger.verbose("setActiveAccount: Active account set"),this.browserStorage.setItem(r,t.localAccountId)):(this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(r))},e.prototype.getAccountInfoByFilter=function(t){return this.getAllAccounts().filter(function(i){return!(t.username&&t.username.toLowerCase()!==i.username.toLowerCase()||t.homeAccountId&&t.homeAccountId!==i.homeAccountId||t.localAccountId&&t.localAccountId!==i.localAccountId||t.tenantId&&t.tenantId!==i.tenantId||t.environment&&t.environment!==i.environment)})},e.prototype.getAccountInfoByHints=function(t,r){var i=this.getAllAccounts().filter(function(s){return r?r===(s.idTokenClaims&&s.idTokenClaims.sid):!!t&&t===s.username});if(1===i.length)return i[0];if(i.length>1)throw ee.createMultipleMatchingAccountsInCacheError();return null},e.prototype.getThrottlingCache=function(t){var r=this.getItem(t);if(!r)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;var i=this.validateAndParseJson(r);return i&&gr.isThrottlingEntity(t,i)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),Xe.toObject(new gr,i)):(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null)},e.prototype.setThrottlingCache=function(t,r){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(t,JSON.stringify(r))},e.prototype.getTemporaryCache=function(t,r){var i=r?this.generateCacheKey(t):t;if(this.cacheConfig.storeAuthStateInCookie){var s=this.getItemCookie(i);if(s)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),s}var c=this.temporaryCacheStorage.getItem(i);if(!c){if(this.cacheConfig.cacheLocation===Ue.LocalStorage){var l=this.browserStorage.getItem(i);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),l}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),c},e.prototype.setTemporaryCache=function(t,r,i){var s=i?this.generateCacheKey(t):t;this.temporaryCacheStorage.setItem(s,r),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(s,r))},e.prototype.removeItem=function(t){return this.browserStorage.removeItem(t),this.temporaryCacheStorage.removeItem(t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(t)),!0},e.prototype.containsKey=function(t){return this.browserStorage.containsKey(t)||this.temporaryCacheStorage.containsKey(t)},e.prototype.getKeys=function(){return Pe(this.browserStorage.getKeys(),this.temporaryCacheStorage.getKeys())},e.prototype.clear=function(){return L(this,void 0,void 0,function(){var t=this;return x(this,function(r){switch(r.label){case 0:return[4,this.removeAllAccounts()];case 1:return r.sent(),this.removeAppMetadata(),this.getKeys().forEach(function(i){(t.browserStorage.containsKey(i)||t.temporaryCacheStorage.containsKey(i))&&(-1!==i.indexOf(y.CACHE_PREFIX)||-1!==i.indexOf(t.clientId))&&t.removeItem(i)}),this.internalStorage.clear(),[2]}})})},e.prototype.setItemCookie=function(t,r,i){var s=encodeURIComponent(t)+"="+encodeURIComponent(r)+";path=/;";i&&(s+="expires="+this.getCookieExpirationTime(i)+";"),this.cacheConfig.secureCookies&&(s+="Secure;"),document.cookie=s},e.prototype.getItemCookie=function(t){for(var r=encodeURIComponent(t)+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var c=i[s];" "===c.charAt(0);)c=c.substring(1);if(0===c.indexOf(r))return decodeURIComponent(c.substring(r.length,c.length))}return y.EMPTY_STRING},e.prototype.clearMsalCookies=function(){var t=this,r=y.CACHE_PREFIX+"."+this.clientId;document.cookie.split(";").forEach(function(s){for(;" "===s.charAt(0);)s=s.substring(1);if(0===s.indexOf(r)){var c=s.split("=")[0];t.clearItemCookie(c)}})},e.prototype.clearItemCookie=function(t){this.setItemCookie(t,y.EMPTY_STRING,-1)},e.prototype.getCookieExpirationTime=function(t){var r=new Date;return new Date(r.getTime()+t*this.COOKIE_LIFE_MULTIPLIER).toUTCString()},e.prototype.getCache=function(){return this.browserStorage},e.prototype.setCache=function(){},e.prototype.generateCacheKey=function(t){return this.validateAndParseJson(t)?JSON.stringify(t):J.startsWith(t,y.CACHE_PREFIX)||J.startsWith(t,ge.ADAL_ID_TOKEN)?t:y.CACHE_PREFIX+"."+this.clientId+"."+t},e.prototype.generateAuthorityKey=function(t){var r=at.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(_e.AUTHORITY+"."+r)},e.prototype.generateNonceKey=function(t){var r=at.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(_e.NONCE_IDTOKEN+"."+r)},e.prototype.generateStateKey=function(t){var r=at.parseRequestState(this.cryptoImpl,t).libraryState.id;return this.generateCacheKey(_e.REQUEST_STATE+"."+r)},e.prototype.getCachedAuthority=function(t){var r=this.generateStateKey(t),i=this.getTemporaryCache(r);if(!i)return null;var s=this.generateAuthorityKey(i);return this.getTemporaryCache(s)},e.prototype.updateCacheEntries=function(t,r,i,s,c){this.logger.trace("BrowserCacheManager.updateCacheEntries called");var l=this.generateStateKey(t);this.setTemporaryCache(l,t,!1);var h=this.generateNonceKey(t);this.setTemporaryCache(h,r,!1);var p=this.generateAuthorityKey(t);if(this.setTemporaryCache(p,i,!1),c){var v={credential:c.homeAccountId,type:Fe.HOME_ACCOUNT_ID};this.setTemporaryCache(_e.CCS_CREDENTIAL,JSON.stringify(v),!0)}else J.isEmpty(s)||(v={credential:s,type:Fe.UPN},this.setTemporaryCache(_e.CCS_CREDENTIAL,JSON.stringify(v),!0))},e.prototype.resetRequestCache=function(t){var r=this;this.logger.trace("BrowserCacheManager.resetRequestCache called"),J.isEmpty(t)||this.getKeys().forEach(function(i){-1!==i.indexOf(t)&&r.removeItem(i)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(_e.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(_e.ORIGIN_URI)),this.removeItem(this.generateCacheKey(_e.URL_HASH)),this.removeItem(this.generateCacheKey(_e.CORRELATION_ID)),this.removeItem(this.generateCacheKey(_e.CCS_CREDENTIAL)),this.removeItem(this.generateCacheKey(_e.NATIVE_REQUEST)),this.setInteractionInProgress(!1)},e.prototype.cleanRequestByState=function(t){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),t){var r=this.generateStateKey(t),i=this.temporaryCacheStorage.getItem(r);this.logger.infoPii("BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: "+i),this.resetRequestCache(i||y.EMPTY_STRING)}this.clearMsalCookies()},e.prototype.cleanRequestByInteractionType=function(t){var r=this;this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.getKeys().forEach(function(i){if(-1!==i.indexOf(_e.REQUEST_STATE)){var s=r.temporaryCacheStorage.getItem(i);if(s){var c=vr.extractBrowserRequestState(r.cryptoImpl,s);c&&c.interactionType===t&&(r.logger.infoPii("BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: "+s),r.resetRequestCache(s))}}}),this.clearMsalCookies(),this.setInteractionInProgress(!1)},e.prototype.cacheCodeRequest=function(t,r){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");var i=r.base64Encode(JSON.stringify(t));this.setTemporaryCache(_e.REQUEST_PARAMS,i,!0)},e.prototype.getCachedRequest=function(t,r){this.logger.trace("BrowserCacheManager.getCachedRequest called");var i=this.getTemporaryCache(_e.REQUEST_PARAMS,!0);if(!i)throw Q.createNoTokenRequestCacheError();var s=this.validateAndParseJson(r.base64Decode(i));if(!s)throw Q.createUnableToParseTokenRequestCacheError();if(this.removeItem(this.generateCacheKey(_e.REQUEST_PARAMS)),J.isEmpty(s.authority)){var c=this.generateAuthorityKey(t),l=this.getTemporaryCache(c);if(!l)throw Q.createNoCachedAuthorityError();s.authority=l}return s},e.prototype.getCachedNativeRequest=function(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");var t=this.getTemporaryCache(_e.NATIVE_REQUEST,!0);return t?this.validateAndParseJson(t)||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null):(this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null)},e.prototype.isInteractionInProgress=function(t){var r=this.getInteractionInProgress();return t?r===this.clientId:!!r},e.prototype.getInteractionInProgress=function(){return this.getTemporaryCache(y.CACHE_PREFIX+"."+_e.INTERACTION_STATUS_KEY,!1)},e.prototype.setInteractionInProgress=function(t){var r=y.CACHE_PREFIX+"."+_e.INTERACTION_STATUS_KEY;if(t){if(this.getInteractionInProgress())throw Q.createInteractionInProgressError();this.setTemporaryCache(r,this.clientId,!1)}else!t&&this.getInteractionInProgress()===this.clientId&&this.removeItem(r)},e.prototype.getLegacyLoginHint=function(){var t=this.getTemporaryCache(ge.ADAL_ID_TOKEN);t&&(this.browserStorage.removeItem(ge.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));var r=this.getTemporaryCache(ge.ID_TOKEN,!0);r&&(this.removeItem(this.generateCacheKey(ge.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));var i=r||t;if(i){var s=new st(i,this.cryptoImpl);if(s.claims&&s.claims.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),s.claims.preferred_username;if(s.claims&&s.claims.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),s.claims.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null},e.prototype.updateCredentialCacheKey=function(t,r){var i=r.generateCredentialKey();if(t!==i){var s=this.getItem(t);if(s)return this.removeItem(t),this.setItem(i,s),this.logger.verbose("Updated an outdated "+r.credentialType+" cache key"),i;this.logger.error("Attempted to update an outdated "+r.credentialType+" cache key but no item matching the outdated key was found in storage")}return t},e}(Xe),kt=(()=>{return(n=kt||(kt={})).AAD="AAD",n.OIDC="OIDC",kt;var n})(),yt=(()=>{return(n=yt||(yt={}))[n.None=0]="None",n.AzurePublic="https://login.microsoftonline.com",n.AzurePpe="https://login.windows-ppe.net",n.AzureChina="https://login.chinacloudapi.cn",n.AzureGermany="https://login.microsoftonline.de",n.AzureUsGovernment="https://login.microsoftonline.us",yt;var n})(),yr={tokenRenewalOffsetSeconds:300,preventCorsPreflight:!1,proxyUrl:y.EMPTY_STRING},jr={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:Ne.Info,correlationId:y.EMPTY_STRING},Wr={sendGetRequestAsync:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return I(this,void 0,void 0,function(){return D(this,function(e){throw ae.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},qr={sku:y.SKU,version:"6.3.0",cpu:y.EMPTY_STRING,os:y.EMPTY_STRING},zr={clientSecret:y.EMPTY_STRING,clientAssertion:void 0},Yr={azureCloudInstance:yt.None,tenant:""+y.DEFAULT_COMMON_TENANT},Vr={application:{appName:"",appVersion:""}};function Jr(n){return k({clientCapabilities:[],azureCloudOptions:Yr},n)}var Xr={sendGetRequestAsync:function(){return Promise.reject(ae.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented for the Network interface."))},sendPostRequestAsync:function(){return Promise.reject(ae.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented for the Network interface."))}},$r=function(){function n(){}return n.prototype.sendGetRequestAsync=function(e,t){return L(this,void 0,void 0,function(){var r,i,s;return x(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,fetch(e,{method:Je.GET,headers:this.getFetchHeaders(t)})];case 1:return r=c.sent(),[3,3];case 2:throw i=c.sent(),window.navigator.onLine?Q.createGetRequestFailedError(i,e):Q.createNoNetworkConnectivityError();case 3:return c.trys.push([3,5,,6]),s={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 4:return[2,(s.body=c.sent(),s.status=r.status,s)];case 5:throw c.sent(),Q.createFailedToParseNetworkResponseError(e);case 6:return[2]}})})},n.prototype.sendPostRequestAsync=function(e,t){return L(this,void 0,void 0,function(){var r,i,s,c;return x(this,function(l){switch(l.label){case 0:r=t&&t.body||y.EMPTY_STRING,l.label=1;case 1:return l.trys.push([1,3,,4]),[4,fetch(e,{method:Je.POST,headers:this.getFetchHeaders(t),body:r})];case 2:return i=l.sent(),[3,4];case 3:throw s=l.sent(),window.navigator.onLine?Q.createPostRequestFailedError(s,e):Q.createNoNetworkConnectivityError();case 4:return l.trys.push([4,6,,7]),c={headers:this.getHeaderDict(i.headers)},[4,i.json()];case 5:return[2,(c.body=l.sent(),c.status=i.status,c)];case 6:throw l.sent(),Q.createFailedToParseNetworkResponseError(e);case 7:return[2]}})})},n.prototype.getFetchHeaders=function(e){var t=new Headers;if(!e||!e.headers)return t;var r=e.headers;return Object.keys(r).forEach(function(i){t.append(i,r[i])}),t},n.prototype.getHeaderDict=function(e){var t={};return e.forEach(function(r,i){t[i]=r}),t},n}(),Zr=function(){function n(){}return n.prototype.sendGetRequestAsync=function(e,t){return L(this,void 0,void 0,function(){return x(this,function(r){return[2,this.sendRequestAsync(e,Je.GET,t)]})})},n.prototype.sendPostRequestAsync=function(e,t){return L(this,void 0,void 0,function(){return x(this,function(r){return[2,this.sendRequestAsync(e,Je.POST,t)]})})},n.prototype.sendRequestAsync=function(e,t,r){var i=this;return new Promise(function(s,c){var l=new XMLHttpRequest;if(l.open(t,e,!0),i.setXhrHeaders(l,r),l.onload=function(){(l.status<200||l.status>=300)&&c(t===Je.POST?Q.createPostRequestFailedError("Failed with status "+l.status,e):Q.createGetRequestFailedError("Failed with status "+l.status,e));try{var h=JSON.parse(l.responseText),p={headers:i.getHeaderDict(l),body:h,status:l.status};s(p)}catch(v){c(Q.createFailedToParseNetworkResponseError(e))}},l.onerror=function(){window.navigator.onLine?c(t===Je.POST?Q.createPostRequestFailedError("Failed with status "+l.status,e):Q.createGetRequestFailedError("Failed with status "+l.status,e)):c(Q.createNoNetworkConnectivityError())},t===Je.POST&&r&&r.body)l.send(r.body);else{if(t!==Je.GET)throw Q.createHttpMethodNotImplementedError(t);l.send()}})},n.prototype.setXhrHeaders=function(e,t){if(t&&t.headers){var r=t.headers;Object.keys(r).forEach(function(i){e.setRequestHeader(i,r[i])})}},n.prototype.getHeaderDict=function(e){var r=e.getAllResponseHeaders().trim().split(/[\r\n]+/),i={};return r.forEach(function(s){var c=s.split(": "),l=c.shift(),h=c.join(": ");l&&h&&(i[l]=h)}),i},n}(),Ie=function(){function n(){}return n.clearHash=function(e){e.location.hash=y.EMPTY_STRING,"function"==typeof e.history.replaceState&&e.history.replaceState(null,y.EMPTY_STRING,""+e.location.origin+e.location.pathname+e.location.search)},n.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=t.length>0?t.join("#"):y.EMPTY_STRING},n.isInIframe=function(){return window.parent!==window},n.isInPopup=function(){return"undefined"!=typeof window&&!!window.opener&&window.opener!==window&&"string"==typeof window.name&&0===window.name.indexOf("msal.")},n.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},n.getHomepage=function(){var t=new ye(window.location.href).getUrlComponents();return t.Protocol+"//"+t.HostNameAndPort+"/"},n.getBrowserNetworkClient=function(){return window.fetch&&window.Headers?new $r:new Zr},n.blockReloadInHiddenIframes=function(){if(ye.hashContainsKnownProperties(window.location.hash)&&n.isInIframe())throw Q.createBlockReloadInHiddenIframeError()},n.blockRedirectInIframe=function(e,t){var r=n.isInIframe();if(e===X.Redirect&&r&&!t)throw Q.createRedirectInIframeError(r)},n.blockAcquireTokenInPopups=function(){if(n.isInPopup())throw Q.createBlockAcquireTokenInPopupsError()},n.blockNonBrowserEnvironment=function(e){if(!e)throw Q.createNonBrowserEnvironmentError()},n.blockNativeBrokerCalledBeforeInitialized=function(e,t){if(e&&!t)throw Q.createNativeBrokerCalledBeforeInitialize()},n.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),i=e.indexOf("Edge/");return t>0||r>0||i>0},n}(),en=function(){function n(){}return n.prototype.navigateInternal=function(e,t){return n.defaultNavigateWindow(e,t)},n.prototype.navigateExternal=function(e,t){return n.defaultNavigateWindow(e,t)},n.defaultNavigateWindow=function(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(function(r){setTimeout(function(){r(!0)},t.timeout)})},n}(),rr="@azure/msal-browser",Pt="2.24.0",he=(()=>{return(n=he||(he={})).INITIALIZE_START="msal:initializeStart",n.INITIALIZE_END="msal:initializeEnd",n.ACCOUNT_ADDED="msal:accountAdded",n.ACCOUNT_REMOVED="msal:accountRemoved",n.LOGIN_START="msal:loginStart",n.LOGIN_SUCCESS="msal:loginSuccess",n.LOGIN_FAILURE="msal:loginFailure",n.ACQUIRE_TOKEN_START="msal:acquireTokenStart",n.ACQUIRE_TOKEN_SUCCESS="msal:acquireTokenSuccess",n.ACQUIRE_TOKEN_FAILURE="msal:acquireTokenFailure",n.ACQUIRE_TOKEN_NETWORK_START="msal:acquireTokenFromNetworkStart",n.SSO_SILENT_START="msal:ssoSilentStart",n.SSO_SILENT_SUCCESS="msal:ssoSilentSuccess",n.SSO_SILENT_FAILURE="msal:ssoSilentFailure",n.ACQUIRE_TOKEN_BY_CODE_START="msal:acquireTokenByCodeStart",n.ACQUIRE_TOKEN_BY_CODE_SUCCESS="msal:acquireTokenByCodeSuccess",n.ACQUIRE_TOKEN_BY_CODE_FAILURE="msal:acquireTokenByCodeFailure",n.HANDLE_REDIRECT_START="msal:handleRedirectStart",n.HANDLE_REDIRECT_END="msal:handleRedirectEnd",n.POPUP_OPENED="msal:popupOpened",n.LOGOUT_START="msal:logoutStart",n.LOGOUT_SUCCESS="msal:logoutSuccess",n.LOGOUT_FAILURE="msal:logoutFailure",n.LOGOUT_END="msal:logoutEnd",he;var n})(),sn=function(){function n(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}return n.prototype.addEventCallback=function(e){if("undefined"!=typeof window){var t=this.browserCrypto.createNewGuid();return this.eventCallbacks.set(t,e),this.logger.verbose("Event callback registered with id: "+t),t}return null},n.prototype.removeEventCallback=function(e){this.eventCallbacks.delete(e),this.logger.verbose("Event callback "+e+" removed.")},n.prototype.enableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))},n.prototype.disableAccountStorageEvents=function(){"undefined"!=typeof window&&(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))},n.prototype.emitEvent=function(e,t,r,i){var s=this;if("undefined"!=typeof window){var c={eventType:e,interactionType:t||null,payload:r||null,error:i||null,timestamp:Date.now()};this.logger.info("Emitting event: "+e),this.eventCallbacks.forEach(function(l,h){s.logger.verbose("Emitting event to callback "+h+": "+e),l.apply(null,[c])})}},n.prototype.handleAccountCacheChange=function(e){try{var t=e.newValue||e.oldValue;if(!t)return;var r=JSON.parse(t);if("object"!=typeof r||!De.isAccountEntity(r))return;var s=Xe.toObject(new De,r).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(he.ACCOUNT_ADDED,void 0,s)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(he.ACCOUNT_REMOVED,void 0,s))}catch(c){return}},n}(),Gt=function(){function n(){}return n.generateThrottlingStorageKey=function(e){return"throttling."+JSON.stringify(e)},n.preProcess=function(e,t){var r,i=n.generateThrottlingStorageKey(t),s=e.getThrottlingCache(i);if(s){if(s.throttleTime<Date.now())return void e.removeItem(i,ot.THROTTLING);throw new pt((null===(r=s.errorCodes)||void 0===r?void 0:r.join(" "))||y.EMPTY_STRING,s.errorMessage,s.subError)}},n.postProcess=function(e,t,r){if(n.checkResponseStatus(r)||n.checkResponseForRetryAfter(r)){var i={throttleTime:n.calculateThrottleTime(parseInt(r.headers[se.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(n.generateThrottlingStorageKey(t),i)}},n.checkResponseStatus=function(e){return 429===e.status||e.status>=500&&e.status<600},n.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(se.RETRY_AFTER)&&(e.status<200||e.status>=300)},n.calculateThrottleTime=function(e){var t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(1e3*Math.min(r+(t||60),r+3600))},n.removeThrottle=function(e,t,r,i){var c=this.generateThrottlingStorageKey({clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:i,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid});return e.removeItem(c,ot.THROTTLING)},n}(),an=function(){function n(e,t){this.networkClient=e,this.cacheManager=t}return n.prototype.sendPostRequest=function(e,t,r){return I(this,void 0,void 0,function(){var i,s;return D(this,function(c){switch(c.label){case 0:Gt.preProcess(this.cacheManager,e),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.networkClient.sendPostRequestAsync(t,r)];case 2:return i=c.sent(),[3,4];case 3:throw(s=c.sent())instanceof ae?s:ee.createNetworkError(t,s);case 4:return Gt.postProcess(this.cacheManager,e,i),[2,i]}})})},n}(),nr=function(){function n(e){this.config=function(n){var e=n.authOptions,t=n.systemOptions,r=n.loggerOptions,i=n.storageInterface,s=n.networkInterface,c=n.cryptoInterface,l=n.clientCredentials,h=n.libraryInfo,p=n.telemetry,v=n.serverTelemetryManager,T=n.persistencePlugin,R=n.serializableCache,V=k(k({},jr),r);return{authOptions:Jr(e),systemOptions:k(k({},yr),t),loggerOptions:V,storageInterface:i||new Fr(e.clientId,Dt),networkInterface:s||Wr,cryptoInterface:c||Dt,clientCredentials:l||zr,libraryInfo:k(k({},qr),h),telemetry:k(k({},Vr),p),serverTelemetryManager:v||null,persistencePlugin:T||null,serializableCache:R||null}}(e),this.logger=new dr(this.config.loggerOptions,"@azure/msal-common","6.3.0"),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new an(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority}return n.prototype.createTokenRequestHeaders=function(e){var t={};if(t[se.CONTENT_TYPE]=y.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Fe.HOME_ACCOUNT_ID:try{var r=Ot(e.credential);t[se.CCS_HEADER]="Oid:"+r.uid+"@"+r.utid}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Fe.UPN:t[se.CCS_HEADER]="UPN: "+e.credential}return t},n.prototype.executePostToTokenEndpoint=function(e,t,r,i){return I(this,void 0,void 0,function(){var s;return D(this,function(c){switch(c.label){case 0:return[4,this.networkManager.sendPostRequest(i,e,{body:t,headers:r,proxyUrl:this.config.systemOptions.proxyUrl})];case 1:return s=c.sent(),this.config.serverTelemetryManager&&s.status<500&&429!==s.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,s]}})})},n.prototype.updateAuthority=function(e){if(!e.discoveryComplete())throw ee.createEndpointDiscoveryIncompleteError("Updated authority has not completed endpoint discovery.");this.authority=e},n}(),ft=function(){function n(){}return n.validateRedirectUri=function(e){if(J.isEmpty(e))throw we.createRedirectUriEmptyError()},n.validatePrompt=function(e){var t=[];for(var r in Re)t.push(Re[r]);if(t.indexOf(e)<0)throw we.createInvalidPromptError(e)},n.validateClaims=function(e){try{JSON.parse(e)}catch(t){throw we.createInvalidClaimsRequestError()}},n.validateCodeChallengeParams=function(e,t){if(J.isEmpty(e)||J.isEmpty(t))throw we.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},n.validateCodeChallengeMethod=function(e){if([Mt.PLAIN,Mt.S256].indexOf(e)<0)throw we.createInvalidCodeChallengeMethodError()},n.sanitizeEQParams=function(e,t){return e?(t.forEach(function(r,i){e[i]&&delete e[i]}),e):{}},n}(),Ct=function(){function n(){this.parameters=new Map}return n.prototype.addResponseTypeCode=function(){this.parameters.set(Z.RESPONSE_TYPE,encodeURIComponent(y.CODE_RESPONSE_TYPE))},n.prototype.addResponseTypeForTokenAndIdToken=function(){this.parameters.set(Z.RESPONSE_TYPE,encodeURIComponent(y.TOKEN_RESPONSE_TYPE+" "+y.ID_TOKEN_RESPONSE_TYPE))},n.prototype.addResponseMode=function(e){this.parameters.set(Z.RESPONSE_MODE,encodeURIComponent(e||lt.QUERY))},n.prototype.addNativeBroker=function(){this.parameters.set(Z.NATIVE_BROKER,encodeURIComponent("1"))},n.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?z(e||[],ve):e||[],i=new Ge(r);this.parameters.set(Z.SCOPE,encodeURIComponent(i.printScopes()))},n.prototype.addClientId=function(e){this.parameters.set(Z.CLIENT_ID,encodeURIComponent(e))},n.prototype.addRedirectUri=function(e){ft.validateRedirectUri(e),this.parameters.set(Z.REDIRECT_URI,encodeURIComponent(e))},n.prototype.addPostLogoutRedirectUri=function(e){ft.validateRedirectUri(e),this.parameters.set(Z.POST_LOGOUT_URI,encodeURIComponent(e))},n.prototype.addIdTokenHint=function(e){this.parameters.set(Z.ID_TOKEN_HINT,encodeURIComponent(e))},n.prototype.addDomainHint=function(e){this.parameters.set($e.DOMAIN_HINT,encodeURIComponent(e))},n.prototype.addLoginHint=function(e){this.parameters.set($e.LOGIN_HINT,encodeURIComponent(e))},n.prototype.addCcsUpn=function(e){this.parameters.set(se.CCS_HEADER,encodeURIComponent("UPN:"+e))},n.prototype.addCcsOid=function(e){this.parameters.set(se.CCS_HEADER,encodeURIComponent("Oid:"+e.uid+"@"+e.utid))},n.prototype.addSid=function(e){this.parameters.set($e.SID,encodeURIComponent(e))},n.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);ft.validateClaims(r),this.parameters.set(Z.CLAIMS,encodeURIComponent(r))},n.prototype.addCorrelationId=function(e){this.parameters.set(Z.CLIENT_REQUEST_ID,encodeURIComponent(e))},n.prototype.addLibraryInfo=function(e){this.parameters.set(Z.X_CLIENT_SKU,e.sku),this.parameters.set(Z.X_CLIENT_VER,e.version),e.os&&this.parameters.set(Z.X_CLIENT_OS,e.os),e.cpu&&this.parameters.set(Z.X_CLIENT_CPU,e.cpu)},n.prototype.addApplicationTelemetry=function(e){(null==e?void 0:e.appName)&&this.parameters.set(Z.X_APP_NAME,e.appName),(null==e?void 0:e.appVersion)&&this.parameters.set(Z.X_APP_VER,e.appVersion)},n.prototype.addPrompt=function(e){ft.validatePrompt(e),this.parameters.set(""+Z.PROMPT,encodeURIComponent(e))},n.prototype.addState=function(e){J.isEmpty(e)||this.parameters.set(Z.STATE,encodeURIComponent(e))},n.prototype.addNonce=function(e){this.parameters.set(Z.NONCE,encodeURIComponent(e))},n.prototype.addCodeChallengeParams=function(e,t){if(ft.validateCodeChallengeParams(e,t),!e||!t)throw we.createInvalidCodeChallengeParamsError();this.parameters.set(Z.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(Z.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},n.prototype.addAuthorizationCode=function(e){this.parameters.set(Z.CODE,encodeURIComponent(e))},n.prototype.addDeviceCode=function(e){this.parameters.set(Z.DEVICE_CODE,encodeURIComponent(e))},n.prototype.addRefreshToken=function(e){this.parameters.set(Z.REFRESH_TOKEN,encodeURIComponent(e))},n.prototype.addCodeVerifier=function(e){this.parameters.set(Z.CODE_VERIFIER,encodeURIComponent(e))},n.prototype.addClientSecret=function(e){this.parameters.set(Z.CLIENT_SECRET,encodeURIComponent(e))},n.prototype.addClientAssertion=function(e){this.parameters.set(Z.CLIENT_ASSERTION,encodeURIComponent(e))},n.prototype.addClientAssertionType=function(e){this.parameters.set(Z.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},n.prototype.addOboAssertion=function(e){this.parameters.set(Z.OBO_ASSERTION,encodeURIComponent(e))},n.prototype.addRequestTokenUse=function(e){this.parameters.set(Z.REQUESTED_TOKEN_USE,encodeURIComponent(e))},n.prototype.addGrantType=function(e){this.parameters.set(Z.GRANT_TYPE,encodeURIComponent(e))},n.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},n.prototype.addExtraQueryParameters=function(e){var t=this;ft.sanitizeEQParams(e,this.parameters),Object.keys(e).forEach(function(r){t.parameters.set(r,e[r])})},n.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(e)try{r=JSON.parse(e)}catch(i){throw we.createInvalidClaimsRequestError()}else r={};return t&&t.length>0&&(r.hasOwnProperty(Me.ACCESS_TOKEN)||(r[Me.ACCESS_TOKEN]={}),r[Me.ACCESS_TOKEN][Me.XMS_CC]={values:t}),JSON.stringify(r)},n.prototype.addUsername=function(e){this.parameters.set(q.username,e)},n.prototype.addPassword=function(e){this.parameters.set(q.password,e)},n.prototype.addPopToken=function(e){J.isEmpty(e)||(this.parameters.set(Z.TOKEN_TYPE,P.POP),this.parameters.set(Z.REQ_CNF,encodeURIComponent(e)))},n.prototype.addSshJwk=function(e){J.isEmpty(e)||(this.parameters.set(Z.TOKEN_TYPE,P.SSH),this.parameters.set(Z.REQ_CNF,encodeURIComponent(e)))},n.prototype.addServerTelemetry=function(e){this.parameters.set(Z.X_CLIENT_CURR_TELEM,e.generateCurrentRequestHeaderValue()),this.parameters.set(Z.X_CLIENT_LAST_TELEM,e.generateLastRequestHeaderValue())},n.prototype.addThrottling=function(){this.parameters.set(Z.X_MS_LIB_CAPABILITY,"retry-after, h429")},n.prototype.addLogoutHint=function(e){this.parameters.set(Z.LOGOUT_HINT,encodeURIComponent(e))},n.prototype.createQueryString=function(){var e=new Array;return this.parameters.forEach(function(t,r){e.push(r+"="+t)}),e.join("&")},n}(),cn=function(e,t,r,i,s){this.account=e||null,this.idToken=t||null,this.accessToken=r||null,this.refreshToken=i||null,this.appMetadata=s||null},jt=(()=>{return(n=jt||(jt={})).SW="sw",n.UHW="uhw",jt;var n})(),Tt=function(){function n(e){this.cryptoUtils=e}return n.prototype.generateCnf=function(e){return I(this,void 0,void 0,function(){var t;return D(this,function(r){switch(r.label){case 0:return[4,this.generateKid(e)];case 1:return t=r.sent(),[2,this.cryptoUtils.base64Encode(JSON.stringify(t))]}})})},n.prototype.generateCnfHash=function(e){return I(this,void 0,void 0,function(){return D(this,function(t){return[2,this.cryptoUtils.hashString(e)]})})},n.prototype.generateKid=function(e){return I(this,void 0,void 0,function(){return D(this,function(r){switch(r.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(e)];case 1:return[2,{kid:r.sent(),xms_ksl:jt.SW}]}})})},n.prototype.signPopToken=function(e,t){var r;return I(this,void 0,void 0,function(){var i;return D(this,function(s){if(i=st.extractTokenClaims(e,this.cryptoUtils),!(null===(r=null==i?void 0:i.cnf)||void 0===r?void 0:r.kid))throw ee.createTokenClaimsRequiredError();return[2,this.signPayload(e,i.cnf.kid,t)]})})},n.prototype.signPayload=function(e,t,r,i){return I(this,void 0,void 0,function(){var s,c,l,h,p,v;return D(this,function(T){switch(T.label){case 0:return s=r.resourceRequestMethod,l=r.shrClaims,h=r.shrNonce,p=(c=r.resourceRequestUri)?new ye(c):void 0,v=null==p?void 0:p.getUrlComponents(),[4,this.cryptoUtils.signJwt(k({at:e,ts:Ye.nowSeconds(),m:null==s?void 0:s.toUpperCase(),u:null==v?void 0:v.HostNameAndPort,nonce:h||this.cryptoUtils.createNewGuid(),p:null==v?void 0:v.AbsolutePath,q:(null==v?void 0:v.QueryString)?[[],v.QueryString]:void 0,client_claims:l||void 0},i),t,r.correlationId)];case 1:return[2,T.sent()]}})})},n}(),ln=function(){function n(e,t){this.cache=e,this.hasChanged=t}return Object.defineProperty(n.prototype,"cacheHasChanged",{get:function(){return this.hasChanged},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tokenCache",{get:function(){return this.cache},enumerable:!1,configurable:!0}),n}(),Wt=function(){function n(e,t,r,i,s,c){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=i,this.serializableCache=s,this.persistencePlugin=c}return n.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(!e.state||!t)throw ee.createStateNotFoundError(e.state?"Cached State":"Server State");if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw ee.createStateMismatchError();if(e.error||e.error_description||e.suberror)throw ct.isInteractionRequiredError(e.error,e.error_description,e.suberror)?new ct(e.error||y.EMPTY_STRING,e.error_description,e.suberror):new pt(e.error||y.EMPTY_STRING,e.error_description,e.suberror);e.client_info&&Ht(e.client_info,r)},n.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(ct.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new ct(e.error,e.error_description,e.suberror);throw new pt(e.error,e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id,e.suberror)}},n.prototype.handleServerTokenResponse=function(e,t,r,i,s,c,l){return I(this,void 0,void 0,function(){var h,p,v,T,R;return D(this,function($){switch($.label){case 0:if(e.id_token&&(h=new st(e.id_token||y.EMPTY_STRING,this.cryptoObj),s&&!J.isEmpty(s.nonce)&&h.claims.nonce!==s.nonce))throw ee.createNonceMismatchError();this.homeAccountIdentifier=De.generateHomeAccountId(e.client_info||y.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,h),!!s&&!!s.state&&(p=at.parseRequestState(this.cryptoObj,s.state)),e.key_id=e.key_id||i.sshKid||void 0,v=this.generateCacheRecord(e,t,r,i,h,c,s),$.label=1;case 1:return $.trys.push([1,,5,8]),this.persistencePlugin&&this.serializableCache?(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),T=new ln(this.serializableCache,!0),[4,this.persistencePlugin.beforeCacheAccess(T)]):[3,3];case 2:$.sent(),$.label=3;case 3:return l&&v.account&&(R=v.account.generateAccountKey(),!this.cacheStorage.getAccount(R))?(this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),[2,n.generateAuthenticationResult(this.cryptoObj,t,v,!1,i,h,p)]):[4,this.cacheStorage.saveCacheRecord(v)];case 4:return $.sent(),[3,8];case 5:return this.persistencePlugin&&this.serializableCache&&T?(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),[4,this.persistencePlugin.afterCacheAccess(T)]):[3,7];case 6:$.sent(),$.label=7;case 7:return[7];case 8:return[2,n.generateAuthenticationResult(this.cryptoObj,t,v,!1,i,h,p,e.spa_code)]}})})},n.prototype.generateCacheRecord=function(e,t,r,i,s,c,l){var p,v,h=t.getPreferredCache();if(J.isEmpty(h))throw ee.createInvalidCacheEnvironmentError();!J.isEmpty(e.id_token)&&s&&(p=Ft.createIdTokenEntity(this.homeAccountIdentifier,h,e.id_token||y.EMPTY_STRING,this.clientId,s.claims.tid||y.EMPTY_STRING,c),v=this.generateAccountEntity(e,s,t,c,l));var T=null;if(!J.isEmpty(e.access_token)){var R=e.scope?Ge.fromString(e.scope):new Ge(i.scopes||[]),V=("string"==typeof e.expires_in?parseInt(e.expires_in,10):e.expires_in)||0,$=("string"==typeof e.ext_expires_in?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,le=("string"==typeof e.refresh_in?parseInt(e.refresh_in,10):e.refresh_in)||void 0,oe=r+V,ie=oe+$,be=le&&le>0?r+le:void 0;T=Kt.createAccessTokenEntity(this.homeAccountIdentifier,h,e.access_token||y.EMPTY_STRING,this.clientId,s?s.claims.tid||y.EMPTY_STRING:t.tenant,R.printScopes(),oe,ie,this.cryptoObj,be,e.token_type,c,e.key_id,i.claims,i.requestedClaimsHash)}var Ee=null;J.isEmpty(e.refresh_token)||(Ee=Xt.createRefreshTokenEntity(this.homeAccountIdentifier,h,e.refresh_token||y.EMPTY_STRING,this.clientId,e.foci,c));var Ke=null;return J.isEmpty(e.foci)||(Ke=$t.createAppMetadataEntity(this.clientId,h,e.foci)),new cn(v,p,T,Ee,Ke)},n.prototype.generateAccountEntity=function(e,t,r,i,s){var l=s?s.cloud_graph_host_name:y.EMPTY_STRING,h=s?s.msgraph_host:y.EMPTY_STRING;if(r.authorityType===tt.Adfs)return this.logger.verbose("Authority type is ADFS, creating ADFS account"),De.createGenericAccount(this.homeAccountIdentifier,t,r,i,l,h);if(J.isEmpty(e.client_info)&&"AAD"===r.protocolMode)throw ee.createClientInfoEmptyError();return e.client_info?De.createAccount(e.client_info,this.homeAccountIdentifier,t,r,i,l,h):De.createGenericAccount(this.homeAccountIdentifier,t,r,i,l,h)},n.generateAuthenticationResult=function(e,t,r,i,s,c,l,h){var p,v,T;return I(this,void 0,void 0,function(){var R,V,$,le,oe;return D(this,function(Ke){switch(Ke.label){case 0:return R=y.EMPTY_STRING,V=[],$=null,oe=y.EMPTY_STRING,r.accessToken?r.accessToken.tokenType!==P.POP?[3,2]:[4,new Tt(e).signPopToken(r.accessToken.secret,s)]:[3,4];case 1:return R=Ke.sent(),[3,3];case 2:R=r.accessToken.secret,Ke.label=3;case 3:V=Ge.fromString(r.accessToken.target).asArray(),$=new Date(1e3*Number(r.accessToken.expiresOn)),le=new Date(1e3*Number(r.accessToken.extendedExpiresOn)),Ke.label=4;case 4:return r.appMetadata&&(oe="1"===r.appMetadata.familyId?"1":y.EMPTY_STRING),[2,{authority:t.canonicalAuthority,uniqueId:(null==c?void 0:c.claims.oid)||(null==c?void 0:c.claims.sub)||y.EMPTY_STRING,tenantId:(null==c?void 0:c.claims.tid)||y.EMPTY_STRING,scopes:V,account:r.account?r.account.getAccountInfo():null,idToken:c?c.rawToken:y.EMPTY_STRING,idTokenClaims:c?c.claims:{},accessToken:R,fromCache:i,expiresOn:$,correlationId:s.correlationId,extExpiresOn:le,familyId:oe,tokenType:(null===(p=r.accessToken)||void 0===p?void 0:p.tokenType)||y.EMPTY_STRING,state:l?l.userRequestState:y.EMPTY_STRING,cloudGraphHostName:(null===(v=r.account)||void 0===v?void 0:v.cloudGraphHostName)||y.EMPTY_STRING,msGraphHost:(null===(T=r.account)||void 0===T?void 0:T.msGraphHost)||y.EMPTY_STRING,code:h,fromNativeBroker:!1}]}})})},n}(),Cr=function(n){function e(t){var r=n.call(this,t)||this;return r.includeRedirectUri=!0,r}return U(e,n),e.prototype.getAuthCodeUrl=function(t){return I(this,void 0,void 0,function(){var r;return D(this,function(i){switch(i.label){case 0:return[4,this.createAuthCodeUrlQueryString(t)];case 1:return r=i.sent(),[2,ye.appendQueryString(this.authority.authorizationEndpoint,r)]}})})},e.prototype.acquireToken=function(t,r){return I(this,void 0,void 0,function(){var i,s,c;return D(this,function(l){switch(l.label){case 0:if(this.logger.info("in acquireToken call"),!t||J.isEmpty(t.code))throw ee.createTokenRequestCannotBeMadeError();return i=Ye.nowSeconds(),[4,this.executeTokenRequest(this.authority,t)];case 1:return s=l.sent(),(c=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(s.body),[4,c.handleServerTokenResponse(s.body,this.authority,i,t,r)];case 2:return[2,l.sent()]}})})},e.prototype.handleFragmentResponse=function(t,r){var i=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null),s=new ye(t),c=ye.getDeserializedHash(s.getHash());if(i.validateServerAuthorizationCodeResponse(c,r,this.cryptoUtils),!c.code)throw ee.createNoAuthCodeInServerResponseError();return k(k({},c),{code:c.code})},e.prototype.getLogoutUri=function(t){if(!t)throw we.createEmptyLogoutRequestError();var r=this.createLogoutUrlQueryString(t);return ye.appendQueryString(this.authority.endSessionEndpoint,r)},e.prototype.executeTokenRequest=function(t,r){return I(this,void 0,void 0,function(){var i,s,c,l,h,p,v;return D(this,function(T){switch(T.label){case 0:return i={clientId:this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:r.scopes,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},[4,this.createTokenRequestBody(r)];case 1:if(s=T.sent(),c=this.createTokenQueryParameters(r),l=void 0,r.clientInfo)try{h=Ht(r.clientInfo,this.cryptoUtils),l={credential:""+h.uid+xe.CLIENT_INFO_SEPARATOR+h.utid,type:Fe.HOME_ACCOUNT_ID}}catch(R){this.logger.verbose("Could not parse client info for CCS Header: "+R)}return p=this.createTokenRequestHeaders(l||r.ccsCredential),v=J.isEmpty(c)?t.tokenEndpoint:t.tokenEndpoint+"?"+c,[2,this.executePostToTokenEndpoint(v,s,p,i)]}})})},e.prototype.createTokenQueryParameters=function(t){var r=new Ct;return t.tokenQueryParameters&&r.addExtraQueryParameters(t.tokenQueryParameters),r.createQueryString()},e.prototype.createTokenRequestBody=function(t){return I(this,void 0,void 0,function(){var r,i,c,l,h,p,v;return D(this,function(T){switch(T.label){case 0:return(r=new Ct).addClientId(this.config.authOptions.clientId),this.includeRedirectUri?r.addRedirectUri(t.redirectUri):ft.validateRedirectUri(t.redirectUri),r.addScopes(t.scopes),r.addAuthorizationCode(t.code),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&r.addServerTelemetry(this.serverTelemetryManager),t.codeVerifier&&r.addCodeVerifier(t.codeVerifier),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r.addClientAssertion((i=this.config.clientCredentials.clientAssertion).assertion),r.addClientAssertionType(i.assertionType)),r.addGrantType(ut.AUTHORIZATION_CODE_GRANT),r.addClientInfo(),t.authenticationScheme!==P.POP?[3,2]:[4,new Tt(this.cryptoUtils).generateCnf(t)];case 1:return c=T.sent(),r.addPopToken(c),[3,3];case 2:if(t.authenticationScheme===P.SSH){if(!t.sshJwk)throw we.createMissingSshJwkError();r.addSshJwk(t.sshJwk)}T.label=3;case 3:if(l=t.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(l),(!J.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(t.claims,this.config.authOptions.clientCapabilities),h=void 0,t.clientInfo)try{p=Ht(t.clientInfo,this.cryptoUtils),h={credential:""+p.uid+xe.CLIENT_INFO_SEPARATOR+p.utid,type:Fe.HOME_ACCOUNT_ID}}catch(R){this.logger.verbose("Could not parse client info for CCS Header: "+R)}else h=t.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&h)switch(h.type){case Fe.HOME_ACCOUNT_ID:try{p=Ot(h.credential),r.addCcsOid(p)}catch(R){this.logger.verbose("Could not parse home account ID for CCS Header: "+R)}break;case Fe.UPN:r.addCcsUpn(h.credential)}return t.tokenBodyParameters&&r.addExtraQueryParameters(t.tokenBodyParameters),t.enableSpaAuthorizationCode&&(!t.tokenBodyParameters||!t.tokenBodyParameters[Z.RETURN_SPA_CODE])&&r.addExtraQueryParameters(((v={})[Z.RETURN_SPA_CODE]="1",v)),[2,r.createQueryString()]}})})},e.prototype.createAuthCodeUrlQueryString=function(t){return I(this,void 0,void 0,function(){var r,i,s,c,l,h,p,v;return D(this,function(T){switch(T.label){case 0:if((r=new Ct).addClientId(this.config.authOptions.clientId),i=z(t.scopes||[],t.extraScopesToConsent||[]),r.addScopes(i),r.addRedirectUri(t.redirectUri),s=t.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(s),r.addResponseMode(t.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),t.codeChallenge&&t.codeChallengeMethod&&r.addCodeChallengeParams(t.codeChallenge,t.codeChallengeMethod),t.prompt&&r.addPrompt(t.prompt),t.domainHint&&r.addDomainHint(t.domainHint),t.prompt!==Re.SELECT_ACCOUNT)if(t.sid&&t.prompt===Re.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(t.sid);else if(t.account){if((c=this.extractAccountSid(t.account))&&t.prompt===Re.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(c);try{l=Ot(t.account.homeAccountId),r.addCcsOid(l)}catch(R){this.logger.verbose("Could not parse home account ID for CCS Header: "+R)}}else if(t.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(t.loginHint),r.addCcsUpn(t.loginHint);else if(t.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(t.account.username);try{l=Ot(t.account.homeAccountId),r.addCcsOid(l)}catch(R){this.logger.verbose("Could not parse home account ID for CCS Header: "+R)}}}else t.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(t.loginHint),r.addCcsUpn(t.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return t.nonce&&r.addNonce(t.nonce),t.state&&r.addState(t.state),(!J.isEmpty(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(t.claims,this.config.authOptions.clientCapabilities),t.extraQueryParameters&&r.addExtraQueryParameters(t.extraQueryParameters),t.nativeBroker?(r.addNativeBroker(),t.authenticationScheme!==P.POP?[3,3]:[4,(h=new Tt(this.cryptoUtils)).generateCnf(t)]):[3,3];case 1:return p=T.sent(),[4,h.generateCnfHash(p)];case 2:v=T.sent(),r.addPopToken(v),T.label=3;case 3:return[2,r.createQueryString()]}})})},e.prototype.createLogoutUrlQueryString=function(t){var r=new Ct;return t.postLogoutRedirectUri&&r.addPostLogoutRedirectUri(t.postLogoutRedirectUri),t.correlationId&&r.addCorrelationId(t.correlationId),t.idTokenHint&&r.addIdTokenHint(t.idTokenHint),t.state&&r.addState(t.state),t.logoutHint&&r.addLogoutHint(t.logoutHint),t.extraQueryParameters&&r.addExtraQueryParameters(t.extraQueryParameters),r.createQueryString()},e.prototype.extractAccountSid=function(t){return t.idTokenClaims&&t.idTokenClaims.sid||null},e}(nr);function un(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")}var dn=function(){function n(e){this.networkInterface=e}return n.prototype.detectRegion=function(e,t,r){return I(this,void 0,void 0,function(){var i,s,c,l,h;return D(this,function(p){switch(p.label){case 0:if(i=e)return[3,8];s=n.IMDS_OPTIONS,r&&(s.proxyUrl=r),p.label=1;case 1:return p.trys.push([1,6,,7]),[4,this.getRegionFromIMDS(y.IMDS_VERSION,s)];case 2:return(c=p.sent()).status===ue.httpSuccess&&(i=c.body,t.region_source=me.IMDS),c.status!==ue.httpBadRequest?[3,5]:[4,this.getCurrentVersion(s)];case 3:return(l=p.sent())?[4,this.getRegionFromIMDS(l,s)]:(t.region_source=me.FAILED_AUTO_DETECTION,[2,null]);case 4:(h=p.sent()).status===ue.httpSuccess&&(i=h.body,t.region_source=me.IMDS),p.label=5;case 5:return[3,7];case 6:return p.sent(),t.region_source=me.FAILED_AUTO_DETECTION,[2,null];case 7:return[3,9];case 8:t.region_source=me.ENVIRONMENT_VARIABLE,p.label=9;case 9:return i||(t.region_source=me.FAILED_AUTO_DETECTION),[2,i||null]}})})},n.prototype.getRegionFromIMDS=function(e,t){return I(this,void 0,void 0,function(){return D(this,function(r){return[2,this.networkInterface.sendGetRequestAsync(y.IMDS_ENDPOINT+"?api-version="+e+"&format=text",t,y.IMDS_TIMEOUT)]})})},n.prototype.getCurrentVersion=function(e){return I(this,void 0,void 0,function(){var t;return D(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.networkInterface.sendGetRequestAsync(y.IMDS_ENDPOINT+"?format=json",e)];case 1:return(t=r.sent()).status===ue.httpBadRequest&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?[2,t.body["newest-versions"][0]]:[2,null];case 2:return r.sent(),[2,null];case 3:return[2]}})})},n.IMDS_OPTIONS={headers:{Metadata:"true"}},n}(),qt=function(){function n(e,t,r,i,s){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=i,this.regionDiscovery=new dn(t),this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.proxyUrl=s||y.EMPTY_STRING}return Object.defineProperty(n.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===y.ADFS?tt.Adfs:tt.Default},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"protocolMode",{get:function(){return this.authorityOptions.protocolMode},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"options",{get:function(){return this.authorityOptions},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new ye(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hostnameAndPort",{get:function(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.authorization_endpoint);return this.replaceTenant(e)}throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint);return this.replaceTenant(e)}throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));return this.replaceTenant(e)}throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw ee.createLogoutNotSupportedError();var e=this.replacePath(this.metadata.end_session_endpoint);return this.replaceTenant(e)}throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete()){var e=this.replacePath(this.metadata.issuer);return this.replaceTenant(e)}throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!1,configurable:!0}),n.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},n.prototype.replacePath=function(e){var t=e,i=new ye(this.metadata.canonical_authority).getUrlComponents().PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach(function(c,l){var h=i[l];c!==h&&(t=t.replace("/"+h+"/","/"+c+"/"))}),t},Object.defineProperty(n.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===tt.Adfs||this.protocolMode===kt.OIDC?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!1,configurable:!0}),n.prototype.discoveryComplete=function(){return!!this.metadata},n.prototype.resolveEndpointsAsync=function(){return I(this,void 0,void 0,function(){var e,t,r,i;return D(this,function(s){switch(s.label){case 0:return(e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort))||(e=new Zt).updateCanonicalAuthority(this.canonicalAuthority),[4,this.updateCloudDiscoveryMetadata(e)];case 1:return t=s.sent(),this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network),[4,this.updateEndpointMetadata(e)];case 2:return r=s.sent(),t!==Be.CACHE&&r!==Be.CACHE&&(e.resetExpiresAt(),e.updateCanonicalAuthority(this.canonicalAuthority)),i=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache),this.cacheManager.setAuthorityMetadata(i,e),this.metadata=e,[2]}})})},n.prototype.updateEndpointMetadata=function(e){var t;return I(this,void 0,void 0,function(){var r,i,s;return D(this,function(c){switch(c.label){case 0:return(r=this.getEndpointMetadataFromConfig())?(e.updateEndpointMetadata(r,!1),[2,Be.CONFIG]):this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!e.isExpired()?[2,Be.CACHE]:[4,this.getEndpointMetadataFromNetwork()];case 1:return(r=c.sent())?(null===(t=this.authorityOptions.azureRegionConfiguration)||void 0===t?void 0:t.azureRegion)?[4,this.regionDiscovery.detectRegion(this.authorityOptions.azureRegionConfiguration.environmentRegion,this.regionDiscoveryMetadata,this.proxyUrl)]:[3,3]:[3,4];case 2:i=c.sent(),s=this.authorityOptions.azureRegionConfiguration.azureRegion===y.AZURE_REGION_AUTO_DISCOVER_FLAG?i:this.authorityOptions.azureRegionConfiguration.azureRegion,this.regionDiscoveryMetadata.region_outcome=this.authorityOptions.azureRegionConfiguration.azureRegion===y.AZURE_REGION_AUTO_DISCOVER_FLAG?i?qe.AUTO_DETECTION_REQUESTED_SUCCESSFUL:qe.AUTO_DETECTION_REQUESTED_FAILED:i?this.authorityOptions.azureRegionConfiguration.azureRegion===i?qe.CONFIGURED_MATCHES_DETECTED:qe.CONFIGURED_NOT_DETECTED:qe.CONFIGURED_NO_AUTO_DETECTION,s&&(this.regionDiscoveryMetadata.region_used=s,r=n.replaceWithRegionalInformation(r,s)),c.label=3;case 3:return e.updateEndpointMetadata(r,!0),[2,Be.NETWORK];case 4:throw ee.createUnableToGetOpenidConfigError(this.defaultOpenIdConfigurationEndpoint)}})})},n.prototype.isAuthoritySameType=function(e){return new ye(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length},n.prototype.getEndpointMetadataFromConfig=function(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch(e){throw we.createInvalidAuthorityMetadataError()}return null},n.prototype.getEndpointMetadataFromNetwork=function(){return I(this,void 0,void 0,function(){var e,t;return D(this,function(r){switch(r.label){case 0:e={},this.proxyUrl&&(e.proxyUrl=this.proxyUrl),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(this.defaultOpenIdConfigurationEndpoint,e)];case 2:return[2,un((t=r.sent()).body)?t.body:null];case 3:return r.sent(),[2,null];case 4:return[2]}})})},n.prototype.updateCloudDiscoveryMetadata=function(e){return I(this,void 0,void 0,function(){var t;return D(this,function(r){switch(r.label){case 0:return(t=this.getCloudDiscoveryMetadataFromConfig())?(e.updateCloudDiscoveryMetadata(t,!1),[2,Be.CONFIG]):this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!e.isExpired()?[2,Be.CACHE]:[4,this.getCloudDiscoveryMetadataFromNetwork()];case 1:if(t=r.sent())return e.updateCloudDiscoveryMetadata(t,!0),[2,Be.NETWORK];throw we.createUntrustedAuthorityError()}})})},n.prototype.getCloudDiscoveryMetadataFromConfig=function(){if(this.authorityOptions.cloudDiscoveryMetadata)try{var e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=n.getCloudDiscoveryMetadataFromNetworkResponse(e.metadata,this.hostnameAndPort);if(t)return t}catch(r){throw we.createInvalidCloudDiscoveryMetadataError()}return this.isInKnownAuthorities()?n.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort):null},n.prototype.getCloudDiscoveryMetadataFromNetwork=function(){return I(this,void 0,void 0,function(){var e,t,r,i,s;return D(this,function(c){switch(c.label){case 0:e=""+y.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize",t={},this.proxyUrl&&(t.proxyUrl=this.proxyUrl),r=null,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.networkInterface.sendGetRequestAsync(e,t)];case 2:return i=c.sent(),s=function(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}(i.body)?i.body.metadata:[],0===s.length?[2,null]:(r=n.getCloudDiscoveryMetadataFromNetworkResponse(s,this.hostnameAndPort),[3,4]);case 3:return c.sent(),[2,null];case 4:return r||(r=n.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),[2,r]}})})},n.prototype.isInKnownAuthorities=function(){var e=this;return this.authorityOptions.knownAuthorities.filter(function(r){return ye.getDomainFromUrl(r).toLowerCase()===e.hostnameAndPort}).length>0},n.generateAuthority=function(e,t){var r;return t&&t.azureCloudInstance!==yt.None&&(r=t.azureCloudInstance+"/"+(t.tenant?t.tenant:y.DEFAULT_COMMON_TENANT)+"/"),r||e},n.createCloudDiscoveryMetadataFromHost=function(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}},n.getCloudDiscoveryMetadataFromNetworkResponse=function(e,t){for(var r=0;r<e.length;r++){var i=e[r];if(i.aliases.indexOf(t)>-1)return i}return null},n.prototype.getPreferredCache=function(){if(this.discoveryComplete())return this.metadata.preferred_cache;throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},n.prototype.isAlias=function(e){return this.metadata.aliases.indexOf(e)>-1},n.isPublicCloudAuthority=function(e){return y.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0},n.buildRegionalAuthorityString=function(e,t,r){var i=new ye(e);i.validateAsUri();var s=i.getUrlComponents(),c=t+"."+s.HostNameAndPort;this.isPublicCloudAuthority(s.HostNameAndPort)&&(c=t+"."+y.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX);var l=ye.constructAuthorityUriFromObject(k(k({},i.getUrlComponents()),{HostNameAndPort:c})).urlString;return r?l+"?"+r:l},n.replaceWithRegionalInformation=function(e,t){return e.authorization_endpoint=n.buildRegionalAuthorityString(e.authorization_endpoint,t),e.token_endpoint=n.buildRegionalAuthorityString(e.token_endpoint,t,"allowestsrnonmsi=true"),e.end_session_endpoint&&(e.end_session_endpoint=n.buildRegionalAuthorityString(e.end_session_endpoint,t)),e},n}(),zt=function(){function n(){}return n.createDiscoveredInstance=function(e,t,r,i,s){return I(this,void 0,void 0,function(){var c,l;return D(this,function(h){switch(h.label){case 0:c=n.createInstance(e,t,r,i,s),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,c.resolveEndpointsAsync()];case 2:return h.sent(),[2,c];case 3:throw l=h.sent(),ee.createEndpointDiscoveryIncompleteError(l);case 4:return[2]}})})},n.createInstance=function(e,t,r,i,s){if(J.isEmpty(e))throw we.createUrlEmptyError();return new qt(e,t,r,i,s)},n}(),pn=function(){function n(e,t){this.cacheOutcome=Ze.NO_CACHE_HIT,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||y.EMPTY_STRING,this.wrapperVer=e.wrapperVer||y.EMPTY_STRING,this.telemetryCacheKey=Oe.CACHE_KEY+xe.CACHE_KEY_SEPARATOR+e.clientId}return n.prototype.generateCurrentRequestHeaderValue=function(){var e=""+this.apiId+Oe.VALUE_SEPARATOR+this.cacheOutcome,t=[this.wrapperSKU,this.wrapperVer].join(Oe.VALUE_SEPARATOR),i=[e,this.getRegionDiscoveryFields()].join(Oe.VALUE_SEPARATOR);return[Oe.SCHEMA_VERSION,i,t].join(Oe.CATEGORY_SEPARATOR)},n.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=n.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(Oe.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(Oe.VALUE_SEPARATOR),s=e.errors.length,l=[s,t<s?Oe.OVERFLOW_TRUE:Oe.OVERFLOW_FALSE].join(Oe.VALUE_SEPARATOR);return[Oe.SCHEMA_VERSION,e.cacheHits,r,i,l].join(Oe.CATEGORY_SEPARATOR)},n.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.errors.length>=Oe.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),J.isEmpty(e.subError)?J.isEmpty(e.errorCode)?e&&e.toString()?t.errors.push(e.toString()):t.errors.push(Oe.UNKNOWN_ERROR):t.errors.push(e.errorCode):t.errors.push(e.subError),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)},n.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits},n.prototype.getLastRequests=function(){var e=new Bt;return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e},n.prototype.clearTelemetryCache=function(){var e=this.getLastRequests(),t=n.maxErrorsToSend(e);if(t===e.errors.length)this.cacheManager.removeItem(this.telemetryCacheKey);else{var i=new Bt;i.failedRequests=e.failedRequests.slice(2*t),i.errors=e.errors.slice(t),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)}},n.maxErrorsToSend=function(e){var t,r=0,i=0,s=e.errors.length;for(t=0;t<s;t++){var l=e.failedRequests[2*t+1]||y.EMPTY_STRING,h=e.errors[t]||y.EMPTY_STRING;if(!((i+=(e.failedRequests[2*t]||y.EMPTY_STRING).toString().length+l.toString().length+h.length+3)<Oe.MAX_LAST_HEADER_BYTES))break;r+=1}return r},n.prototype.getRegionDiscoveryFields=function(){var e=[];return e.push(this.regionUsed||y.EMPTY_STRING),e.push(this.regionSource||y.EMPTY_STRING),e.push(this.regionOutcome||y.EMPTY_STRING),e.join(",")},n.prototype.updateRegionDiscoveryMetadata=function(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome},n.prototype.setCacheOutcome=function(e){this.cacheOutcome=e},n}(),Tr=function(){function n(e,t,r,i,s,c,l,h,p){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=s,this.navigationClient=c,this.nativeMessageHandler=h,this.correlationId=p||this.browserCrypto.createNewGuid(),this.logger=i.clone("msal.js.browser",Pt,this.correlationId),this.performanceClient=l}return n.prototype.clearCacheOnLogout=function(e){return L(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:if(!e)return[3,5];De.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null)),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.browserStorage.removeAccount(De.generateAccountCacheKey(e))];case 2:return t.sent(),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request."),[3,4];case 3:return t.sent(),this.logger.error("Account provided in logout request was not found. Local cache unchanged."),[3,4];case 4:return[3,9];case 5:return t.trys.push([5,8,,9]),this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),[4,this.browserStorage.clear()];case 6:return t.sent(),[4,this.browserCrypto.clearKeystore()];case 7:return t.sent(),[3,9];case 8:return t.sent(),this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged."),[3,9];case 9:return[2]}})})},n.prototype.initializeBaseRequest=function(e){return L(this,void 0,void 0,function(){var t,r,i,s;return x(this,function(c){switch(c.label){case 0:if(this.logger.verbose("Initializing BaseAuthRequest"),t=e.authority||this.config.auth.authority,r=Pe(e&&e.scopes||[]),(i=G(G({},e),{correlationId:this.correlationId,authority:t,scopes:r})).authenticationScheme){if(i.authenticationScheme===P.SSH){if(!e.sshJwk)throw we.createMissingSshJwkError();if(!e.sshKid)throw we.createMissingSshKidError()}this.logger.verbose('Authentication Scheme set to "'+i.authenticationScheme+'" as configured in Auth request')}else i.authenticationScheme=P.BEARER,this.logger.verbose('Authentication Scheme wasn\'t explicitly set in request, defaulting to "Bearer" request');return e.claims&&!J.isEmpty(e.claims)?(s=i,[4,this.browserCrypto.hashString(e.claims)]):[3,2];case 1:s.requestedClaimsHash=c.sent(),c.label=2;case 2:return[2,i]}})})},n.prototype.getRedirectUri=function(e){this.logger.verbose("getRedirectUri called");var t=e||this.config.auth.redirectUri||Ie.getCurrentUri();return ye.getAbsoluteUrl(t,Ie.getCurrentUri())},n.prototype.initializeServerTelemetryManager=function(e,t){this.logger.verbose("initializeServerTelemetryManager called");var r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new pn(r,this.browserStorage)},n.prototype.getDiscoveredAuthority=function(e){return L(this,void 0,void 0,function(){var t;return x(this,function(r){switch(r.label){case 0:return this.logger.verbose("getDiscoveredAuthority called"),t={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},e?(this.logger.verbose("Creating discovered authority with request authority"),[4,zt.createDiscoveredInstance(e,this.config.system.networkClient,this.browserStorage,t)]):[3,2];case 1:case 3:return[2,r.sent()];case 2:return this.logger.verbose("Creating discovered authority with configured authority"),[4,zt.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient,this.browserStorage,t)]}})})},n}(),St=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return te(e,n),e.prototype.initializeAuthorizationCodeRequest=function(t){return L(this,void 0,void 0,function(){var r,i;return x(this,function(s){switch(s.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",t.correlationId),[4,this.browserCrypto.generatePkceCodes()];case 1:return r=s.sent(),i=G(G({},t),{redirectUri:t.redirectUri,code:y.EMPTY_STRING,codeVerifier:r.verifier}),t.codeChallenge=r.challenge,t.codeChallengeMethod=y.S256_CODE_CHALLENGE_METHOD,[2,i]}})})},e.prototype.initializeLogoutRequest=function(t){this.logger.verbose("initializeLogoutRequest called",null==t?void 0:t.correlationId);var r=G({correlationId:this.correlationId||this.browserCrypto.createNewGuid()},t);if(t)if(t.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(t.account){var i=this.getLogoutHintFromIdTokenClaims(t.account);i&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),r.logoutHint=i)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return t&&null===t.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",r.correlationId):t&&t.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",r.correlationId),r.postLogoutRedirectUri=ye.getAbsoluteUrl(t.postLogoutRedirectUri,Ie.getCurrentUri())):null===this.config.auth.postLogoutRedirectUri?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",r.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",r.correlationId),r.postLogoutRedirectUri=ye.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Ie.getCurrentUri())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",r.correlationId),r.postLogoutRedirectUri=ye.getAbsoluteUrl(Ie.getCurrentUri(),Ie.getCurrentUri())),r},e.prototype.getLogoutHintFromIdTokenClaims=function(t){var r=t.idTokenClaims;if(r){if(r.login_hint)return r.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null},e.prototype.createAuthCodeClient=function(t,r,i){return L(this,void 0,void 0,function(){var s;return x(this,function(c){switch(c.label){case 0:return[4,this.getClientConfiguration(t,r,i)];case 1:return s=c.sent(),[2,new Cr(s)]}})})},e.prototype.getClientConfiguration=function(t,r,i){return L(this,void 0,void 0,function(){var s;return x(this,function(c){switch(c.label){case 0:return this.logger.verbose("getClientConfiguration called",this.correlationId),[4,this.getDiscoveredAuthority(r,i)];case 1:return s=c.sent(),[2,{authOptions:{clientId:this.config.auth.clientId,authority:s,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled,logLevel:this.config.system.loggerOptions.logLevel,correlationId:this.correlationId},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:"msal.js.browser",version:Pt,cpu:y.EMPTY_STRING,os:y.EMPTY_STRING},telemetry:this.config.telemetry}]}})})},e.prototype.validateAndExtractStateFromHash=function(t,r,i){if(this.logger.verbose("validateAndExtractStateFromHash called",i),!t.state)throw Q.createHashDoesNotContainStateError();var s=vr.extractBrowserRequestState(this.browserCrypto,t.state);if(!s)throw Q.createUnableToParseStateError();if(s.interactionType!==r)throw Q.createStateInteractionTypeMismatchError();return this.logger.verbose("Returning state from hash",i),t.state},e.prototype.getDiscoveredAuthority=function(t,r){return L(this,void 0,void 0,function(){var i,s,l;return x(this,function(h){switch(h.label){case 0:return this.logger.verbose("getDiscoveredAuthority called",this.correlationId),i=this.performanceClient.startMeasurement(fe.StandardInteractionClientGetDiscoveredAuthority,this.correlationId),s={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata},l=qt.generateAuthority(t||this.config.auth.authority,r||this.config.auth.azureCloudOptions),this.logger.verbose("Creating discovered authority with configured authority",this.correlationId),[4,zt.createDiscoveredInstance(l,this.config.system.networkClient,this.browserStorage,s).then(function(p){return i.endMeasurement({success:!0}),p}).catch(function(p){throw i.endMeasurement({success:!1}),p})];case 1:return[2,h.sent()]}})})},e.prototype.initializeAuthorizationRequest=function(t,r){return L(this,void 0,void 0,function(){var i,c,l,h,p,v;return x(this,function(T){switch(T.label){case 0:return this.logger.verbose("initializeAuthorizationRequest called",this.correlationId),i=this.getRedirectUri(t.redirectUri),c=at.setRequestState(this.browserCrypto,t&&t.state||y.EMPTY_STRING,{interactionType:r}),h=[{}],[4,this.initializeBaseRequest(t)];case 1:return l=G.apply(void 0,[G.apply(void 0,h.concat([T.sent()])),{redirectUri:i,state:c,nonce:t.nonce||this.browserCrypto.createNewGuid(),responseMode:lt.FRAGMENT}]),(p=t.account||this.browserStorage.getActiveAccount())&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii("Setting validated request account: "+p.homeAccountId,this.correlationId),l.account=p),J.isEmpty(l.loginHint)&&!p&&(v=this.browserStorage.getLegacyLoginHint())&&(l.loginHint=v),[2,l]}})})},e}(Tr),wt=function(){function n(e,t){this.browserStorage=e,this.logger=t,this.unloadWindow=this.unloadWindow.bind(this)}return n.prototype.openPopup=function(e,t){try{var r=void 0;if(t.popup?(r=t.popup,this.logger.verbosePii("Navigating popup window to: "+e),r.location.assign(e)):void 0===t.popup&&(this.logger.verbosePii("Opening popup window to: "+e),r=n.openSizedPopup(e,t.popupName,t.popupWindowAttributes,this.logger)),!r)throw Q.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(i){throw this.logger.error("error opening popup "+i.message),this.browserStorage.setInteractionInProgress(!1),Q.createPopupWindowError(i.toString())}},n.openSizedPopup=function(e,t,r,i){var s,c,l,h,p=window.screenLeft?window.screenLeft:window.screenX,v=window.screenTop?window.screenTop:window.screenY,T=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,R=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,V=null===(s=r.popupSize)||void 0===s?void 0:s.width,$=null===(c=r.popupSize)||void 0===c?void 0:c.height,le=null===(l=r.popupPosition)||void 0===l?void 0:l.top,oe=null===(h=r.popupPosition)||void 0===h?void 0:h.left;return(!V||V<0||V>T)&&(i.verbose("Default popup window width used. Window width not configured or invalid."),V=483),(!$||$<0||$>R)&&(i.verbose("Default popup window height used. Window height not configured or invalid."),$=600),(!le||le<0||le>R)&&(i.verbose("Default popup window top position used. Window top not configured or invalid."),le=Math.max(0,R/2-300+v)),(!oe||oe<0||oe>T)&&(i.verbose("Default popup window left position used. Window left not configured or invalid."),oe=Math.max(0,T/2-241.5+p)),window.open(e,t,"width="+V+", height="+$+", top="+le+", left="+oe+", scrollbars=yes")},n.prototype.unloadWindow=function(e){this.browserStorage.cleanRequestByInteractionType(X.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()},n.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)},n.prototype.monitorPopupForSameOrigin=function(e){var t=this;return new Promise(function(r,i){var s=setInterval(function(){if(e.closed)return t.cleanPopup(),clearInterval(s),void i(Q.createUserCancelledError());var c=y.EMPTY_STRING;try{c=e.location.href}catch(l){}J.isEmpty(c)||"about:blank"===c||(clearInterval(s),r())},50)})},n.generatePopupName=function(e,t,r,i){return"msal."+e+"."+t.join("-")+"."+r+"."+i},n.generateLogoutPopupName=function(e,t){return"msal."+e+"."+(t.account&&t.account.homeAccountId)+"."+t.correlationId},n}(),ir=function(){function n(e,t,r,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.browserRequestLogger=i}return n.prototype.handleCodeResponseFromHash=function(e,t,r,i){return L(this,void 0,void 0,function(){var s,c,l;return x(this,function(h){if(this.browserRequestLogger.verbose("InteractionHandler.handleCodeResponse called"),J.isEmpty(e))throw Q.createEmptyHashError(e);if(s=this.browserStorage.generateStateKey(t),!(c=this.browserStorage.getTemporaryCache(s)))throw ee.createStateNotFoundError("Cached State");try{l=this.authModule.handleFragmentResponse(e,c)}catch(p){throw p instanceof pt&&p.subError===j_userCancelledError_code?Q.createUserCancelledError():p}return[2,this.handleCodeResponseFromServer(l,t,r,i)]})})},n.prototype.handleCodeResponseFromServer=function(e,t,r,i,s){return void 0===s&&(s=!0),L(this,void 0,void 0,function(){var c,l,h,p,v,T;return x(this,function(R){switch(R.label){case 0:if(this.browserRequestLogger.trace("InteractionHandler.handleCodeResponseFromServer called"),c=this.browserStorage.generateStateKey(t),!(l=this.browserStorage.getTemporaryCache(c)))throw ee.createStateNotFoundError("Cached State");return h=this.browserStorage.generateNonceKey(l),p=this.browserStorage.getTemporaryCache(h),this.authCodeRequest.code=e.code,e.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(e.cloud_instance_host_name,r,i)]:[3,2];case 1:R.sent(),R.label=2;case 2:return s&&(e.nonce=p||void 0),e.state=l,e.client_info?this.authCodeRequest.clientInfo=e.client_info:(v=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=v),[4,this.authModule.acquireToken(this.authCodeRequest,e)];case 3:return T=R.sent(),this.browserStorage.cleanRequestByState(t),[2,T]}})})},n.prototype.updateTokenEndpointAuthority=function(e,t,r){return L(this,void 0,void 0,function(){var s;return x(this,function(c){switch(c.label){case 0:return[4,zt.createDiscoveredInstance("https://"+e+"/"+t.tenant+"/",r,this.browserStorage,t.options)];case 1:return s=c.sent(),this.authModule.updateAuthority(s),[2]}})})},n.prototype.checkCcsCredentials=function(){var e=this.browserStorage.getTemporaryCache(_e.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch(t){this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii("Cache credential could not be parsed: "+e)}return null},n}(),fn=function(n){function e(t,r,i,s){var c=n.call(this,t,r,i,s)||this;return c.popupUtils=new wt(r,s),c}return te(e,n),e.prototype.initiateAuthRequest=function(t,r){if(J.isEmpty(t))throw this.browserRequestLogger.error("Navigate url is empty"),Q.createEmptyNavigationUriError();return this.browserRequestLogger.infoPii("Navigate to: "+t),this.popupUtils.openPopup(t,r)},e.prototype.monitorPopupForHash=function(t){var r=this;return this.popupUtils.monitorPopupForSameOrigin(t).then(function(){var i=t.location.hash;if(Ie.clearHash(t),r.popupUtils.cleanPopup(t),!i)throw Q.createEmptyHashError(t.location.href);if(ye.hashContainsKnownProperties(i))return i;throw Q.createHashDoesNotContainKnownPropertiesError()})},e}(ir),gt=(()=>{return(n=gt||(gt={})).USER_INTERACTION_REQUIRED="USER_INTERACTION_REQUIRED",n.USER_CANCEL="USER_CANCEL",n.NO_NETWORK="NO_NETWORK",n.TRANSIENT_ERROR="TRANSIENT_ERROR",n.PERSISTENT_ERROR="PERSISTENT_ERROR",gt;var n})(),or_extensionError_code="ContentError",or_userSwitch_code="user_switch",or_userSwitch_desc="User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again.",rt=function(n){function e(t,r,i){var s=n.call(this,t,r)||this;return Object.setPrototypeOf(s,e.prototype),s.name="NativeAuthError",s.ext=i,s}return te(e,n),e.prototype.isFatal=function(){return!(!this.ext||!this.ext.status||this.ext.status!==gt.PERSISTENT_ERROR)||this.errorCode===or_extensionError_code},e.createError=function(t,r,i){if(i&&i.status)switch(i.status){case gt.USER_INTERACTION_REQUIRED:return new ct(t,r);case gt.USER_CANCEL:return Q.createUserCancelledError();case gt.NO_NETWORK:return Q.createNoNetworkConnectivityError()}return new e(t,r,i)},e.createUserSwitchError=function(){return new e(or_userSwitch_code,or_userSwitch_desc)},e}(ae),It=function(n){function e(t,r,i,s,c,l,h,p,v,T,R){var V=n.call(this,t,r,i,s,c,l,p,v,R)||this;return V.apiId=h,V.accountId=T,V.nativeMessageHandler=v,V}return te(e,n),e.prototype.acquireToken=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l,h;return x(this,function(p){switch(p.label){case 0:return this.logger.trace("NativeInteractionClient - acquireToken called."),r=this.performanceClient.startMeasurement(fe.NativeInteractionClientAcquireToken,t.correlationId),[4,this.initializeNativeRequest(t)];case 1:return i=p.sent(),s={method:et.GetToken,request:i},c=Ye.nowSeconds(),[4,this.nativeMessageHandler.sendMessage(s)];case 2:return l=p.sent(),h=this.validateNativeResponse(l),[2,this.handleNativeResponse(h,i,c).then(function(v){return r.endMeasurement({success:!0,isNativeBroker:!0}),v}).catch(function(v){throw r.endMeasurement({success:!1,isNativeBroker:!0}),v})]}})})},e.prototype.acquireTokenRedirect=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l,h;return x(this,function(p){switch(p.label){case 0:return this.logger.trace("NativeInteractionClient - acquireTokenRedirect called."),[4,this.initializeNativeRequest(t)];case 1:r=p.sent(),i={method:et.GetToken,request:r},p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.nativeMessageHandler.sendMessage(i)];case 3:return s=p.sent(),this.validateNativeResponse(s),[3,5];case 4:if((c=p.sent())instanceof rt&&c.isFatal())throw c;return[3,5];case 5:return this.browserStorage.setTemporaryCache(_e.NATIVE_REQUEST,JSON.stringify(r),!0),l={apiId:Se.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},h=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(t.redirectUri),[4,this.navigationClient.navigateExternal(h,l)];case 6:return p.sent(),[2]}})})},e.prototype.handleRedirectPromise=function(){return L(this,void 0,void 0,function(){var t,r,i,s,c,l;return x(this,function(h){switch(h.label){case 0:if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(t=this.browserStorage.getCachedNativeRequest()))return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),[2,null];this.browserStorage.removeItem(this.browserStorage.generateCacheKey(_e.NATIVE_REQUEST)),r={method:et.GetToken,request:t},i=Ye.nowSeconds(),h.label=1;case 1:return h.trys.push([1,3,,4]),this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker."),[4,this.nativeMessageHandler.sendMessage(r)];case 2:return s=h.sent(),this.validateNativeResponse(s),c=this.handleNativeResponse(s,t,i),this.browserStorage.setInteractionInProgress(!1),[2,c];case 3:throw l=h.sent(),this.browserStorage.setInteractionInProgress(!1),l;case 4:return[2]}})})},e.prototype.logout=function(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")},e.prototype.handleNativeResponse=function(t,r,i){return L(this,void 0,void 0,function(){var s,c,l,h,p,v,T,R,V,$,le,Ee,Ke=this;return x(this,function(Qe){switch(Qe.label){case 0:if(this.logger.trace("NativeInteractionClient - handleNativeResponse called."),t.account.id!==r.accountId)throw rt.createUserSwitchError();return s=new st(t.id_token||y.EMPTY_STRING,this.browserCrypto),[4,this.getDiscoveredAuthority(r.authority)];case 1:return c=Qe.sent(),l=c.getPreferredCache(),h=De.generateHomeAccountId(t.client_info||y.EMPTY_STRING,tt.Default,this.logger,this.browserCrypto,s),p=De.createAccount(t.client_info,h,s,void 0,void 0,void 0,void 0,l,t.account.id),this.browserStorage.setAccount(p),v=Ge.fromString(t.scopes?t.scopes:r.scopes),R=(T=t.account.properties||{}).UID||s.claims.oid||s.claims.sub||y.EMPTY_STRING,V=T.TenantId||s.claims.tid||y.EMPTY_STRING,le=P.BEARER,r.token_type===P.POP?[3,2]:[3,4];case 2:return le=P.POP,t.shr?(this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),$=t.shr,[3,5]):[4,new Tt(this.browserCrypto).signPopToken(t.access_token,{resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,shrNonce:r.shrNonce})];case 3:return $=Qe.sent(),[3,5];case 4:$=t.access_token,Qe.label=5;case 5:return Ee={authority:c.canonicalAuthority,uniqueId:R,tenantId:V,scopes:v.asArray(),account:p.getAccountInfo(),idToken:t.id_token,idTokenClaims:s.claims,accessToken:$,fromCache:!1,expiresOn:new Date(1e3*Number(i+t.expires_in)),tokenType:le,correlationId:this.correlationId,state:t.state,fromNativeBroker:!0},this.browserStorage.removeAccountContext(p).catch(function(vt){Ke.logger.error("Error occurred while removing account context from browser storage. "+vt)}),[2,Ee]}})})},e.prototype.validateNativeResponse=function(t){if(t.hasOwnProperty("access_token")&&t.hasOwnProperty("id_token")&&t.hasOwnProperty("client_info")&&t.hasOwnProperty("account")&&t.hasOwnProperty("scopes")&&t.hasOwnProperty("expires_in"))return t;throw rt.createUnexpectedError("Response missing expected properties.")},e.prototype.initializeNativeRequest=function(t){return L(this,void 0,void 0,function(){var i,c,l,h,p,v,T,R;return x(this,function(V){switch(V.label){case 0:if(this.logger.trace("NativeInteractionClient - initializeNativeRequest called"),(i=new ye(t.authority||this.config.auth.authority)).validateAsUri(),(c=new Ge(t&&t.scopes||[])).appendScopes(ve),t.prompt)switch(t.prompt){case Re.NONE:case Re.CONSENT:this.logger.trace("initializeNativeRequest: prompt is compatible with native flow");break;default:throw this.logger.trace("initializeNativeRequest: prompt = "+t.prompt+" is not compatible with native flow"),Q.createNativePromptParameterNotSupportedError()}return l=!(!t.extraQueryParameters||!t.extraQueryParameters.instance_aware),h=G(G({},t),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:i.urlString,scopes:c.printScopes(),redirectUri:this.getRedirectUri(t.redirectUri),correlationId:this.correlationId,instance_aware:l,token_type:t.authenticationScheme,windowTitleSubstring:document.title,extraParameters:G(G({},t.extraQueryParameters),t.tokenQueryParameters),extendedExpiryToken:!1}),t.authenticationScheme!==P.POP?[3,3]:(p={resourceRequestUri:t.resourceRequestUri,resourceRequestMethod:t.resourceRequestMethod,shrClaims:t.shrClaims,shrNonce:t.shrNonce},[4,(v=new Tt(this.browserCrypto)).generateCnf(p)]);case 1:return T=V.sent(),R=h,[4,v.generateCnfHash(T)];case 2:R.req_cnf=V.sent(),V.label=3;case 3:return(this.apiId===Se.ssoSilent||this.apiId===Se.acquireTokenSilent_silentFlow)&&(h.prompt=Re.NONE),[2,h]}})})},e}(Tr),mt=function(){function n(e,t,r){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=r,this.resolvers=new Map,this.handshakeResolvers=new Map,this.responseId=0,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this)}return n.prototype.sendMessage=function(e){return L(this,void 0,void 0,function(){var t,r=this;return x(this,function(i){return this.logger.trace("NativeMessageHandler - sendMessage called."),t={channel:xt_CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:e},this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii("NativeMessageHandler - Sending request to browser extension: "+JSON.stringify(t)),this.messageChannel.port1.postMessage(t),[2,new Promise(function(s,c){r.resolvers.set(t.responseId,{resolve:s,reject:c})})]})})},n.createProvider=function(e,t){return L(this,void 0,void 0,function(){var r,i;return x(this,function(s){switch(s.label){case 0:e.trace("NativeMessageHandler - createProvider called."),s.label=1;case 1:return s.trys.push([1,3,,5]),[4,(r=new n(e,t,"ppnbnpeolgkicgegkbkbjmhlideopiji")).sendHandshakeRequest()];case 2:return s.sent(),[2,r];case 3:return s.sent(),[4,(i=new n(e,t)).sendHandshakeRequest()];case 4:return s.sent(),[2,i];case 5:return[2]}})})},n.prototype.sendHandshakeRequest=function(){return L(this,void 0,void 0,function(){var e,t=this;return x(this,function(r){return this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1),e={channel:xt_CHANNEL_ID,extensionId:this.extensionId,responseId:this.responseId++,body:{method:et.HandshakeRequest}},this.messageChannel.port1.onmessage=function(i){t.onChannelMessage(i)},window.postMessage(e,window.origin,[this.messageChannel.port2]),[2,new Promise(function(i,s){t.handshakeResolvers.set(e.responseId,{resolve:i,reject:s}),t.timeoutId=window.setTimeout(function(){window.removeEventListener("message",t.windowListener,!1),t.messageChannel.port1.close(),t.messageChannel.port2.close(),s(Q.createNativeHandshakeTimeoutError()),t.handshakeResolvers.delete(e.responseId)},t.handshakeTimeoutMs)})]})})},n.prototype.onWindowMessage=function(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source===window){var t=e.data;if(t.channel&&t.channel===xt_CHANNEL_ID&&(!t.extensionId||t.extensionId===this.extensionId)&&t.body.method===et.HandshakeRequest){this.logger.verbose(t.extensionId?"Extension with id: "+t.extensionId+" not installed":"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1);var r=this.handshakeResolvers.get(t.responseId);r&&r.reject(Q.createNativeExtensionNotInstalledError())}}},n.prototype.onChannelMessage=function(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");var t=e.data,r=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{var s=t.body.method;if(s===et.Response){if(!r)return;var c=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii("NativeMessageHandler - Received response from browser extension: "+JSON.stringify(c)),"Success"!==c.status)r.reject(rt.createError(c.code,c.description,c.ext));else{if(!c.result)throw ae.createUnexpectedError("Event does not contain result.");c.result.code&&c.result.description?r.reject(rt.createError(c.result.code,c.result.description,c.result.ext)):r.resolve(c.result)}this.resolvers.delete(t.responseId)}else if(s===et.HandshakeResponse){if(!i)return;clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.logger.verbose("NativeMessageHandler - Received HandshakeResponse from extension: "+this.extensionId),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(l){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii("Error parsing response from WAM Extension: "+l.toString()),this.logger.errorPii("Unable to parse "+e),r?r.reject(l):i&&i.reject(l)}},n.isNativeAvailable=function(e,t,r,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case P.BEARER:case P.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0},n}(),gn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return te(e,n),e.prototype.acquireToken=function(t){try{var r=wt.generatePopupName(this.config.auth.clientId,t.scopes||ve,t.authority||this.config.auth.authority,this.correlationId),i=t.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(t,r,i);this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");var s=wt.openSizedPopup("about:blank",r,i,this.logger);return this.acquireTokenPopupAsync(t,r,i,s)}catch(c){return Promise.reject(c)}},e.prototype.logout=function(t){try{this.logger.verbose("logoutPopup called");var r=this.initializeLogoutRequest(t),i=wt.generateLogoutPopupName(this.config.auth.clientId,r),s=t&&t.authority,c=t&&t.mainWindowRedirectUri,l=(null==t?void 0:t.popupWindowAttributes)||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(r,i,l,s,void 0,c);this.logger.verbose("asyncPopup set to false, opening popup");var h=wt.openSizedPopup("about:blank",i,l,this.logger);return this.logoutPopupAsync(r,i,l,s,h,c)}catch(p){return Promise.reject(p)}},e.prototype.acquireTokenPopupAsync=function(t,r,i,s){return L(this,void 0,void 0,function(){var c,l,h,p,v,T,R,V,le,oe,ie,be,Ee,Ke,vt,Pn=this;return x(this,function(it){switch(it.label){case 0:return this.logger.verbose("acquireTokenPopupAsync called"),c=this.initializeServerTelemetryManager(Se.acquireTokenPopup),[4,this.initializeAuthorizationRequest(t,X.Popup)];case 1:l=it.sent(),this.browserStorage.updateCacheEntries(l.state,l.nonce,l.authority,l.loginHint||y.EMPTY_STRING,l.account||null),it.label=2;case 2:return it.trys.push([2,8,,9]),[4,this.initializeAuthorizationCodeRequest(l)];case 3:return h=it.sent(),[4,this.createAuthCodeClient(c,l.authority,l.azureCloudOptions)];case 4:return p=it.sent(),this.logger.verbose("Auth code client created"),v=mt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme),T=void 0,v&&(T=this.performanceClient.startMeasurement(fe.FetchAccountIdWithNativeBroker,t.correlationId)),[4,p.getAuthCodeUrl(G(G({},l),{nativeBroker:v}))];case 5:return R=it.sent(),V=new fn(p,this.browserStorage,h,this.logger),le=V.initiateAuthRequest(R,{popup:s,popupName:r,popupWindowAttributes:i}),this.eventHandler.emitEvent(he.POPUP_OPENED,X.Popup,{popupWindow:le},null),[4,V.monitorPopupForHash(le)];case 6:if(oe=it.sent(),ie=ye.getDeserializedHash(oe),be=this.validateAndExtractStateFromHash(ie,X.Popup,l.correlationId),Gt.removeThrottle(this.browserStorage,this.config.auth.clientId,h),ie.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),T&&T.endMeasurement({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw Q.createNativeConnectionNotEstablishedError();return Ee=new It(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,ie.accountId,l.correlationId),Ke=at.parseRequestState(this.browserCrypto,be).userRequestState,[2,Ee.acquireToken(G(G({},l),{state:Ke,prompt:void 0})).finally(function(){Pn.browserStorage.cleanRequestByState(be)})]}return[4,V.handleCodeResponseFromHash(oe,be,p.authority,this.networkClient)];case 7:return[2,it.sent()];case 8:throw vt=it.sent(),s&&s.close(),vt instanceof ae&&vt.setCorrelationId(this.correlationId),c.cacheFailedRequest(vt),this.browserStorage.cleanRequestByState(l.state),vt;case 9:return[2]}})})},e.prototype.logoutPopupAsync=function(t,r,i,s,c,l){return L(this,void 0,void 0,function(){var h,p,v,T,R,V,$,le,oe;return x(this,function(ie){switch(ie.label){case 0:this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(he.LOGOUT_START,X.Popup,t),h=this.initializeServerTelemetryManager(Se.logoutPopup),ie.label=1;case 1:return ie.trys.push([1,8,,9]),[4,this.clearCacheOnLogout(t.account)];case 2:return ie.sent(),[4,this.createAuthCodeClient(h,s)];case 3:p=ie.sent(),this.logger.verbose("Auth code client created"),v=p.getLogoutUri(t),this.eventHandler.emitEvent(he.LOGOUT_SUCCESS,X.Popup,t),T=new wt(this.browserStorage,this.logger),R=T.openPopup(v,{popupName:r,popupWindowAttributes:i,popup:c}),this.eventHandler.emitEvent(he.POPUP_OPENED,X.Popup,{popupWindow:R},null),ie.label=4;case 4:return ie.trys.push([4,6,,7]),[4,T.monitorPopupForSameOrigin(R)];case 5:return ie.sent(),this.logger.verbose("Popup successfully redirected to postLogoutRedirectUri"),[3,7];case 6:return V=ie.sent(),this.logger.verbose("Error occurred while monitoring popup for same origin. Session on server may remain active. Error: "+V),[3,7];case 7:return T.cleanPopup(R),l?($={apiId:Se.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},le=ye.getAbsoluteUrl(l,Ie.getCurrentUri()),this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii("Redirecting main window to: "+le),this.navigationClient.navigateInternal(le,$)):this.logger.verbose("No main window navigation requested"),[3,9];case 8:throw oe=ie.sent(),c&&c.close(),oe instanceof ae&&oe.setCorrelationId(this.correlationId),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(he.LOGOUT_FAILURE,X.Popup,null,oe),this.eventHandler.emitEvent(he.LOGOUT_END,X.Popup),h.cacheFailedRequest(oe),oe;case 9:return this.eventHandler.emitEvent(he.LOGOUT_END,X.Popup),[2]}})})},e}(St),Sr=function(n){function e(t,r,i,s,c){var l=n.call(this,t,r,i,s)||this;return l.browserCrypto=c,l}return te(e,n),e.prototype.initiateAuthRequest=function(t,r){return L(this,void 0,void 0,function(){var i;return x(this,function(c){switch(c.label){case 0:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest called"),J.isEmpty(t)?[3,7]:(r.redirectStartPage&&(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(_e.ORIGIN_URI,r.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(_e.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest,this.browserCrypto),this.browserRequestLogger.infoPii("RedirectHandler.initiateAuthRequest: Navigate to: "+t),i={apiId:Se.acquireTokenRedirect,timeout:r.redirectTimeout,noHistory:!1},"function"!=typeof r.onRedirectNavigate?[3,4]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),!1===r.onRedirectNavigate(t)?[3,2]:(this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),[4,r.navigationClient.navigateExternal(t,i)])));case 1:case 5:return c.sent(),[2];case 2:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation"),[2];case 3:return[3,6];case 4:return this.browserRequestLogger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),[4,r.navigationClient.navigateExternal(t,i)];case 6:return[3,8];case 7:throw this.browserRequestLogger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Q.createEmptyNavigationUriError();case 8:return[2]}})})},e.prototype.handleCodeResponseFromHash=function(t,r,i,s){return L(this,void 0,void 0,function(){var c,l,h,p,v,T,R;return x(this,function(V){switch(V.label){case 0:if(this.browserRequestLogger.verbose("RedirectHandler.handleCodeResponse called"),J.isEmpty(t))throw Q.createEmptyHashError(t);if(this.browserStorage.setInteractionInProgress(!1),c=this.browserStorage.generateStateKey(r),!(l=this.browserStorage.getTemporaryCache(c)))throw ee.createStateNotFoundError("Cached State");try{h=this.authModule.handleFragmentResponse(t,l)}catch($){throw $ instanceof pt&&$.subError===j_userCancelledError_code?Q.createUserCancelledError():$}return p=this.browserStorage.generateNonceKey(l),v=this.browserStorage.getTemporaryCache(p),this.authCodeRequest.code=h.code,h.cloud_instance_host_name?[4,this.updateTokenEndpointAuthority(h.cloud_instance_host_name,i,s)]:[3,2];case 1:V.sent(),V.label=2;case 2:return h.nonce=v||void 0,h.state=l,h.client_info?this.authCodeRequest.clientInfo=h.client_info:(T=this.checkCcsCredentials())&&(this.authCodeRequest.ccsCredential=T),[4,this.authModule.acquireToken(this.authCodeRequest,h)];case 3:return R=V.sent(),this.browserStorage.cleanRequestByState(r),[2,R]}})})},e}(ir),mn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return te(e,n),e.prototype.acquireToken=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l,h,p,v,T,R=this;return x(this,function(V){switch(V.label){case 0:return[4,this.initializeAuthorizationRequest(t,X.Redirect)];case 1:r=V.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||y.EMPTY_STRING,r.account||null),i=this.initializeServerTelemetryManager(Se.acquireTokenRedirect),s=function($){$.persisted&&(R.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),R.browserStorage.cleanRequestByState(r.state))},V.label=2;case 2:return V.trys.push([2,7,,8]),[4,this.initializeAuthorizationCodeRequest(r)];case 3:return c=V.sent(),[4,this.createAuthCodeClient(i,r.authority,r.azureCloudOptions)];case 4:return l=V.sent(),this.logger.verbose("Auth code client created"),h=new Sr(l,this.browserStorage,c,this.logger,this.browserCrypto),[4,l.getAuthCodeUrl(G(G({},r),{nativeBroker:mt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}))];case 5:return p=V.sent(),v=this.getRedirectStartPage(t.redirectStartPage),this.logger.verbosePii("Redirect start page: "+v),window.addEventListener("pageshow",s),[4,h.initiateAuthRequest(p,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:v,onRedirectNavigate:t.onRedirectNavigate})];case 6:return[2,V.sent()];case 7:throw(T=V.sent())instanceof ae&&T.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",s),i.cacheFailedRequest(T),this.browserStorage.cleanRequestByState(r.state),T;case 8:return[2]}})})},e.prototype.handleRedirectPromise=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l,h,p,v,T,R,V,$;return x(this,function(le){switch(le.label){case 0:r=this.initializeServerTelemetryManager(Se.handleRedirectPromise),le.label=1;case 1:if(le.trys.push([1,10,,11]),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null];if(!(i=this.getRedirectResponseHash(t||window.location.hash)))return this.logger.info("handleRedirectPromise did not detect a response hash as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(X.Redirect),[2,null];s=void 0;try{c=ye.getDeserializedHash(i),s=this.validateAndExtractStateFromHash(c,X.Redirect),this.logger.verbose("State extracted from hash")}catch(oe){return this.logger.info("handleRedirectPromise was unable to extract state due to: "+oe),this.browserStorage.cleanRequestByInteractionType(X.Redirect),[2,null]}return l=this.browserStorage.getTemporaryCache(_e.ORIGIN_URI,!0)||y.EMPTY_STRING,h=ye.removeHashFromUrl(l),p=ye.removeHashFromUrl(window.location.href),h===p&&this.config.auth.navigateToLoginRequestUrl?(this.logger.verbose("Current page is loginRequestUrl, handling hash"),[4,this.handleHash(i,s,r)]):[3,3];case 2:return v=le.sent(),l.indexOf("#")>-1&&Ie.replaceHash(l),[2,v];case 3:return this.config.auth.navigateToLoginRequestUrl?[3,4]:(this.logger.verbose("NavigateToLoginRequestUrl set to false, handling hash"),[2,this.handleHash(i,s,r)]);case 4:return!Ie.isInIframe()||this.config.system.allowRedirectInIframe?(this.browserStorage.setTemporaryCache(_e.URL_HASH,i,!0),T={apiId:Se.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},R=!0,l&&"null"!==l?[3,6]:(V=Ie.getHomepage(),this.browserStorage.setTemporaryCache(_e.ORIGIN_URI,V,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),[4,this.navigationClient.navigateInternal(V,T)])):[3,9];case 5:return R=le.sent(),[3,8];case 6:return this.logger.verbose("Navigating to loginRequestUrl: "+l),[4,this.navigationClient.navigateInternal(l,T)];case 7:R=le.sent(),le.label=8;case 8:if(!R)return[2,this.handleHash(i,s,r)];le.label=9;case 9:return[2,null];case 10:throw($=le.sent())instanceof ae&&$.setCorrelationId(this.correlationId),r.cacheFailedRequest($),this.browserStorage.cleanRequestByInteractionType(X.Redirect),$;case 11:return[2]}})})},e.prototype.getRedirectResponseHash=function(t){if(this.logger.verbose("getRedirectResponseHash called"),ye.hashContainsKnownProperties(t))return Ie.clearHash(window),this.logger.verbose("Hash contains known properties, returning response hash"),t;var i=this.browserStorage.getTemporaryCache(_e.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(_e.URL_HASH)),this.logger.verbose("Hash does not contain known properties, returning cached hash"),i},e.prototype.handleHash=function(t,r,i){return L(this,void 0,void 0,function(){var s,c,l,h,p,v,R=this;return x(this,function(V){switch(V.label){case 0:if(s=this.browserStorage.getCachedRequest(r,this.browserCrypto),this.logger.verbose("handleHash called, retrieved cached request"),(c=ye.getDeserializedHash(t)).accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Q.createNativeConnectionNotEstablishedError();return l=new It(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,c.accountId,s.correlationId),h=at.parseRequestState(this.browserCrypto,r).userRequestState,[2,l.acquireToken(G(G({},s),{state:h,prompt:void 0})).finally(function(){R.browserStorage.cleanRequestByState(r)})]}if(!(p=this.browserStorage.getCachedAuthority(r)))throw Q.createNoCachedAuthorityError();return[4,this.createAuthCodeClient(i,p)];case 1:return v=V.sent(),this.logger.verbose("Auth code client created"),Gt.removeThrottle(this.browserStorage,this.config.auth.clientId,s),[4,new Sr(v,this.browserStorage,s,this.logger,this.browserCrypto).handleCodeResponseFromHash(t,r,v.authority,this.networkClient)];case 2:return[2,V.sent()]}})})},e.prototype.logout=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l,p;return x(this,function(v){switch(v.label){case 0:this.logger.verbose("logoutRedirect called"),r=this.initializeLogoutRequest(t),i=this.initializeServerTelemetryManager(Se.logout),v.label=1;case 1:return v.trys.push([1,10,,11]),this.eventHandler.emitEvent(he.LOGOUT_START,X.Redirect,t),[4,this.clearCacheOnLogout(r.account)];case 2:return v.sent(),s={apiId:Se.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},[4,this.createAuthCodeClient(i,t&&t.authority)];case 3:return c=v.sent(),this.logger.verbose("Auth code client created"),l=c.getLogoutUri(r),this.eventHandler.emitEvent(he.LOGOUT_SUCCESS,X.Redirect,r),t&&"function"==typeof t.onRedirectNavigate?!1===t.onRedirectNavigate(l)?[3,5]:(this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(l,s)]):[3,7];case 4:return v.sent(),[2];case 5:this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation"),v.label=6;case 6:return[3,9];case 7:return this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),[4,this.navigationClient.navigateExternal(l,s)];case 8:return v.sent(),[2];case 9:return[3,11];case 10:throw(p=v.sent())instanceof ae&&p.setCorrelationId(this.correlationId),i.cacheFailedRequest(p),this.eventHandler.emitEvent(he.LOGOUT_FAILURE,X.Redirect,null,p),this.eventHandler.emitEvent(he.LOGOUT_END,X.Redirect),p;case 11:return this.eventHandler.emitEvent(he.LOGOUT_END,X.Redirect),[2]}})})},e.prototype.getRedirectStartPage=function(t){var r=t||window.location.href;return ye.getAbsoluteUrl(r,Ie.getCurrentUri())},e}(St),wr=function(n){function e(t,r,i,s,c){var l=n.call(this,t,r,i,s)||this;return l.navigateFrameWait=c,l}return te(e,n),e.prototype.initiateAuthRequest=function(t){return L(this,void 0,void 0,function(){var r;return x(this,function(i){switch(i.label){case 0:if(J.isEmpty(t))throw this.browserRequestLogger.info("Navigate url is empty"),Q.createEmptyNavigationUriError();return this.navigateFrameWait?[4,this.loadFrame(t)]:[3,2];case 1:return r=i.sent(),[3,3];case 2:r=this.loadFrameSync(t),i.label=3;case 3:return[2,r]}})})},e.prototype.monitorIframeForHash=function(t,r){var i=this;return new Promise(function(s,c){r<6e3&&i.browserRequestLogger.warning("system.loadFrameTimeout or system.iframeHashTimeout set to lower ("+r+"ms) than the default (6000ms). This may result in timeouts.");var h=window.performance.now()+r,p=setInterval(function(){if(window.performance.now()>h)return i.removeHiddenIframe(t),clearInterval(p),void c(Q.createMonitorIframeTimeoutError());var v=y.EMPTY_STRING,T=t.contentWindow;try{v=T?T.location.href:y.EMPTY_STRING}catch(V){}if(!J.isEmpty(v)){var R=T?T.location.hash:y.EMPTY_STRING;if(ye.hashContainsKnownProperties(R))return i.removeHiddenIframe(t),clearInterval(p),void s(R)}},50)})},e.prototype.loadFrame=function(t){var r=this;return new Promise(function(i,s){var c=r.createHiddenIframe();setTimeout(function(){c?(c.src=t,i(c)):s("Unable to load iframe")},r.navigateFrameWait)})},e.prototype.loadFrameSync=function(t){var r=this.createHiddenIframe();return r.src=t,r},e.prototype.createHiddenIframe=function(){var t=document.createElement("iframe");return t.style.visibility="hidden",t.style.position="absolute",t.style.width=t.style.height="0",t.style.border="0",t.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(t),t},e.prototype.removeHiddenIframe=function(t){document.body===t.parentNode&&document.body.removeChild(t)},e}(ir),vn=function(n){function e(t,r,i,s,c,l,h,p,v,T){var R=n.call(this,t,r,i,s,c,l,p,v,T)||this;return R.apiId=h,R}return te(e,n),e.prototype.acquireToken=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l;return x(this,function(h){switch(h.label){case 0:if(this.logger.verbose("acquireTokenByIframe called"),r=this.performanceClient.startMeasurement(fe.SilentIframeClientAcquireToken,t.correlationId),J.isEmpty(t.loginHint)&&J.isEmpty(t.sid)&&(!t.account||J.isEmpty(t.account.username))&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request."),t.prompt&&t.prompt!==Re.NONE)throw r.endMeasurement({success:!1}),Q.createSilentPromptValueError(t.prompt);return[4,this.initializeAuthorizationRequest(G(G({},t),{prompt:Re.NONE}),X.Silent)];case 1:i=h.sent(),this.browserStorage.updateCacheEntries(i.state,i.nonce,i.authority,i.loginHint||y.EMPTY_STRING,i.account||null),s=this.initializeServerTelemetryManager(this.apiId),h.label=2;case 2:return h.trys.push([2,5,,6]),[4,this.createAuthCodeClient(s,i.authority,i.azureCloudOptions)];case 3:return c=h.sent(),this.logger.verbose("Auth code client created"),[4,this.silentTokenHelper(c,i).then(function(p){return r.endMeasurement({success:!0,fromCache:!1}),p})];case 4:return[2,h.sent()];case 5:throw(l=h.sent())instanceof ae&&l.setCorrelationId(this.correlationId),s.cacheFailedRequest(l),this.browserStorage.cleanRequestByState(i.state),r.endMeasurement({success:!1}),l;case 6:return[2]}})})},e.prototype.logout=function(){return Promise.reject(Q.createSilentLogoutUnsupportedError())},e.prototype.silentTokenHelper=function(t,r){return L(this,void 0,void 0,function(){var i,s,c,l,h,p,v,T,R,V=this;return x(this,function($){switch($.label){case 0:return[4,this.initializeAuthorizationCodeRequest(r)];case 1:return i=$.sent(),[4,t.getAuthCodeUrl(G(G({},r),{nativeBroker:mt.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,r.authenticationScheme)}))];case 2:return s=$.sent(),[4,(c=new wr(t,this.browserStorage,i,this.logger,this.config.system.navigateFrameWait)).initiateAuthRequest(s)];case 3:return l=$.sent(),[4,c.monitorIframeForHash(l,this.config.system.iframeHashTimeout)];case 4:if(h=$.sent(),p=ye.getDeserializedHash(h),v=this.validateAndExtractStateFromHash(p,X.Silent,i.correlationId),p.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw Q.createNativeConnectionNotEstablishedError();return T=new It(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,p.accountId,this.correlationId),R=at.parseRequestState(this.browserCrypto,v).userRequestState,[2,T.acquireToken(G(G({},r),{state:R,prompt:Re.NONE})).finally(function(){V.browserStorage.cleanRequestByState(v)})]}return[2,c.handleCodeResponseFromHash(h,v,t.authority,this.networkClient)]}})})},e}(St),Ir=function(n){function e(t){return n.call(this,t)||this}return U(e,n),e.prototype.acquireToken=function(t){return I(this,void 0,void 0,function(){var r,i,s;return D(this,function(c){switch(c.label){case 0:return r=Ye.nowSeconds(),[4,this.executeTokenRequest(t,this.authority)];case 1:return i=c.sent(),(s=new Wt(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin)).validateTokenResponse(i.body),[2,s.handleServerTokenResponse(i.body,this.authority,r,t,void 0,void 0,!0)]}})})},e.prototype.acquireTokenByRefreshToken=function(t){return I(this,void 0,void 0,function(){var s;return D(this,function(c){if(!t)throw we.createEmptyTokenRequestError();if(!t.account)throw ee.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(t.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(t,!0)]}catch(l){if(s=l instanceof pt&&"invalid_grant"===l.errorCode&&"client_mismatch"===l.subError,l instanceof ct&&l.errorCode===Jt_noTokensFoundError_code||s)return[2,this.acquireTokenWithCachedRefreshToken(t,!1)];throw l}return[2,this.acquireTokenWithCachedRefreshToken(t,!1)]})})},e.prototype.acquireTokenWithCachedRefreshToken=function(t,r){return I(this,void 0,void 0,function(){var i,s;return D(this,function(c){if(!(i=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,t.account,r)))throw ct.createNoTokensFoundError();return s=k(k({},t),{refreshToken:i.secret,authenticationScheme:t.authenticationScheme||P.BEARER,ccsCredential:{credential:t.account.homeAccountId,type:Fe.HOME_ACCOUNT_ID}}),[2,this.acquireToken(s)]})})},e.prototype.executeTokenRequest=function(t,r){return I(this,void 0,void 0,function(){var i,s,c,l,h;return D(this,function(p){switch(p.label){case 0:return[4,this.createTokenRequestBody(t)];case 1:return i=p.sent(),s=this.createTokenQueryParameters(t),c=this.createTokenRequestHeaders(t.ccsCredential),l={clientId:this.config.authOptions.clientId,authority:r.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid},h=ye.appendQueryString(r.tokenEndpoint,s),[2,this.executePostToTokenEndpoint(h,i,c,l)]}})})},e.prototype.createTokenQueryParameters=function(t){var r=new Ct;return t.tokenQueryParameters&&r.addExtraQueryParameters(t.tokenQueryParameters),r.createQueryString()},e.prototype.createTokenRequestBody=function(t){return I(this,void 0,void 0,function(){var r,i,s,l,h;return D(this,function(p){switch(p.label){case 0:return(r=new Ct).addClientId(this.config.authOptions.clientId),r.addScopes(t.scopes),r.addGrantType(ut.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&r.addServerTelemetry(this.serverTelemetryManager),i=t.correlationId||this.config.cryptoInterface.createNewGuid(),r.addCorrelationId(i),r.addRefreshToken(t.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r.addClientAssertion((s=this.config.clientCredentials.clientAssertion).assertion),r.addClientAssertionType(s.assertionType)),t.authenticationScheme!==P.POP?[3,2]:[4,new Tt(this.cryptoUtils).generateCnf(t)];case 1:return l=p.sent(),r.addPopToken(l),[3,3];case 2:if(t.authenticationScheme===P.SSH){if(!t.sshJwk)throw we.createMissingSshJwkError();r.addSshJwk(t.sshJwk)}p.label=3;case 3:if((!J.isEmptyObj(t.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(t.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&t.ccsCredential)switch(t.ccsCredential.type){case Fe.HOME_ACCOUNT_ID:try{h=Ot(t.ccsCredential.credential),r.addCcsOid(h)}catch(v){this.logger.verbose("Could not parse home account ID for CCS Header: "+v)}break;case Fe.UPN:r.addCcsUpn(t.ccsCredential.credential)}return[2,r.createQueryString()]}})})},e}(nr),En=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return te(e,n),e.prototype.acquireToken=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l,h=this;return x(this,function(p){switch(p.label){case 0:return i=[G({},t)],[4,this.initializeBaseRequest(t)];case 1:return r=G.apply(void 0,i.concat([p.sent()])),s=this.performanceClient.startMeasurement(fe.SilentRefreshClientAcquireToken,r.correlationId),c=this.initializeServerTelemetryManager(Se.acquireTokenSilent_silentFlow),[4,this.createRefreshTokenClient(c,r.authority,r.azureCloudOptions)];case 2:return l=p.sent(),this.logger.verbose("Refresh token client created"),[2,l.acquireTokenByRefreshToken(r).then(function(v){return s.endMeasurement({success:!0,fromCache:v.fromCache}),v}).catch(function(v){throw v instanceof ae&&v.setCorrelationId(h.correlationId),c.cacheFailedRequest(v),s.endMeasurement({success:!1}),v})]}})})},e.prototype.logout=function(){return Promise.reject(Q.createSilentLogoutUnsupportedError())},e.prototype.createRefreshTokenClient=function(t,r,i){return L(this,void 0,void 0,function(){var s;return x(this,function(c){switch(c.label){case 0:return[4,this.getClientConfiguration(t,r,i)];case 1:return s=c.sent(),[2,new Ir(s)]}})})},e}(St),_n=function(){function n(e,t,r,i){this.isBrowserEnvironment="undefined"!=typeof window,this.config=e,this.storage=t,this.logger=r,this.cryptoObj=i}return n.prototype.loadExternalTokens=function(e,t,r){if(this.logger.info("TokenCache - loadExternalTokens called"),!t.id_token)throw Q.createUnableToLoadTokenError("Please ensure server response includes id token.");if(e.account)this.loadIdToken(t.id_token,e.account.homeAccountId,e.account.environment,e.account.tenantId,r),this.loadAccessToken(e,t,e.account.homeAccountId,e.account.environment,e.account.tenantId,r);else{if(!e.authority)throw Q.createUnableToLoadTokenError("Please provide a request with an account or a request with authority.");var i=qt.generateAuthority(e.authority,e.azureCloudOptions),c=new qt(i,this.config.system.networkClient,this.storage,{protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata});if(r.clientInfo)this.logger.trace("TokenCache - homeAccountId from options"),this.loadIdToken(t.id_token,r.clientInfo,c.hostnameAndPort,c.tenant,r),this.loadAccessToken(e,t,r.clientInfo,c.hostnameAndPort,c.tenant,r);else{if(!t.client_info)throw Q.createUnableToLoadTokenError("Please provide clientInfo in the response or options.");this.logger.trace("TokenCache - homeAccountId from response"),this.loadIdToken(t.id_token,t.client_info,c.hostnameAndPort,c.tenant,r),this.loadAccessToken(e,t,t.client_info,c.hostnameAndPort,c.tenant,r)}}},n.prototype.loadIdToken=function(e,t,r,i,s){var c=Ft.createIdTokenEntity(t,r,e,this.config.auth.clientId,i),l=new st(e,this.cryptoObj),h=s.clientInfo?De.createAccount(s.clientInfo,t,l,void 0,void 0,void 0,void 0,r):De.createGenericAccount(t,l,void 0,void 0,void 0,void 0,r);if(!this.isBrowserEnvironment)throw Q.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading id token"),this.storage.setAccount(h),this.storage.setIdTokenCredential(c)},n.prototype.loadAccessToken=function(e,t,r,i,s,c){if(t.access_token){if(!t.expires_in)throw Q.createUnableToLoadTokenError("Please ensure server response includes expires_in value.");if(!c.extendedExpiresOn)throw Q.createUnableToLoadTokenError("Please provide an extendedExpiresOn value in the options.");var l=new Ge(e.scopes).printScopes(),v=Kt.createAccessTokenEntity(r,i,t.access_token,this.config.auth.clientId,s,l,t.expires_in,c.extendedExpiresOn,this.cryptoObj);if(!this.isBrowserEnvironment)throw Q.createUnableToLoadTokenError("loadExternalTokens is designed to work in browser environments only.");this.logger.verbose("TokenCache - loading access token"),this.storage.setAccessTokenCredential(v)}else this.logger.verbose("TokenCache - No access token provided for caching")},n}(),yn=function(n){function e(t){return n.call(this,t)||this}return U(e,n),e.prototype.acquireToken=function(t){return I(this,void 0,void 0,function(){var r;return D(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.acquireCachedToken(t)];case 1:return[2,s.sent()];case 2:if((r=s.sent())instanceof ee&&r.errorCode===Y_tokenRefreshRequired_code)return[2,new Ir(this.config).acquireTokenByRefreshToken(t)];throw r;case 3:return[2]}})})},e.prototype.acquireCachedToken=function(t){var r,i,s,c;return I(this,void 0,void 0,function(){var l,h;return D(this,function(p){switch(p.label){case 0:if(!t)throw we.createEmptyTokenRequestError();if(t.forceRefresh)throw null===(r=this.serverTelemetryManager)||void 0===r||r.setCacheOutcome(Ze.FORCE_REFRESH),this.logger.info("SilentFlowClient:acquireCachedToken - Skipping cache because forceRefresh is true."),ee.createRefreshRequiredError();if(!t.account)throw ee.createNoAccountInSilentRequestError();if(l=t.authority||this.authority.getPreferredCache(),!(h=this.cacheManager.readCacheRecord(t.account,this.config.authOptions.clientId,t,l)).accessToken)throw null===(i=this.serverTelemetryManager)||void 0===i||i.setCacheOutcome(Ze.NO_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - No access token found in cache for the given properties."),ee.createRefreshRequiredError();if(Ye.wasClockTurnedBack(h.accessToken.cachedAt)||Ye.isTokenExpired(h.accessToken.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw null===(s=this.serverTelemetryManager)||void 0===s||s.setCacheOutcome(Ze.CACHED_ACCESS_TOKEN_EXPIRED),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token is expired or will expire within "+this.config.systemOptions.tokenRenewalOffsetSeconds+" seconds."),ee.createRefreshRequiredError();if(h.accessToken.refreshOn&&Ye.isTokenExpired(h.accessToken.refreshOn,0))throw null===(c=this.serverTelemetryManager)||void 0===c||c.setCacheOutcome(Ze.REFRESH_CACHED_ACCESS_TOKEN),this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'."),ee.createRefreshRequiredError();return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(h,t)];case 1:return[2,p.sent()]}})})},e.prototype.generateResultFromCacheRecord=function(t,r){return I(this,void 0,void 0,function(){var i;return D(this,function(s){switch(s.label){case 0:return t.idToken&&(i=new st(t.idToken.secret,this.config.cryptoInterface)),[4,Wt.generateAuthenticationResult(this.cryptoUtils,this.authority,t,!0,r,i)];case 1:return[2,s.sent()]}})})},e}(nr),Cn=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return te(e,n),e.prototype.acquireToken=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l;return x(this,function(h){switch(h.label){case 0:return r=this.performanceClient.startMeasurement(fe.SilentCacheClientAcquireToken,t.correlationId),i=this.initializeServerTelemetryManager(Se.acquireTokenSilent_silentFlow),[4,this.createSilentFlowClient(i,t.authority,t.azureCloudOptions)];case 1:s=h.sent(),this.logger.verbose("Silent auth client created"),h.label=2;case 2:return h.trys.push([2,4,,5]),[4,s.acquireCachedToken(t)];case 3:return c=h.sent(),r.endMeasurement({success:!0,fromCache:!0}),[2,c];case 4:throw(l=h.sent())instanceof Q&&l.errorCode===j_signingKeyNotFoundInStorage_code&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),r.endMeasurement({success:!1}),l;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(Q.createSilentLogoutUnsupportedError())},e.prototype.createSilentFlowClient=function(t,r,i){return L(this,void 0,void 0,function(){var s;return x(this,function(c){switch(c.label){case 0:return[4,this.getClientConfiguration(t,r,i)];case 1:return s=c.sent(),[2,new yn(s)]}})})},e.prototype.initializeSilentRequest=function(t,r){return L(this,void 0,void 0,function(){var i;return x(this,function(s){switch(s.label){case 0:return i=[G({},t)],[4,this.initializeBaseRequest(t)];case 1:return[2,G.apply(void 0,[G.apply(void 0,i.concat([s.sent()])),{account:r,forceRefresh:t.forceRefresh||!1}])]}})})},e}(St),Tn=function(n){function e(t){var r=n.call(this,t)||this;return r.includeRedirectUri=!1,r}return te(e,n),e}(Cr),Sn=function(n){function e(t,r,i,s,c,l,h,p,v,T){var R=n.call(this,t,r,i,s,c,l,p,v,T)||this;return R.apiId=h,R}return te(e,n),e.prototype.acquireToken=function(t){return L(this,void 0,void 0,function(){var r,i,s,c,l,p;return x(this,function(v){switch(v.label){case 0:if(this.logger.trace("SilentAuthCodeClient.acquireToken called"),!t.code)throw Q.createAuthCodeRequiredError();return[4,this.initializeAuthorizationRequest(t,X.Silent)];case 1:r=v.sent(),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority,r.loginHint||y.EMPTY_STRING,r.account||null),i=this.initializeServerTelemetryManager(this.apiId),v.label=2;case 2:return v.trys.push([2,4,,5]),s=G(G({},r),{code:t.code}),[4,this.getClientConfiguration(i,r.authority)];case 3:return c=v.sent(),l=new Tn(c),this.logger.verbose("Auth code client created"),[2,new wr(l,this.browserStorage,s,this.logger,this.config.system.navigateFrameWait).handleCodeResponseFromServer({code:t.code,msgraph_host:t.msGraphHost,cloud_graph_host_name:t.cloudGraphHostName,cloud_instance_host_name:t.cloudInstanceHostName},r.state,l.authority,this.networkClient,!1)];case 4:throw(p=v.sent())instanceof ae&&p.setCorrelationId(this.correlationId),i.cacheFailedRequest(p),this.browserStorage.cleanRequestByState(r.state),p;case 5:return[2]}})})},e.prototype.logout=function(){return Promise.reject(Q.createSilentLogoutUnsupportedError())},e}(St),wn=function(){function n(e,t){this.correlationId=t,this.measureName="msal.measure."+e+"."+this.correlationId,this.startMark="msal.start."+e+"."+this.correlationId,this.endMark="msal.end."+e+"."+this.correlationId}return n.supportsBrowserPerformance=function(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName},n.prototype.startMeasurement=function(){if(n.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}},n.prototype.endMeasurement=function(){if(n.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}},n.prototype.flushMeasurement=function(){if(n.supportsBrowserPerformance())try{var e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){var t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch(r){}return null},n}(),In=function(n){function e(t,r,i,s,c,l){var h=n.call(this,t,r,i,s,c,l)||this;return h.browserCrypto=new Lt(h.logger),h.guidGenerator=new cr(h.browserCrypto),h}return te(e,n),e.prototype.startPerformanceMeasuremeant=function(t,r){return new wn(t,r)},e.prototype.generateId=function(){return this.guidGenerator.generateGuid()},e.prototype.getPageVisibility=function(){var t;return(null===(t=document.visibilityState)||void 0===t?void 0:t.toString())||null},e.prototype.startMeasurement=function(t,r){var i=this,s=this.getPageVisibility(),c=n.prototype.startMeasurement.call(this,t,r);return G(G({},c),{endMeasurement:function(l){return c.endMeasurement(G({startPageVisibility:s,endPageVisibility:i.getPageVisibility()},l))}})},e}(pr),Rn=function(n){function e(t){var r=n.call(this,t)||this;return r.activeSilentTokenRequests=new Map,r}return te(e,n),e.prototype.loginRedirect=function(t){return L(this,void 0,void 0,function(){var r;return x(this,function(i){return r=this.getRequestCorrelationId(t),this.logger.verbose("loginRedirect called",r),[2,this.acquireTokenRedirect(G({correlationId:r},t||ar))]})})},e.prototype.loginPopup=function(t){var r=this.getRequestCorrelationId(t);return this.logger.verbose("loginPopup called",r),this.acquireTokenPopup(G({correlationId:r},t||ar))},e.prototype.acquireTokenSilent=function(t){return L(this,void 0,void 0,function(){var r,i,s,l,h,p,v=this;return x(this,function(T){if(r=this.getRequestCorrelationId(t),i=this.performanceClient.startMeasurement(fe.AcquireTokenSilent,r),this.preflightBrowserEnvironmentCheck(X.Silent),this.logger.verbose("acquireTokenSilent called",r),!(s=t.account||this.getActiveAccount()))throw Q.createNoAccountError();return l=JSON.stringify({clientId:this.config.auth.clientId,authority:t.authority||y.EMPTY_STRING,scopes:t.scopes,homeAccountIdentifier:s.homeAccountId,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid}),void 0===(h=this.activeSilentTokenRequests.get(l))?(this.logger.verbose("acquireTokenSilent called for the first time, storing active request",r),p=this.acquireTokenSilentAsync(G(G({},t),{correlationId:r}),s).then(function(R){return v.activeSilentTokenRequests.delete(l),i.endMeasurement({success:!0,fromCache:R.fromCache}),i.flushMeasurement(),R}).catch(function(R){throw v.activeSilentTokenRequests.delete(l),i.endMeasurement({success:!1}),i.flushMeasurement(),R}),this.activeSilentTokenRequests.set(l,p),[2,p]):(this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",r),i.endMeasurement({success:!0}),i.discardMeasurement(),[2,h])})})},e.prototype.acquireTokenSilentAsync=function(t,r){return L(this,void 0,void 0,function(){var i,s,c,l,h,p=this;return x(this,function(v){switch(v.label){case 0:return this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_START,X.Silent,t),i=this.performanceClient.startMeasurement(fe.AcquireTokenSilentAsync,t.correlationId),mt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,t.authenticationScheme)&&r.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),c=G(G({},t),{account:r}),s=this.acquireTokenNative(c,Se.acquireTokenSilent_silentFlow).catch(function(T){return L(p,void 0,void 0,function(){return x(this,function(V){if(T instanceof rt&&T.isFatal())return this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,[2,this.createSilentIframeClient(t.correlationId).acquireToken(t)];throw T})})}),[3,3]):[3,1];case 1:return this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),[4,(l=this.createSilentCacheClient(t.correlationId)).initializeSilentRequest(t,r)];case 2:h=v.sent(),s=l.acquireToken(h).catch(function(){return L(p,void 0,void 0,function(){return x(this,function(T){return[2,this.acquireTokenByRefreshToken(h)]})})}),v.label=3;case 3:return[2,s.then(function(T){return p.eventHandler.emitEvent(he.ACQUIRE_TOKEN_SUCCESS,X.Silent,T),i.endMeasurement({success:!0,fromCache:T.fromCache}),T}).catch(function(T){throw p.eventHandler.emitEvent(he.ACQUIRE_TOKEN_FAILURE,X.Silent,null,T),i.endMeasurement({success:!1}),T})]}})})},e}(function(){function n(e){this.isBrowserEnvironment="undefined"!=typeof window,this.config=function(n,e){var t=n.auth,r=n.cache,i=n.system,s=n.telemetry,c={clientId:y.EMPTY_STRING,authority:""+y.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:y.EMPTY_STRING,authorityMetadata:y.EMPTY_STRING,redirectUri:y.EMPTY_STRING,postLogoutRedirectUri:y.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:kt.AAD,azureCloudOptions:{azureCloudInstance:yt.None,tenant:y.EMPTY_STRING}},l={cacheLocation:Ue.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1},h={loggerCallback:function(){},logLevel:Ne.Info,piiLoggingEnabled:!1},p=G(G({},yr),{loggerOptions:h,networkClient:e?Ie.getBrowserNetworkClient():Xr,navigationClient:new en,loadFrameTimeout:0,windowHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e4,iframeHashTimeout:(null==i?void 0:i.loadFrameTimeout)||6e3,navigateFrameWait:e&&Ie.detectIEOrEdge()?500:0,redirectNavigationTimeout:3e4,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(null==i?void 0:i.nativeBrokerHandshakeTimeout)||2e3}),v={application:{appName:y.EMPTY_STRING,appVersion:y.EMPTY_STRING}};return{auth:G(G({},c),t),cache:G(G({},l),r),system:G(G({},p),i),telemetry:G(G({},v),s)}}(e,this.isBrowserEnvironment),this.initialized=!1,this.logger=new dr(this.config.system.loggerOptions,rr,Pt),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.isBrowserEnvironment?new In(this.config.auth.clientId,this.config.auth.authority,this.logger,rr,Pt,this.config.telemetry.application):new Dr(this.config.auth.clientId,this.config.auth.authority,this.logger,rr,Pt,this.config.telemetry.application),this.browserCrypto=this.isBrowserEnvironment?new Ur(this.logger,this.performanceClient):Dt,this.eventHandler=new sn(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new Er(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger):function(n,e){return new Er(n,{cacheLocation:Ue.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1},Dt,e)}(this.config.auth.clientId,this.logger),this.tokenCache=new _n(this.config,this.browserStorage,this.logger,this.browserCrypto)}return n.prototype.initialize=function(){return L(this,void 0,void 0,function(){var e,t;return x(this,function(r){switch(r.label){case 0:if(this.logger.trace("initialize called"),this.initialized)return this.logger.warning("initialize has already been called. This function only needs to be run once."),[2];if(this.eventHandler.emitEvent(he.INITIALIZE_START),!this.config.system.allowNativeBroker)return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),e=this,[4,mt.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout)];case 2:return e.nativeExtensionProvider=r.sent(),[3,4];case 3:return t=r.sent(),this.logger.verbose(t),[3,4];case 4:return this.initialized=!0,this.eventHandler.emitEvent(he.INITIALIZE_END),[2]}})})},n.prototype.handleRedirectPromise=function(e){return L(this,void 0,void 0,function(){var t,r,i,s,c,l,h,p,v=this;return x(this,function(T){return this.logger.verbose("handleRedirectPromise called"),Ie.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),t=this.getAllAccounts(),this.isBrowserEnvironment?(void 0===(i=this.redirectResponse.get(r=e||y.EMPTY_STRING))?(this.eventHandler.emitEvent(he.HANDLE_REDIRECT_START,X.Redirect),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise"),s=this.browserStorage.getCachedNativeRequest(),c=void 0,s&&mt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e?(this.logger.trace("handleRedirectPromise - acquiring token from native platform"),l=new It(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,s.accountId,s.correlationId),c=l.handleRedirectPromise()):(this.logger.trace("handleRedirectPromise - acquiring token from web flow"),h=this.browserStorage.getTemporaryCache(_e.CORRELATION_ID,!0)||y.EMPTY_STRING,p=this.createRedirectClient(h),c=p.handleRedirectPromise(e)),i=c.then(function(R){return R&&(t.length<v.getAllAccounts().length?(v.eventHandler.emitEvent(he.LOGIN_SUCCESS,X.Redirect,R),v.logger.verbose("handleRedirectResponse returned result, login success")):(v.eventHandler.emitEvent(he.ACQUIRE_TOKEN_SUCCESS,X.Redirect,R),v.logger.verbose("handleRedirectResponse returned result, acquire token success"))),v.eventHandler.emitEvent(he.HANDLE_REDIRECT_END,X.Redirect),R}).catch(function(R){throw v.eventHandler.emitEvent(t.length>0?he.ACQUIRE_TOKEN_FAILURE:he.LOGIN_FAILURE,X.Redirect,null,R),v.eventHandler.emitEvent(he.HANDLE_REDIRECT_END,X.Redirect),R}),this.redirectResponse.set(r,i)):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),[2,i]):(this.logger.verbose("handleRedirectPromise returns null, not browser environment"),[2,null])})})},n.prototype.acquireTokenRedirect=function(e){return L(this,void 0,void 0,function(){var t,r,i,s,c,l=this;return x(this,function(h){return t=this.getRequestCorrelationId(e),this.logger.verbose("acquireTokenRedirect called",t),this.preflightBrowserEnvironmentCheck(X.Redirect),r=this.getAllAccounts().length>0,this.eventHandler.emitEvent(r?he.ACQUIRE_TOKEN_START:he.LOGIN_START,X.Redirect,e),this.nativeExtensionProvider&&this.canUseNative(e)?(s=new It(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),e.correlationId),i=s.acquireTokenRedirect(e).catch(function(p){if(p instanceof rt&&p.isFatal())return l.nativeExtensionProvider=void 0,l.createRedirectClient(e.correlationId).acquireToken(e);throw p})):(c=this.createRedirectClient(e.correlationId),i=c.acquireToken(e)),[2,i.catch(function(p){throw l.eventHandler.emitEvent(r?he.ACQUIRE_TOKEN_FAILURE:he.LOGIN_FAILURE,X.Redirect,null,p),p})]})})},n.prototype.acquireTokenPopup=function(e){var t=this,r=this.getRequestCorrelationId(e),i=this.performanceClient.startMeasurement(fe.AcquireTokenPopup,r);try{this.logger.verbose("acquireTokenPopup called",r),this.preflightBrowserEnvironmentCheck(X.Popup)}catch(h){return Promise.reject(h)}var s=this.getAllAccounts();return this.eventHandler.emitEvent(s.length>0?he.ACQUIRE_TOKEN_START:he.LOGIN_START,X.Popup,e),(this.canUseNative(e)?this.acquireTokenNative(e,Se.acquireTokenPopup).then(function(h){return t.browserStorage.setInteractionInProgress(!1),i.endMeasurement({success:!0,isNativeBroker:!0}),i.flushMeasurement(),h}).catch(function(h){if(h instanceof rt&&h.isFatal())return t.nativeExtensionProvider=void 0,t.createPopupClient(e.correlationId).acquireToken(e);throw h}):this.createPopupClient(e.correlationId).acquireToken(e)).then(function(h){var p=s.length<t.getAllAccounts().length;return t.eventHandler.emitEvent(p?he.LOGIN_SUCCESS:he.ACQUIRE_TOKEN_SUCCESS,X.Popup,h),i.endMeasurement({success:!0}),i.flushMeasurement(),h}).catch(function(h){return t.eventHandler.emitEvent(s.length>0?he.ACQUIRE_TOKEN_FAILURE:he.LOGIN_FAILURE,X.Popup,null,h),i.endMeasurement({success:!1}),i.flushMeasurement(),Promise.reject(h)})},n.prototype.ssoSilent=function(e){return L(this,void 0,void 0,function(){var t,r,i,s,c,l=this;return x(this,function(h){return t=this.getRequestCorrelationId(e),r=G(G({},e),{prompt:Re.NONE,correlationId:t}),this.preflightBrowserEnvironmentCheck(X.Silent),i=this.performanceClient.startMeasurement(fe.SsoSilent,t),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(he.SSO_SILENT_START,X.Silent,r),this.canUseNative(r)?s=this.acquireTokenNative(r,Se.ssoSilent).catch(function(p){if(p instanceof rt&&p.isFatal())return l.nativeExtensionProvider=void 0,l.createSilentIframeClient(r.correlationId).acquireToken(r);throw p}):(c=this.createSilentIframeClient(r.correlationId),s=c.acquireToken(r)),[2,s.then(function(p){return l.eventHandler.emitEvent(he.SSO_SILENT_SUCCESS,X.Silent,p),i.endMeasurement({success:!0}),i.flushMeasurement(),p}).catch(function(p){throw l.eventHandler.emitEvent(he.SSO_SILENT_FAILURE,X.Silent,null,p),i.endMeasurement({success:!1}),i.flushMeasurement(),p})]})})},n.prototype.acquireTokenByCode=function(e){return L(this,void 0,void 0,function(){var t,r,i,s,c=this;return x(this,function(l){t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(X.Silent),this.logger.trace("acquireTokenByCode called",t),this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_START,X.Silent,e),r=this.performanceClient.startMeasurement(fe.AcquireTokenByCode,e.correlationId);try{if(e.code)return(s=this.hybridAuthCodeResponses.get(i=e.code))?(this.logger.verbose("Existing acquireTokenByCode request found",e.correlationId),r.endMeasurement({success:!0}),r.discardMeasurement()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),s=this.acquireTokenByCodeAsync(G(G({},e),{correlationId:t})).then(function(h){return c.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_SUCCESS,X.Silent,h),c.hybridAuthCodeResponses.delete(i),r.endMeasurement({success:!0}),r.flushMeasurement(),h}).catch(function(h){throw c.hybridAuthCodeResponses.delete(i),c.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_FAILURE,X.Silent,null,h),r.endMeasurement({success:!1}),r.flushMeasurement(),h}),this.hybridAuthCodeResponses.set(i,s)),[2,s];if(e.nativeAccountId){if(this.canUseNative(e,e.nativeAccountId))return[2,this.acquireTokenNative(e,Se.acquireTokenByCode,e.nativeAccountId).catch(function(h){throw h instanceof rt&&h.isFatal()&&(c.nativeExtensionProvider=void 0),h})];throw Q.createUnableToAcquireTokenFromNativePlatformError()}throw Q.createAuthCodeOrNativeAccountIdRequiredError()}catch(h){throw this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_BY_CODE_FAILURE,X.Silent,null,h),r.endMeasurement({success:!1}),h}return[2]})})},n.prototype.acquireTokenByCodeAsync=function(e){return L(this,void 0,void 0,function(){return x(this,function(i){switch(i.label){case 0:return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),[4,this.createSilentAuthCodeClient(e.correlationId).acquireToken(e)];case 1:return[2,i.sent()]}})})},n.prototype.acquireTokenByRefreshToken=function(e){return L(this,void 0,void 0,function(){var t,i=this;return x(this,function(s){return Ie.blockReloadInHiddenIframes(),t=this.performanceClient.startMeasurement(fe.AcquireTokenByRefreshToken,e.correlationId),this.eventHandler.emitEvent(he.ACQUIRE_TOKEN_NETWORK_START,X.Silent,e),[2,this.createSilentRefreshClient(e.correlationId).acquireToken(e).then(function(c){return t.endMeasurement({success:!0,fromCache:c.fromCache}),c}).catch(function(c){if(c instanceof pt&&"invalid_grant"===c.errorCode&&!(c instanceof ct))return i.logger.verbose("Refresh token expired or invalid, attempting acquire token by iframe",e.correlationId),i.createSilentIframeClient(e.correlationId).acquireToken(e).then(function(T){return t.endMeasurement({success:!0,fromCache:T.fromCache}),T}).catch(function(T){throw t.endMeasurement({success:!1}),T});throw t.endMeasurement({success:!1}),c})]})})},n.prototype.logout=function(e){return L(this,void 0,void 0,function(){var t;return x(this,function(r){return t=this.getRequestCorrelationId(e),this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),[2,this.logoutRedirect(G({correlationId:t},e))]})})},n.prototype.logoutRedirect=function(e){return L(this,void 0,void 0,function(){var t;return x(this,function(i){return t=this.getRequestCorrelationId(e),this.preflightBrowserEnvironmentCheck(X.Redirect),[2,this.createRedirectClient(t).logout(e)]})})},n.prototype.logoutPopup=function(e){try{var t=this.getRequestCorrelationId(e);return this.preflightBrowserEnvironmentCheck(X.Popup),this.createPopupClient(t).logout(e)}catch(i){return Promise.reject(i)}},n.prototype.getAllAccounts=function(){return this.logger.verbose("getAllAccounts called"),this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},n.prototype.getAccountByUsername=function(e){var t=this.getAllAccounts();return!J.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching username found, returning"),this.logger.verbosePii("Returning signed-in accounts matching username: "+e),t.filter(function(r){return r.username.toLowerCase()===e.toLowerCase()})[0]||null):(this.logger.verbose("getAccountByUsername: No matching account found, returning null"),null)},n.prototype.getAccountByHomeId=function(e){var t=this.getAllAccounts();return!J.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching homeAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching homeAccountId: "+e),t.filter(function(r){return r.homeAccountId===e})[0]||null):(this.logger.verbose("getAccountByHomeId: No matching account found, returning null"),null)},n.prototype.getAccountByLocalId=function(e){var t=this.getAllAccounts();return!J.isEmpty(e)&&t&&t.length?(this.logger.verbose("Account matching localAccountId found, returning"),this.logger.verbosePii("Returning signed-in accounts matching localAccountId: "+e),t.filter(function(r){return r.localAccountId===e})[0]||null):(this.logger.verbose("getAccountByLocalId: No matching account found, returning null"),null)},n.prototype.setActiveAccount=function(e){this.browserStorage.setActiveAccount(e)},n.prototype.getActiveAccount=function(){return this.browserStorage.getActiveAccount()},n.prototype.preflightBrowserEnvironmentCheck=function(e){if(this.logger.verbose("preflightBrowserEnvironmentCheck started"),Ie.blockNonBrowserEnvironment(this.isBrowserEnvironment),Ie.blockRedirectInIframe(e,this.config.system.allowRedirectInIframe),Ie.blockReloadInHiddenIframes(),Ie.blockAcquireTokenInPopups(),Ie.blockNativeBrokerCalledBeforeInitialized(this.config.system.allowNativeBroker,this.initialized),e===X.Redirect&&this.config.cache.cacheLocation===Ue.MemoryStorage&&!this.config.cache.storeAuthStateInCookie)throw er.createInMemoryRedirectUnavailableError();(e===X.Redirect||e===X.Popup)&&this.preflightInteractiveRequest()},n.prototype.preflightInteractiveRequest=function(){this.logger.verbose("preflightInteractiveRequest called, validating app environment"),Ie.blockReloadInHiddenIframes(),this.browserStorage.setInteractionInProgress(!0)},n.prototype.acquireTokenNative=function(e,t,r){return L(this,void 0,void 0,function(){return x(this,function(s){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw Q.createNativeConnectionNotEstablishedError();return[2,new It(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),e.correlationId).acquireToken(e)]})})},n.prototype.canUseNative=function(e,t){if(this.logger.trace("canUseNative called"),!mt.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Re.NONE:case Re.CONSENT:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace("canUseNative: prompt = "+e.prompt+" is not compatible with native flow, returning false"),!1}return!(!t&&!this.getNativeAccountId(e)&&(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),1))},n.prototype.getNativeAccountId=function(e){var t=e.account||this.browserStorage.getAccountInfoByHints(e.loginHint,e.sid)||this.getActiveAccount();return t&&t.nativeAccountId||""},n.prototype.createPopupClient=function(e){return new gn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.createRedirectClient=function(e){return new mn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.createSilentIframeClient=function(e){return new vn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.ssoSilent,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.createSilentCacheClient=function(e){return new Cn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.createSilentRefreshClient=function(e){return new En(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.createSilentAuthCodeClient=function(e){return new Sn(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Se.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)},n.prototype.addEventCallback=function(e){return this.eventHandler.addEventCallback(e)},n.prototype.removeEventCallback=function(e){this.eventHandler.removeEventCallback(e)},n.prototype.addPerformanceCallback=function(e){return this.performanceClient.addPerformanceCallback(e)},n.prototype.removePerformanceCallback=function(e){return this.performanceClient.removePerformanceCallback(e)},n.prototype.enableAccountStorageEvents=function(){this.eventHandler.enableAccountStorageEvents()},n.prototype.disableAccountStorageEvents=function(){this.eventHandler.disableAccountStorageEvents()},n.prototype.getTokenCache=function(){return this.tokenCache},n.prototype.getLogger=function(){return this.logger},n.prototype.setLogger=function(e){this.logger=e},n.prototype.initializeWrapperLibrary=function(e,t){this.browserStorage.setWrapperMetadata(e,t)},n.prototype.setNavigationClient=function(e){this.navigationClient=e},n.prototype.getConfiguration=function(){return this.config},n.prototype.getRequestCorrelationId=function(e){return(null==e?void 0:e.correlationId)?e.correlationId:this.isBrowserEnvironment?this.browserCrypto.createNewGuid():y.EMPTY_STRING},n}()),nt=o(6435),bn=o(77587),sr=o(74461),On=o(86405),Nn=o(3469);let ke=(()=>{class n extends d.Lo{constructor(t){super(),this.initialized=!1,this.name=t.name,this.clientId=t.clientId,this.additionalParams=t.additionalParams,this.icon=t.name.toLowerCase()}}return n.FACEBOOK="Facebook",n.GOOGLE="Google",n.MICROSOFT="Microsoft",n.OPENID="OpenIdConnect",n.WSFEDERATION="WsFederation",n.TWITTER="Twitter",n})(),kn=(()=>{class n{constructor(t,r,i,s,c,l,h,p,v){this._tokenAuthService=t,this._router=r,this._messageService=i,this._tokenService=s,this._logService=c,this.oauthService=l,this.spinnerService=h,this._localStorageService=p,this._twitterService=v,this.externalLoginProviders=[],this.localizationSourceName=a.g.localization.defaultLocalizationSourceName,this.clear()}authenticate(t,r,i){t=t||(()=>{this.spinnerService.hide()});const s=this;this._localStorageService.getItem(n.twoFactorRememberClientTokenName,function(c,l){s.authenticateModel.twoFactorRememberClientToken=null==l?void 0:l.token,s.authenticateModel.singleSignIn=u._.getSingleSignIn(),s.authenticateModel.returnUrl=u._.getReturnUrl(),s.authenticateModel.captchaResponse=i,s._tokenAuthService.authenticate(s.authenticateModel).subscribe({next:h=>{s.processAuthenticateResult(h,r),t()},error:h=>{t()}})})}ensureExternalLoginProviderInitialized(t,r){if(t.initialized)r();else if(t.name===ke.FACEBOOK)(new m.$).load("//connect.facebook.net/en_US/sdk.js").then(()=>{FB.init({appId:t.clientId,cookie:!1,xfbml:!0,version:"v2.5"}),FB.getLoginStatus(i=>{this.facebookLoginStatusChangeCallback(i),"connected"!==i.status&&r()})});else if(t.name===ke.GOOGLE)(new m.$).load("https://apis.google.com/js/api.js","https://accounts.google.com/gsi/client").then(()=>{gapi.load("client",()=>{gapi.client.init({}).then(()=>{gapi.client.load("oauth2","v2",()=>{r()})})})});else if(t.name===ke.MICROSOFT)this.MSAL=new Rn({auth:{clientId:t.clientId,redirectUri:a.g.appBaseUrl}}),r();else if(t.name===ke.OPENID){const i=this.getOpenIdConnectConfig(t);this.oauthService.configure(i),this.oauthService.initLoginFlow("openIdConnect=1")}else if(t.name===ke.WSFEDERATION){let i=this.getWsFederationConnectConfig(t);this.wsFederationAuthenticationContext=new re(i),this.wsFederationAuthenticationContext.login()}else t.name===ke.TWITTER&&r()}twitterLoginCallback(t,r){this.spinnerService.show(),this._twitterService.getAccessToken(t,r).subscribe(i=>{const s=new d.pL;s.authProvider=ke.TWITTER,s.providerAccessCode=i.accessToken+"&"+i.accessTokenSecret,s.providerKey=i.userId,s.singleSignIn=u._.getSingleSignIn(),s.returnUrl=u._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(s).pipe((0,H.x)(()=>{this.spinnerService.hide()})).subscribe(c=>{c.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(c.accessToken,c.encryptedAccessToken,c.expireInSeconds,c.refreshToken,c.refreshTokenExpireInSeconds,!1,"",c.returnUrl)})})}wsFederationLoginStatusChangeCallback(t,r,i,s){let c=this.wsFederationAuthenticationContext.getCachedUser();const l=new d.pL;l.authProvider=ke.WSFEDERATION,l.providerAccessCode=r,l.providerKey=c.profile.sub,l.singleSignIn=u._.getSingleSignIn(),l.returnUrl=u._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(l).subscribe(h=>{if(h.waitingForActivation)return this._messageService.info("You have successfully registered. Waiting for activation!"),void this._router.navigate(["account/login"]);this.login(h.accessToken,h.encryptedAccessToken,h.expireInSeconds,h.refreshToken,h.refreshTokenExpireInSeconds,!1,"",h.returnUrl)})}openIdConnectLoginCallback(t){this.initExternalLoginProviders(()=>{let r=(0,C.Z)(this.externalLoginProviders,{name:"OpenIdConnect"})[0],i=this.getOpenIdConnectConfig(r);this.oauthService.configure(i),this.spinnerService.show(),this.oauthService.loadDiscoveryDocumentAndTryLogin().then(()=>{let s=this.oauthService.getIdentityClaims();const c=new d.pL;c.authProvider=ke.OPENID,c.providerAccessCode=this.oauthService.getIdToken(),c.providerKey=s.sub,c.singleSignIn=u._.getSingleSignIn(),c.returnUrl=u._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(c).pipe((0,H.x)(()=>{this.spinnerService.hide()})).subscribe(l=>{l.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(l.accessToken,l.encryptedAccessToken,l.expireInSeconds,l.refreshToken,l.refreshTokenExpireInSeconds,!1,"",l.returnUrl)})})})}externalAuthenticate(t){this.ensureExternalLoginProviderInitialized(t,()=>{if(t.name===ke.FACEBOOK)FB.login(r=>{this.facebookLoginStatusChangeCallback(r)},{scope:"email"});else if(t.name===ke.GOOGLE){let r=google.accounts.oauth2.initTokenClient({client_id:t.clientId,scope:"openid profile email",callback:i=>{if(void 0!==i.error)throw i;this.googleLoginStatusChangeCallback(i)}});null===gapi.client.getToken()?r.requestAccessToken({prompt:"consent"}):r.requestAccessToken({prompt:""})}else if(t.name===ke.MICROSOFT){let r=["user.read"];this.spinnerService.show(),this.MSAL.loginPopup({scopes:r}).then(i=>{this.MSAL.acquireTokenSilent({account:this.MSAL.getAllAccounts()[0],scopes:r}).then(s=>{this.microsoftLoginCallback(s),this.spinnerService.hide()}).catch(s=>{abp.log.error(s),abp.message.error(this.localization.localize("CouldNotValidateExternalUser",this.localizationSourceName))})})}else t.name===ke.TWITTER&&this.startTwitterLogin()})}init(){this.initExternalLoginProviders()}processAuthenticateResult(t,r){this.authenticateResult=t,t.shouldResetPassword?(this._router.navigate(["account/reset-password"],{queryParams:{userId:t.userId,tenantId:abp.session.tenantId,resetCode:t.passwordResetCode}}),this.clear()):t.requiresTwoFactorVerification?this._router.navigate(["account/send-code"]):t.accessToken?(t.returnUrl&&!r&&(r=t.returnUrl),this.login(t.accessToken,t.encryptedAccessToken,t.expireInSeconds,t.refreshToken,t.refreshTokenExpireInSeconds,this.rememberMe,t.twoFactorRememberClientToken,r)):(this._logService.warn("Unexpected authenticateResult!"),this._router.navigate(["account/login"]))}login(t,r,i,s,c,l,h,p){let v=l?new Date((new Date).getTime()+1e3*i):void 0;if(this._tokenService.setToken(t,v),s&&l){let R=l?new Date((new Date).getTime()+1e3*c):void 0;this._tokenService.setRefreshToken(s,R)}let T=this;this._localStorageService.setItem(a.g.authorization.encrptedAuthTokenName,{token:r,expireDate:v},()=>{h?T._localStorageService.setItem(n.twoFactorRememberClientTokenName,{token:h,expireDate:new Date((new Date).getTime()+31536e6)},()=>{T.redirectToLoginResult(p)}):T.redirectToLoginResult(p)})}redirectToLoginResult(t){if(t)location.href=t;else{let r=u._.initialUrl;r.indexOf("/account")>0&&(r=a.g.appBaseUrl),location.href=r}}clear(){this.authenticateModel=new d.u_,this.authenticateModel.rememberClient=!1,this.authenticateResult=null,this.rememberMe=!1}initExternalLoginProviders(t){this._tokenAuthService.getExternalAuthenticationProviders().subscribe(r=>{this.externalLoginProviders=f(r,i=>new ke(i)),t&&t()})}getWsFederationConnectConfig(t){let r={clientId:t.clientId,popUp:!0,callback:this.wsFederationLoginStatusChangeCallback.bind(this)};return t.additionalParams.Tenant&&(r.tenant=t.additionalParams.Tenant),r}getOpenIdConnectConfig(t){let r=new M.Tg;return r.loginUrl=t.additionalParams.LoginUrl,r.issuer=t.additionalParams.Authority,r.skipIssuerCheck="false"===t.additionalParams.ValidateIssuer,r.clientId=t.clientId,r.responseType=t.additionalParams.ResponseType,r.strictDiscoveryDocumentValidation=!1,r.redirectUri=window.location.origin+"/account/login",r.scope="openid profile",r.requestAccessToken=!1,r}facebookLoginStatusChangeCallback(t){if("connected"===t.status){const r=new d.pL;r.authProvider=ke.FACEBOOK,r.providerAccessCode=t.authResponse.accessToken,r.providerKey=t.authResponse.userID,r.singleSignIn=u._.getSingleSignIn(),r.returnUrl=u._.getReturnUrl(),this._tokenAuthService.externalAuthenticate(r).subscribe(i=>{i.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):this.login(i.accessToken,i.encryptedAccessToken,i.expireInSeconds,i.refreshToken,i.refreshTokenExpireInSeconds,!1,"",i.returnUrl)})}}startTwitterLogin(){this.spinnerService.show(),this._twitterService.getRequestToken().pipe((0,H.x)(()=>this.spinnerService.hide())).subscribe(t=>{t.confirmed?window.location.href=t.redirectUrl:this._messageService.error("Couldn't get twitter request token !")})}googleLoginStatusChangeCallback(t){if(void 0===t.error){var r=this;gapi.client.oauth2.userinfo.get().execute(function(i){const s=new d.pL;s.authProvider=ke.GOOGLE,s.providerAccessCode=t.access_token,s.providerKey=i.id,s.singleSignIn=u._.getSingleSignIn(),s.returnUrl=u._.getReturnUrl(),r._tokenAuthService.externalAuthenticate(s).subscribe(c=>{c.waitingForActivation?r._messageService.info("You have successfully registered. Waiting for activation!"):r.login(c.accessToken,c.encryptedAccessToken,c.expireInSeconds,c.refreshToken,c.refreshTokenExpireInSeconds,!1,"",c.returnUrl)})})}}microsoftLoginCallback(t){const r=new d.pL;r.authProvider=ke.MICROSOFT,r.providerAccessCode=t.accessToken,r.providerKey=t.uniqueId,r.singleSignIn=u._.getSingleSignIn(),r.returnUrl=u._.getReturnUrl(),this.spinnerService.show(),this._tokenAuthService.externalAuthenticate(r).subscribe(i=>{i.waitingForActivation?this._messageService.info("You have successfully registered. Waiting for activation!"):(this.login(i.accessToken,i.encryptedAccessToken,i.expireInSeconds,i.refreshToken,i.refreshTokenExpireInSeconds,!1,"",i.returnUrl),this.spinnerService.hide())})}}return n.twoFactorRememberClientTokenName="TwoFactorRememberClientToken",n.\u0275fac=function(t){return new(t||n)(nt.\u0275\u0275inject(d.WH),nt.\u0275\u0275inject(bn.F0),nt.\u0275\u0275inject(sr.ez),nt.\u0275\u0275inject(sr.Br),nt.\u0275\u0275inject(sr.$V),nt.\u0275\u0275inject(M.Ct),nt.\u0275\u0275inject(On.t2),nt.\u0275\u0275inject(Nn.n),nt.\u0275\u0275inject(d.TW))},n.\u0275prov=nt.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n})()},12749:(_,E,o)=>{"use strict";o.d(E,{y:()=>d});var a=o(60263),u=o(6435);let d=(()=>{class m{}return m.\u0275fac=function(S){return new(S||m)},m.\u0275mod=u.\u0275\u0275defineNgModule({type:m}),m.\u0275inj=u.\u0275\u0275defineInjector({imports:[[a.o]]}),m})()},70685:_=>{var E=function(){"use strict";return E=function(o){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},E.prototype._singletonInstance)return E.prototype._singletonInstance;if(E.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,o.displayCall&&"function"!=typeof o.displayCall)throw new Error("displayCall is not a function");if(!o.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(o),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(o){}}),E.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var o=this._guid();this.config.state=o,this._idTokenNonce=this._guid();var a=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);a&&""!==a?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):a=window.location.href,this.verbose("Expected state: "+o+" startPage:"+a),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,a),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,o,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var u=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(u):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(o),this.registerCallback(o,this.config.clientId,this.callback),this._loginPopup(u)):this.promptUser(u)}},E.prototype._openPopup=function(o,a,u,d){try{var m=window.screenLeft?window.screenLeft:window.screenX,g=window.screenTop?window.screenTop:window.screenY,S=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,F=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,B=window.open(o,a,"width="+u+", height="+d+", top="+(F/2-d/2+g)+", left="+(S/2-u/2+m));return B.focus&&B.focus(),B}catch(N){return this.warn("Error opening popup, "+N.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},E.prototype._handlePopupError=function(o,a,u,d,m){this.warn(d),this._saveItem(this.CONSTANTS.STORAGE.ERROR,u),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,d),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,m),a&&this._activeRenewals[a]&&(this._activeRenewals[a]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,o&&o(d,null,u)},E.prototype._loginPopup=function(o,a,u){var d=this._openPopup(o,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),m=u||this.callback;if(null!=d){if(this._openedWindows.push(d),-1!=this.config.redirectUri.indexOf("#"))var F=this.config.redirectUri.split("#")[0];else F=this.config.redirectUri;var W=this,A=window.setInterval(function(){if(!d||d.closed||void 0===d.closed){var B="Popup Window closed",N="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return W.isAngular&&W._broadcast("adal:popUpClosed",N+W.CONSTANTS.RESOURCE_DELIMETER+B),W._handlePopupError(m,a,B,N,N),void window.clearInterval(A)}try{var b=d.location;if(-1!=encodeURI(b.href).indexOf(encodeURI(F)))return W.isAngular?W._broadcast("adal:popUpHashChanged",b.hash):W.handleWindowCallback(b.hash),window.clearInterval(A),W._loginInProgress=!1,W._acquireTokenInProgress=!1,W.info("Closing popup window"),W._openedWindows=[],void d.close()}catch(f){}},1)}else{var S="Popup Window is null. This can happen if you are using IE";this._handlePopupError(m,a,"Error opening popup",S,S)}},E.prototype._broadcast=function(o,a){!function(){if("function"==typeof window.CustomEvent)return!1;function d(m,g){g=g||{bubbles:!1,cancelable:!1,detail:void 0};var S=document.createEvent("CustomEvent");return S.initCustomEvent(m,g.bubbles,g.cancelable,g.detail),S}d.prototype=window.Event.prototype,window.CustomEvent=d}();var u=new CustomEvent(o,{detail:a});window.dispatchEvent(u)},E.prototype.loginInProgress=function(){return this._loginInProgress},E.prototype._hasResource=function(o){var a=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return a&&!this._isEmpty(a)&&a.indexOf(o+this.CONSTANTS.RESOURCE_DELIMETER)>-1},E.prototype.getCachedToken=function(o){if(!this._hasResource(o))return null;var a=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+o),u=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+o),d=this.config.expireOffsetSeconds||300;return u&&u>this._now()+d?a:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+o,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+o,0),null)},E.prototype.getCachedUser=function(){if(this._user)return this._user;var o=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(o),this._user},E.prototype.registerCallback=function(o,a,u){this._activeRenewals[a]=o,this._callBacksMappedToRenewStates[o]||(this._callBacksMappedToRenewStates[o]=[]);var d=this;this._callBacksMappedToRenewStates[o].push(u),this._callBackMappedToRenewStates[o]||(this._callBackMappedToRenewStates[o]=function(m,g,S,F){d._activeRenewals[a]=null;for(var W=0;W<d._callBacksMappedToRenewStates[o].length;++W)try{d._callBacksMappedToRenewStates[o][W](m,g,S,F)}catch(A){d.warn(A)}d._callBacksMappedToRenewStates[o]=null,d._callBackMappedToRenewStates[o]=null})},E.prototype._renewToken=function(o,a,u){this.info("renewToken is called for resource:"+o);var d=this._addAdalFrame("adalRenewFrame"+o),m=this._guid()+"|"+o;this.config.state=m,this._renewStates.push(m),this.verbose("Renew token Expected state: "+m);var g=this._urlRemoveQueryStringParameter(this._getNavigateUrl(u=u||"token",o),"prompt");u===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),g+="&nonce="+encodeURIComponent(this._idTokenNonce)),g=this._addHintParameters(g+="&prompt=none"),this.registerCallback(m,o,a),this.verbosePii("Navigate to:"+g),d.src="about:blank",this._loadFrameTimeout(g,"adalRenewFrame"+o,o)},E.prototype._renewIdToken=function(o,a){this.info("renewIdToken is called");var u=this._addAdalFrame("adalIdTokenFrame"),d=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=d,this._renewStates.push(d),this.verbose("Renew Idtoken Expected state: "+d);var m=null==a?null:this.config.clientId,g=this._urlRemoveQueryStringParameter(this._getNavigateUrl(a=a||"id_token",m),"prompt");g=this._addHintParameters(g+="&prompt=none"),g+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(d,this.config.clientId,o),this.verbosePii("Navigate to:"+g),u.src="about:blank",this._loadFrameTimeout(g,"adalIdTokenFrame",this.config.clientId)},E.prototype._urlContainsQueryStringParameter=function(o,a){return new RegExp("[\\?&]"+o+"=").test(a)},E.prototype._urlRemoveQueryStringParameter=function(o,a){var u=new RegExp("(\\&"+a+"=)[^&]+");return o=o.replace(u,""),u=new RegExp("("+a+"=)[^&]+&"),o=o.replace(u,""),u=new RegExp("("+a+"=)[^&]+"),o.replace(u,"")},E.prototype._loadFrameTimeout=function(o,a,u){this.verbose("Set loading state to pending for: "+u),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+u,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(o,a);var d=this;setTimeout(function(){if(d._getItem(d.CONSTANTS.STORAGE.RENEW_STATUS+u)===d.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){d.verbose("Loading frame has timed out after: "+d.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+u);var m=d._activeRenewals[u];m&&d._callBackMappedToRenewStates[m]&&d._callBackMappedToRenewStates[m]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),d._saveItem(d.CONSTANTS.STORAGE.RENEW_STATUS+u,d.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},d.CONSTANTS.LOADFRAME_TIMEOUT)},E.prototype._loadFrame=function(o,a){var u=this;u.info("LoadFrame: "+a);var d=a;setTimeout(function(){var m=u._addAdalFrame(d);(""===m.src||"about:blank"===m.src)&&(m.src=o,u._loadFrame(o,d))},500)},E.prototype.acquireToken=function(o,a){if(this._isEmpty(o))return this.warn("resource is required"),void a("resource is required",null,"resource is required");var u=this.getCachedToken(o);return u?(this.info("Token is already in cache for resource:"+o),void a(null,u,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[o]?this.registerCallback(this._activeRenewals[o],o,a):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,o===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(a)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(a,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(o,a)):(this.verbose("renewing idtoken and access_token"),this._renewToken(o,a,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void a("User login is required",null,"login required"))},E.prototype.acquireTokenPopup=function(o,a,u,d){if(this._isEmpty(o))return this.warn("resource is required"),void d("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void d("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void d("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var m=this._guid()+"|"+o;this.config.state=m,this._renewStates.push(m),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+m);var g=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",o),"prompt");if(g+="&prompt=select_account",a&&(g+=a),u&&-1===g.indexOf("&claims"))g+="&claims="+encodeURIComponent(u);else if(u&&-1!==g.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");g=this._addHintParameters(g),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+o),this.registerCallback(m,o,d),this._loginPopup(g,o,d)},E.prototype.acquireTokenRedirect=function(o,a,u){if(this._isEmpty(o))return this.warn("resource is required"),void d("resource is required",null,"resource is required");var d=this.callback;if(!this._user)return this.warn("User login is required"),void d("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void d("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var m=this._guid()+"|"+o;this.config.state=m,this.verbose("Renew token Expected state: "+m);var g=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",o),"prompt");if(g+="&prompt=select_account",a&&(g+=a),u&&-1===g.indexOf("&claims"))g+="&claims="+encodeURIComponent(u);else if(u&&-1!==g.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");g=this._addHintParameters(g),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+o),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,m,!0),this.promptUser(g)},E.prototype.promptUser=function(o){o?(this.infoPii("Navigate to:"+o),window.location.replace(o)):this.info("Navigate url is empty")},E.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var o=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(o)){o=o.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var a=0;a<o.length&&""!==o[a];a++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+o[a],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+o[a],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},E.prototype.clearCacheForResource=function(o){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(o)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+o,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+o,0))},E.prototype.logOut=function(){var o;if(this.clearCache(),this._user=null,this.config.logOutUri)o=this.config.logOutUri;else{var a="common",u="";this.config.tenant&&(a=this.config.tenant),this.config.postLogoutRedirectUri&&(u="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),o=this.instance+a+"/oauth2/logout?"+u}this.infoPii("Logout navigate to: "+o),this.promptUser(o)},E.prototype._isEmpty=function(o){return void 0===o||!o||0===o.length},E.prototype.getUser=function(o){if("function"!=typeof o)throw new Error("callback is not a function");if(this._user)o(null,this._user);else{var a=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(a)?(this.warn("User information is not available"),o("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(a),o(null,this._user))}},E.prototype._addHintParameters=function(o){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==o.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",o)||(o+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",o)||(o+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",o)&&this._user.profile.upn.indexOf("@")>-1)){var a=this._user.profile.upn.split("@");o+="&domain_hint="+encodeURIComponent(a[a.length-1])}return o},E.prototype._createUser=function(o){var a=null,u=this._extractIdToken(o);return u&&u.hasOwnProperty("aud")&&(u.aud.toLowerCase()===this.config.clientId.toLowerCase()?(a={userName:"",profile:u},u.hasOwnProperty("upn")?a.userName=u.upn:u.hasOwnProperty("email")&&(a.userName=u.email)):this.warn("IdToken has invalid aud field")),a},E.prototype._getHash=function(o){return o.indexOf("#/")>-1?o=o.substring(o.indexOf("#/")+2):o.indexOf("#")>-1&&(o=o.substring(1)),o},E.prototype.isCallback=function(o){o=this._getHash(o);var a=this._deserialize(o);return a.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||a.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||a.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},E.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},E.prototype.getRequestInfo=function(o){o=this._getHash(o);var a=this._deserialize(o),u={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(a&&(u.parameters=a,a.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||a.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||a.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){if(u.valid=!0,!a.hasOwnProperty("state"))return this.warn("No state returned"),u;if(this.verbose("State: "+a.state),u.stateResponse=a.state,this._matchState(u))return u;if(!u.stateMatch&&window.parent){u.requestType=this._requestType;for(var m=this._renewStates,g=0;g<m.length;g++)if(m[g]===u.stateResponse){u.stateMatch=!0;break}}}return u},E.prototype._matchNonce=function(o){var a=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(a){a=a.split(this.CONSTANTS.CACHE_DELIMETER);for(var u=0;u<a.length;u++)if(a[u]&&a[u]===o.profile.nonce)return!0}return!1},E.prototype._matchState=function(o){var a=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(a){a=a.split(this.CONSTANTS.CACHE_DELIMETER);for(var u=0;u<a.length;u++)if(a[u]&&a[u]===o.stateResponse)return o.requestType=this.REQUEST_TYPE.LOGIN,o.stateMatch=!0,!0}var d=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(d)for(d=d.split(this.CONSTANTS.CACHE_DELIMETER),u=0;u<d.length;u++)if(d[u]&&d[u]===o.stateResponse)return o.requestType=this.REQUEST_TYPE.RENEW_TOKEN,o.stateMatch=!0,!0;return!1},E.prototype._getResourceFromState=function(o){if(o){var a=o.indexOf("|");if(a>-1&&a+1<o.length)return o.substring(a+1)}return""},E.prototype.saveTokenFromHash=function(o){this.info("State status:"+o.stateMatch+"; Request type:"+o.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var a=this._getResourceFromState(o.stateResponse);if(o.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+o.parameters.error+"; Error description:"+o.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,o.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,o.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),o.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,o.parameters.error_description));else if(o.stateMatch){var u;this.info("State is right"),o.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,o.parameters[this.CONSTANTS.SESSION_STATE]),o.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(a)||(u=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,u+a+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+a,o.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+a,this._expiresIn(o.parameters[this.CONSTANTS.EXPIRES_IN]))),o.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(o.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,o.parameters[this.CONSTANTS.ID_TOKEN]),this._hasResource(a=this.config.loginResource?this.config.loginResource:this.config.clientId)||(u=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,u+a+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+a,o.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+a,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(o.parameters.error="invalid id_token",o.parameters.error_description="Invalid id_token. id_token: "+o.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+o.parameters[this.CONSTANTS.ID_TOKEN])))}else o.parameters.error="Invalid_state",o.parameters.error_description="Invalid_state. state: "+o.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+o.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+a,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},E.prototype.getResourceForEndpoint=function(o){if(this.config&&this.config.anonymousEndpoints)for(var a=0;a<this.config.anonymousEndpoints.length;a++)if(o.indexOf(this.config.anonymousEndpoints[a])>-1)return null;if(this.config&&this.config.endpoints)for(var u in this.config.endpoints)if(o.indexOf(u)>-1)return this.config.endpoints[u];return o.indexOf("http://")>-1||o.indexOf("https://")>-1?this._getHostFromUri(o)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},E.prototype._getHostFromUri=function(o){var a=String(o).replace(/^(https?:)\/\//,"");return a.split("/")[0]},E.prototype.handleWindowCallback=function(o){if(null==o&&(o=window.location.hash),this.isCallback(o)){var a=null,u=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(a=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,u=!0):window.parent&&window.parent._adalInstance&&(a=window.parent._adalInstance);var m,g,d=a.getRequestInfo(o),S=null;g=u||window.parent!==window?a._callBackMappedToRenewStates[d.stateResponse]:a.callback,a.info("Returned from redirect url"),a.saveTokenFromHash(d),d.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?a.verbose("Window is in iframe, acquiring token silently"):a.verbose("acquiring token interactive in progress"),m=d.parameters[a.CONSTANTS.ACCESS_TOKEN]||d.parameters[a.CONSTANTS.ID_TOKEN],S=a.CONSTANTS.ACCESS_TOKEN):d.requestType===this.REQUEST_TYPE.LOGIN&&(m=d.parameters[a.CONSTANTS.ID_TOKEN],S=a.CONSTANTS.ID_TOKEN);var F=d.parameters[a.CONSTANTS.ERROR_DESCRIPTION],W=d.parameters[a.CONSTANTS.ERROR];try{g&&g(F,m,W,S)}catch(A){a.error("Error occurred in user defined callback function: "+A)}window.parent===window&&!u&&(a.config.navigateToLoginRequestUrl?window.location.href=a._getItem(a.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},E.prototype._getNavigateUrl=function(o,a){var u="common";this.config.tenant&&(u=this.config.tenant);var d=this.instance+u+"/oauth2/authorize"+this._serialize(o,this.config,a)+this._addLibMetadata();return this.info("Navigate url:"+d),d},E.prototype._extractIdToken=function(o){var a=this._decodeJwt(o);if(!a)return null;try{var d=this._base64DecodeStringUrlSafe(a.JWSPayload);return d?JSON.parse(d):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(m){this.error("The returned id_token could not be decoded",m)}return null},E.prototype._base64DecodeStringUrlSafe=function(o){return o=o.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(o))):decodeURIComponent(escape(this._decode(o)))},E.prototype._decode=function(o){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=(o=String(o).replace(/=+$/,"")).length;if(u%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var d,m,g,S,F,W,A,N="",b=0;b<u;b+=4){if(d=a.indexOf(o.charAt(b)),m=a.indexOf(o.charAt(b+1)),g=a.indexOf(o.charAt(b+2)),S=a.indexOf(o.charAt(b+3)),b+2===u-1){W=(F=d<<18|m<<12|g<<6)>>16&255,A=F>>8&255,N+=String.fromCharCode(W,A);break}if(b+1===u-1){W=(F=d<<18|m<<12)>>16&255,N+=String.fromCharCode(W);break}W=(F=d<<18|m<<12|g<<6|S)>>16&255,A=F>>8&255,N+=String.fromCharCode(W,A,255&F)}return N},E.prototype._decodeJwt=function(o){if(this._isEmpty(o))return null;var u=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(o);return!u||u.length<4?(this.warn("The returned id_token is not parseable."),null):{header:u[1],JWSPayload:u[2],JWSSig:u[3]}},E.prototype._convertUrlSafeToRegularBase64EncodedString=function(o){return o.replace("-","+").replace("_","/")},E.prototype._serialize=function(o,a,u){var d=[];if(null!==a){d.push("?response_type="+o),d.push("client_id="+encodeURIComponent(a.clientId)),u&&d.push("resource="+encodeURIComponent(u)),d.push("redirect_uri="+encodeURIComponent(a.redirectUri)),d.push("state="+encodeURIComponent(a.state)),a.hasOwnProperty("slice")&&d.push("slice="+encodeURIComponent(a.slice)),a.hasOwnProperty("extraQueryParameter")&&d.push(a.extraQueryParameter);var m=a.correlationId?a.correlationId:this._guid();d.push("client-request-id="+encodeURIComponent(m))}return d.join("&")},E.prototype._deserialize=function(o){var a,u=/\+/g,d=/([^&=]+)=([^&]*)/g,m=function(S){return decodeURIComponent(S.replace(u," "))},g={};for(a=d.exec(o);a;)g[m(a[1])]=m(a[2]),a=d.exec(o);return g},E.prototype._decimalToHex=function(o){for(var a=o.toString(16);a.length<2;)a="0"+a;return a},E.prototype._guid=function(){var o=window.crypto||window.msCrypto;if(o&&o.getRandomValues){var a=new Uint8Array(16);return o.getRandomValues(a),a[6]|=64,a[6]&=79,a[8]|=128,a[8]&=191,this._decimalToHex(a[0])+this._decimalToHex(a[1])+this._decimalToHex(a[2])+this._decimalToHex(a[3])+"-"+this._decimalToHex(a[4])+this._decimalToHex(a[5])+"-"+this._decimalToHex(a[6])+this._decimalToHex(a[7])+"-"+this._decimalToHex(a[8])+this._decimalToHex(a[9])+"-"+this._decimalToHex(a[10])+this._decimalToHex(a[11])+this._decimalToHex(a[12])+this._decimalToHex(a[13])+this._decimalToHex(a[14])+this._decimalToHex(a[15])}for(var u="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",d="0123456789abcdef",m=0,g="",S=0;S<36;S++)"-"!==u[S]&&"4"!==u[S]&&(m=16*Math.random()|0),"x"===u[S]?g+=d[m]:"y"===u[S]?(m&=3,g+=d[m|=8]):g+=u[S];return g},E.prototype._expiresIn=function(o){return o||(o=3599),this._now()+parseInt(o,10)},E.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},E.prototype._addAdalFrame=function(o){if(void 0!==o){this.info("Add adal frame to document:"+o);var a=document.getElementById(o);if(!a){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var u=document.createElement("iframe");u.setAttribute("id",o),u.setAttribute("aria-hidden","true"),u.style.visibility="hidden",u.style.position="absolute",u.style.width=u.style.height=u.borderWidth="0px",a=document.getElementsByTagName("body")[0].appendChild(u)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+o+'" id="'+o+'" style="display:none"></iframe>');window.frames&&window.frames[o]&&(a=window.frames[o])}return a}},E.prototype._saveItem=function(o,a,u){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(u){var d=this._getItem(o)||"";localStorage.setItem(o,d+a+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(o,a);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(o,a),!0):(this.info("Session storage is not supported"),!1)},E.prototype._getItem=function(o){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(o):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(o):(this.info("Session storage is not supported"),null)},E.prototype._supportsLocalStorage=function(){try{return!(!window.localStorage||(window.localStorage.setItem("storageTest","A"),"A"!=window.localStorage.getItem("storageTest"))||(window.localStorage.removeItem("storageTest"),window.localStorage.getItem("storageTest")))}catch(o){return!1}},E.prototype._supportsSessionStorage=function(){try{return!(!window.sessionStorage||(window.sessionStorage.setItem("storageTest","A"),"A"!=window.sessionStorage.getItem("storageTest"))||(window.sessionStorage.removeItem("storageTest"),window.sessionStorage.getItem("storageTest")))}catch(o){return!1}},E.prototype._cloneConfig=function(o){if(null===o||"object"!=typeof o)return o;var a={};for(var u in o)o.hasOwnProperty(u)&&(a[u]=o[u]);return a},E.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},E.prototype.log=function(o,a,u,d){if(o<=Logging.level){if(!Logging.piiLoggingEnabled&&d)return;var m=(new Date).toUTCString(),g="";g=this.config.correlationId?m+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[o]+" "+a:m+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[o]+" "+a,u&&(g+="\nstack:\n"+u.stack),Logging.log(g)}},E.prototype.error=function(o,a){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,o,a)},E.prototype.warn=function(o){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,o,null)},E.prototype.info=function(o){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,o,null)},E.prototype.verbose=function(o){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,o,null)},E.prototype.errorPii=function(o,a){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,o,a,!0)},E.prototype.warnPii=function(o){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,o,null,!0)},E.prototype.infoPii=function(o){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,o,null,!0)},E.prototype.verbosePii=function(o){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,o,null,!0)},E.prototype._libVersion=function(){return"1.0.18"},_.exports&&(_.exports=E,_.exports.inject=function(o){return new E(o)}),E}()},20486:(module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Tg:()=>AuthConfig,zr:()=>OAuthModule,Ct:()=>OAuthService});var _angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(6435),_angular_common__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(69808),_angular_common_http__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(40520),tslib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(65168),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8929),rxjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(21086),rxjs__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(5254),rxjs__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(61946),rxjs__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(61737),rxjs__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(36053),rxjs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(36787),rxjs_operators__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(92198),rxjs_operators__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(22868),rxjs_operators__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(80013),rxjs_operators__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(40943),rxjs_operators__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(87545),rxjs_operators__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(24850),rxjs_operators__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(87224),rxjs_operators__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(27221),rxjs_operators__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(46227),rxjs_operators__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(72986),rxjs_operators__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(61709),fast_sha256__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1302),fast_sha256__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(fast_sha256__WEBPACK_IMPORTED_MODULE_0__);module=__webpack_require__.hmd(module);class DateTimeProvider{}let SystemDateTimeProvider=(()=>{class _ extends DateTimeProvider{now(){return Date.now()}new(){return new Date}}return _.\u0275fac=function(){let E;return function(a){return(E||(E=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275getInheritedFactory(_)))(a||_)}}(),_.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac}),_})();class LoginOptions{constructor(){this.disableNonceCheck=!1,this.preventClearHashAfterLogin=!1}}class OAuthLogger{}class OAuthStorage{}let MemoryStorage=(()=>{class _{constructor(){this.data=new Map}getItem(o){return this.data.get(o)}removeItem(o){this.data.delete(o)}setItem(o,a){this.data.set(o,a)}}return _.\u0275fac=function(o){return new(o||_)},_.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac}),_})();class ReceivedTokens{}function b64DecodeUnicode(_){const E=_.replace(/\-/g,"+").replace(/\_/g,"/");return decodeURIComponent(atob(E).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function base64UrlEncode(_){return btoa(_).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}class ValidationHandler{}class AbstractValidationHandler{validateAtHash(E){return(0,tslib__WEBPACK_IMPORTED_MODULE_2__.mG)(this,void 0,void 0,function*(){let o=this.inferHashAlgorithm(E.idTokenHeader),a=yield this.calcHash(E.accessToken,o),d=base64UrlEncode(a.substr(0,a.length/2)),m=E.idTokenClaims.at_hash.replace(/=/g,"");return d!==m&&(console.error("exptected at_hash: "+d),console.error("actual at_hash: "+m)),d===m})}inferHashAlgorithm(E){let o=E.alg;if(!o.match(/^.S[0-9]{3}$/))throw new Error("Algorithm not supported: "+o);return"sha-"+o.substr(2)}}let UrlHelperService=(()=>{class _{getHashFragmentParams(o){let a=o||window.location.hash;if(a=decodeURIComponent(a),0!==a.indexOf("#"))return{};const u=a.indexOf("?");return a=a.substr(u>-1?u+1:1),this.parseQueryString(a)}parseQueryString(o){const a={};let u,d,m,g,S,F,W;if(null===o)return a;u=o.split("&");for(let A=0;A<u.length;A++)d=u[A],m=d.indexOf("="),-1===m?(g=d,S=null):(g=d.substr(0,m),S=d.substr(m+1)),F=decodeURIComponent(g),W=decodeURIComponent(S),"/"===F.substr(0,1)&&(F=F.substr(1)),a[F]=W;return a}}return _.\u0275fac=function(o){return new(o||_)},_.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac}),_})();class OAuthEvent{constructor(E){this.type=E}}class OAuthSuccessEvent extends OAuthEvent{constructor(E,o=null){super(E),this.info=o}}class OAuthInfoEvent extends OAuthEvent{constructor(E,o=null){super(E),this.info=o}}class OAuthErrorEvent extends OAuthEvent{constructor(E,o,a=null){super(E),this.reason=o,this.params=a}}class AuthConfig{constructor(E){this.clientId="",this.redirectUri="",this.postLogoutRedirectUri="",this.redirectUriAsPostLogoutRedirectUriFallback=!0,this.loginUrl="",this.scope="openid profile",this.resource="",this.rngUrl="",this.oidc=!0,this.requestAccessToken=!0,this.options=null,this.issuer="",this.logoutUrl="",this.clearHashAfterLogin=!0,this.tokenEndpoint=null,this.revocationEndpoint=null,this.customTokenParameters=[],this.userinfoEndpoint=null,this.responseType="",this.showDebugInformation=!1,this.silentRefreshRedirectUri="",this.silentRefreshMessagePrefix="",this.silentRefreshShowIFrame=!1,this.siletRefreshTimeout=2e4,this.silentRefreshTimeout=2e4,this.dummyClientSecret=null,this.requireHttps="remoteOnly",this.strictDiscoveryDocumentValidation=!0,this.jwks=null,this.customQueryParams=null,this.silentRefreshIFrameName="angular-oauth-oidc-silent-refresh-iframe",this.timeoutFactor=.75,this.sessionChecksEnabled=!1,this.sessionCheckIntervall=3e3,this.sessionCheckIFrameUrl=null,this.sessionCheckIFrameName="angular-oauth-oidc-check-session-iframe",this.disableAtHashCheck=!1,this.skipSubjectCheck=!1,this.useIdTokenHintForSilentRefresh=!1,this.skipIssuerCheck=!1,this.nonceStateSeparator=";",this.useHttpBasicAuth=!1,this.waitForTokenInMsec=0,this.disablePKCE=!1,this.openUri=o=>{location.href=o},E&&Object.assign(this,E)}}class WebHttpUrlEncodingCodec{encodeKey(E){return encodeURIComponent(E)}encodeValue(E){return encodeURIComponent(E)}decodeKey(E){return decodeURIComponent(E)}decodeValue(E){return decodeURIComponent(E)}}function factory(){var ERROR="input is invalid type",WINDOW="object"==typeof window,root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==typeof self,NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&module.exports,AMD="function"==typeof define&&__webpack_require__.amdO,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer;const HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"];var blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(_){return"[object Array]"===Object.prototype.toString.call(_)}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(_){return"object"==typeof _&&_.buffer&&_.buffer.constructor===ArrayBuffer});var createOutputMethod=function(_,E){return function(o){return new Sha256(E,!0).update(o)[_]()}},createMethod=function(_){var E=createOutputMethod("hex",_);NODE_JS&&(E=nodeWrap(E,_)),E.create=function(){return new Sha256(_)},E.update=function(u){return E.create().update(u)};for(var o=0;o<OUTPUT_TYPES.length;++o){var a=OUTPUT_TYPES[o];E[a]=createOutputMethod(a,_)}return E},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(_){if("string"==typeof _)return crypto.createHash(algorithm).update(_,"utf8").digest("hex");if(null==_)throw new Error(ERROR);return _.constructor===ArrayBuffer&&(_=new Uint8Array(_)),Array.isArray(_)||ArrayBuffer.isView(_)||_.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(_)).digest("hex"):method(_)};return nodeMethod},createHmacOutputMethod=function(_,E){return function(o,a){return new HmacSha256(o,E,!0).update(a)[_]()}},createHmacMethod=function(_){var E=createHmacOutputMethod("hex",_);E.create=function(u){return new HmacSha256(u,_)},E.update=function(u,d){return E.create(u).update(d)};for(var o=0;o<OUTPUT_TYPES.length;++o){var a=OUTPUT_TYPES[o];E[a]=createHmacOutputMethod(a,_)}return E};function Sha256(_,E){E?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=_}function HmacSha256(_,E,o){var a,u=typeof _;if("string"===u){var S,d=[],m=_.length,g=0;for(a=0;a<m;++a)(S=_.charCodeAt(a))<128?d[g++]=S:S<2048?(d[g++]=192|S>>6,d[g++]=128|63&S):S<55296||S>=57344?(d[g++]=224|S>>12,d[g++]=128|S>>6&63,d[g++]=128|63&S):(S=65536+((1023&S)<<10|1023&_.charCodeAt(++a)),d[g++]=240|S>>18,d[g++]=128|S>>12&63,d[g++]=128|S>>6&63,d[g++]=128|63&S);_=d}else{if("object"!==u)throw new Error(ERROR);if(null===_)throw new Error(ERROR);if(ARRAY_BUFFER&&_.constructor===ArrayBuffer)_=new Uint8Array(_);else if(!(Array.isArray(_)||ARRAY_BUFFER&&ArrayBuffer.isView(_)))throw new Error(ERROR)}_.length>64&&(_=new Sha256(E,!0).update(_).array());var F=[],W=[];for(a=0;a<64;++a){var A=_[a]||0;F[a]=92^A,W[a]=54^A}Sha256.call(this,E,o),this.update(W),this.oKeyPad=F,this.inner=!0,this.sharedMemory=o}Sha256.prototype.update=function(_){if(!this.finalized){var E,o=typeof _;if("string"!==o){if("object"!==o)throw new Error(ERROR);if(null===_)throw new Error(ERROR);if(ARRAY_BUFFER&&_.constructor===ArrayBuffer)_=new Uint8Array(_);else if(!(Array.isArray(_)||ARRAY_BUFFER&&ArrayBuffer.isView(_)))throw new Error(ERROR);E=!0}for(var a,d,u=0,m=_.length,g=this.blocks;u<m;){if(this.hashed&&(this.hashed=!1,g[0]=this.block,g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0),E)for(d=this.start;u<m&&d<64;++u)g[d>>2]|=_[u]<<SHIFT[3&d++];else for(d=this.start;u<m&&d<64;++u)(a=_.charCodeAt(u))<128?g[d>>2]|=a<<SHIFT[3&d++]:a<2048?(g[d>>2]|=(192|a>>6)<<SHIFT[3&d++],g[d>>2]|=(128|63&a)<<SHIFT[3&d++]):a<55296||a>=57344?(g[d>>2]|=(224|a>>12)<<SHIFT[3&d++],g[d>>2]|=(128|a>>6&63)<<SHIFT[3&d++],g[d>>2]|=(128|63&a)<<SHIFT[3&d++]):(a=65536+((1023&a)<<10|1023&_.charCodeAt(++u)),g[d>>2]|=(240|a>>18)<<SHIFT[3&d++],g[d>>2]|=(128|a>>12&63)<<SHIFT[3&d++],g[d>>2]|=(128|a>>6&63)<<SHIFT[3&d++],g[d>>2]|=(128|63&a)<<SHIFT[3&d++]);this.lastByteIndex=d,this.bytes+=d-this.start,d>=64?(this.block=g[16],this.start=d-64,this.hash(),this.hashed=!0):this.start=d}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var _=this.blocks,E=this.lastByteIndex;_[16]=this.block,_[E>>2]|=EXTRA[3&E],this.block=_[16],E>=56&&(this.hashed||this.hash(),_[0]=this.block,_[16]=_[1]=_[2]=_[3]=_[4]=_[5]=_[6]=_[7]=_[8]=_[9]=_[10]=_[11]=_[12]=_[13]=_[14]=_[15]=0),_[14]=this.hBytes<<3|this.bytes>>>29,_[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var F,N,C,H,M,re,_=this.h0,E=this.h1,o=this.h2,a=this.h3,u=this.h4,d=this.h5,m=this.h6,g=this.h7,S=this.blocks;for(F=16;F<64;++F)S[F]=S[F-16]+(((N=S[F-15])>>>7|N<<25)^(N>>>18|N<<14)^N>>>3)+S[F-7]+(((N=S[F-2])>>>17|N<<15)^(N>>>19|N<<13)^N>>>10)<<0;for(re=E&o,F=0;F<64;F+=4)this.first?(this.is224?(C=300032,g=(N=S[0]-1413257819)-150054599<<0,a=N+24177077<<0):(C=704751109,g=(N=S[0]-210244248)-1521486534<<0,a=N+143694565<<0),this.first=!1):(g=a+(N=g+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&d^~u&m)+K[F]+S[F])<<0,a=N+(((_>>>2|_<<30)^(_>>>13|_<<19)^(_>>>22|_<<10))+((C=_&E)^_&o^re))<<0),m=o+(N=m+((g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&u^~g&d)+K[F+1]+S[F+1])<<0,o=N+(((a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10))+((H=a&_)^a&E^C))<<0,d=E+(N=d+((m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&g^~m&u)+K[F+2]+S[F+2])<<0,E=N+(((o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10))+((M=o&a)^o&_^H))<<0,u=_+(N=u+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(d&m^~d&g)+K[F+3]+S[F+3])<<0,_=N+(((E>>>2|E<<30)^(E>>>13|E<<19)^(E>>>22|E<<10))+((re=E&o)^E&a^M))<<0;this.h0=this.h0+_<<0,this.h1=this.h1+E<<0,this.h2=this.h2+o<<0,this.h3=this.h3+a<<0,this.h4=this.h4+u<<0,this.h5=this.h5+d<<0,this.h6=this.h6+m<<0,this.h7=this.h7+g<<0},Sha256.prototype.hex=function(){this.finalize();var _=this.h0,E=this.h1,o=this.h2,a=this.h3,u=this.h4,d=this.h5,m=this.h6,g=this.h7,S=HEX_CHARS[_>>28&15]+HEX_CHARS[_>>24&15]+HEX_CHARS[_>>20&15]+HEX_CHARS[_>>16&15]+HEX_CHARS[_>>12&15]+HEX_CHARS[_>>8&15]+HEX_CHARS[_>>4&15]+HEX_CHARS[15&_]+HEX_CHARS[E>>28&15]+HEX_CHARS[E>>24&15]+HEX_CHARS[E>>20&15]+HEX_CHARS[E>>16&15]+HEX_CHARS[E>>12&15]+HEX_CHARS[E>>8&15]+HEX_CHARS[E>>4&15]+HEX_CHARS[15&E]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]+HEX_CHARS[u>>28&15]+HEX_CHARS[u>>24&15]+HEX_CHARS[u>>20&15]+HEX_CHARS[u>>16&15]+HEX_CHARS[u>>12&15]+HEX_CHARS[u>>8&15]+HEX_CHARS[u>>4&15]+HEX_CHARS[15&u]+HEX_CHARS[d>>28&15]+HEX_CHARS[d>>24&15]+HEX_CHARS[d>>20&15]+HEX_CHARS[d>>16&15]+HEX_CHARS[d>>12&15]+HEX_CHARS[d>>8&15]+HEX_CHARS[d>>4&15]+HEX_CHARS[15&d]+HEX_CHARS[m>>28&15]+HEX_CHARS[m>>24&15]+HEX_CHARS[m>>20&15]+HEX_CHARS[m>>16&15]+HEX_CHARS[m>>12&15]+HEX_CHARS[m>>8&15]+HEX_CHARS[m>>4&15]+HEX_CHARS[15&m];return this.is224||(S+=HEX_CHARS[g>>28&15]+HEX_CHARS[g>>24&15]+HEX_CHARS[g>>20&15]+HEX_CHARS[g>>16&15]+HEX_CHARS[g>>12&15]+HEX_CHARS[g>>8&15]+HEX_CHARS[g>>4&15]+HEX_CHARS[15&g]),S},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var _=this.h0,E=this.h1,o=this.h2,a=this.h3,u=this.h4,d=this.h5,m=this.h6,g=this.h7,S=[_>>24&255,_>>16&255,_>>8&255,255&_,E>>24&255,E>>16&255,E>>8&255,255&E,o>>24&255,o>>16&255,o>>8&255,255&o,a>>24&255,a>>16&255,a>>8&255,255&a,u>>24&255,u>>16&255,u>>8&255,255&u,d>>24&255,d>>16&255,d>>8&255,255&d,m>>24&255,m>>16&255,m>>8&255,255&m];return this.is224||S.push(g>>24&255,g>>16&255,g>>8&255,255&g),S},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var _=new ArrayBuffer(this.is224?28:32),E=new DataView(_);return E.setUint32(0,this.h0),E.setUint32(4,this.h1),E.setUint32(8,this.h2),E.setUint32(12,this.h3),E.setUint32(16,this.h4),E.setUint32(20,this.h5),E.setUint32(24,this.h6),this.is224||E.setUint32(28,this.h7),_},HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var _=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(_),Sha256.prototype.finalize.call(this)}};var exports=createMethod();return exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),exports}const sha256=factory();class HashHandler{}function decodeUTF8(_){if("string"!=typeof _)throw new TypeError("expected string");var E,o=_,a=new Uint8Array(o.length);for(E=0;E<o.length;E++)a[E]=o.charCodeAt(E);return a}function encodeUTF8(_){var E,o=[];for(E=0;E<_.length;E++)o.push(String.fromCharCode(_[E]));return o.join("")}let DefaultHashHandler=(()=>{class _{calcHash(o,a){return(0,tslib__WEBPACK_IMPORTED_MODULE_2__.mG)(this,void 0,void 0,function*(){return encodeUTF8(fast_sha256__WEBPACK_IMPORTED_MODULE_0___default()(decodeUTF8(o)))})}toHashString2(o){let a="";for(let u of o)a+=String.fromCharCode(u);return a}toHashString(o){const a=new Uint8Array(o);let u="";for(let d of a)u+=String.fromCharCode(d);return u}}return _.\u0275fac=function(o){return new(o||_)},_.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac}),_})(),OAuthService=(()=>{class _ extends AuthConfig{constructor(o,a,u,d,m,g,S,F,W,A){var B;super(),this.ngZone=o,this.http=a,this.config=m,this.urlHelper=g,this.logger=S,this.crypto=F,this.dateTimeService=A,this.discoveryDocumentLoaded=!1,this.state="",this.eventsSubject=new rxjs__WEBPACK_IMPORTED_MODULE_3__.xQ,this.discoveryDocumentLoadedSubject=new rxjs__WEBPACK_IMPORTED_MODULE_3__.xQ,this.grantTypesSupported=[],this.inImplicitFlow=!1,this.saveNoncesInLocalStorage=!1,this.debug("angular-oauth2-oidc v10"),this.document=W,m||(m={}),this.discoveryDocumentLoaded$=this.discoveryDocumentLoadedSubject.asObservable(),this.events=this.eventsSubject.asObservable(),d&&(this.tokenValidationHandler=d),m&&this.configure(m);try{u?this.setStorage(u):"undefined"!=typeof sessionStorage&&this.setStorage(sessionStorage)}catch(N){console.error("No OAuthStorage provided and cannot access default (sessionStorage).Consider providing a custom OAuthStorage implementation in your module.",N)}if("undefined"!=typeof window&&void 0!==window.localStorage){const N=null===(B=null==window?void 0:window.navigator)||void 0===B?void 0:B.userAgent;((null==N?void 0:N.includes("MSIE "))||(null==N?void 0:N.includes("Trident")))&&(this.saveNoncesInLocalStorage=!0)}this.setupRefreshTimer()}configure(o){Object.assign(this,new AuthConfig,o),this.config=Object.assign({},new AuthConfig,o),this.sessionChecksEnabled&&this.setupSessionCheck(),this.configChanged()}configChanged(){this.setupRefreshTimer()}restartSessionChecksIfStillLoggedIn(){this.hasValidIdToken()&&this.initSessionCheck()}restartRefreshTimerIfStillLoggedIn(){this.setupExpirationTimers()}setupSessionCheck(){this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(o=>"token_received"===o.type)).subscribe(o=>{this.initSessionCheck()})}setupAutomaticSilentRefresh(o={},a,u=!0){let d=!0;this.clearAutomaticRefreshTimer(),this.automaticRefreshSubscription=this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.b)(m=>{"token_received"===m.type?d=!0:"logout"===m.type&&(d=!1)}),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(m=>"token_expires"===m.type&&(null==a||"any"===a||m.info===a)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_6__.b)(1e3)).subscribe(m=>{d&&this.refreshInternal(o,u).catch(g=>{this.debug("Automatic silent refresh did not work")})}),this.restartRefreshTimerIfStillLoggedIn()}refreshInternal(o,a){return this.useSilentRefresh||"code"!==this.responseType?this.silentRefresh(o,a):this.refreshToken()}loadDiscoveryDocumentAndTryLogin(o=null){return this.loadDiscoveryDocument().then(a=>this.tryLogin(o))}loadDiscoveryDocumentAndLogin(o=null){return this.loadDiscoveryDocumentAndTryLogin(o=o||{}).then(a=>!(!this.hasValidIdToken()||!this.hasValidAccessToken())||(this.initLoginFlow("string"==typeof o.state?o.state:""),!1))}debug(...o){this.showDebugInformation&&this.logger.debug.apply(this.logger,o)}validateUrlFromDiscoveryDocument(o){const a=[],u=this.validateUrlForHttps(o),d=this.validateUrlAgainstIssuer(o);return u||a.push("https for all urls required. Also for urls received by discovery."),d||a.push("Every url in discovery document has to start with the issuer url.Also see property strictDiscoveryDocumentValidation."),a}validateUrlForHttps(o){if(!o)return!0;const a=o.toLowerCase();return!(!1!==this.requireHttps&&(!a.match(/^http:\/\/localhost($|[:\/])/)&&!a.match(/^http:\/\/localhost($|[:\/])/)||"remoteOnly"!==this.requireHttps))||a.startsWith("https://")}assertUrlNotNullAndCorrectProtocol(o,a){if(!o)throw new Error(`'${a}' should not be null`);if(!this.validateUrlForHttps(o))throw new Error(`'${a}' must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).`)}validateUrlAgainstIssuer(o){return!this.strictDiscoveryDocumentValidation||!o||o.toLowerCase().startsWith(this.issuer.toLowerCase())}setupRefreshTimer(){"undefined"!=typeof window?((this.hasValidIdToken()||this.hasValidAccessToken())&&(this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()),this.tokenReceivedSubscription&&this.tokenReceivedSubscription.unsubscribe(),this.tokenReceivedSubscription=this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(o=>"token_received"===o.type)).subscribe(o=>{this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.setupExpirationTimers()})):this.debug("timer not supported on this plattform")}setupExpirationTimers(){this.hasValidAccessToken()&&this.setupAccessTokenTimer(),this.hasValidIdToken()&&this.setupIdTokenTimer()}setupAccessTokenTimer(){const o=this.getAccessTokenExpiration(),a=this.getAccessTokenStoredAt(),u=this.calcTimeout(a,o);this.ngZone.runOutsideAngular(()=>{this.accessTokenTimeoutSubscription=(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(new OAuthInfoEvent("token_expires","access_token")).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.g)(u)).subscribe(d=>{this.ngZone.run(()=>{this.eventsSubject.next(d)})})})}setupIdTokenTimer(){const o=this.getIdTokenExpiration(),a=this.getIdTokenStoredAt(),u=this.calcTimeout(a,o);this.ngZone.runOutsideAngular(()=>{this.idTokenTimeoutSubscription=(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(new OAuthInfoEvent("token_expires","id_token")).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.g)(u)).subscribe(d=>{this.ngZone.run(()=>{this.eventsSubject.next(d)})})})}stopAutomaticRefresh(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.clearAutomaticRefreshTimer()}clearAccessTokenTimer(){this.accessTokenTimeoutSubscription&&this.accessTokenTimeoutSubscription.unsubscribe()}clearIdTokenTimer(){this.idTokenTimeoutSubscription&&this.idTokenTimeoutSubscription.unsubscribe()}clearAutomaticRefreshTimer(){this.automaticRefreshSubscription&&this.automaticRefreshSubscription.unsubscribe()}calcTimeout(o,a){const u=this.dateTimeService.now();return Math.max(0,(a-o)*this.timeoutFactor-(u-o))}setStorage(o){this._storage=o,this.configChanged()}loadDiscoveryDocument(o=null){return new Promise((a,u)=>{o||((o=this.issuer||"").endsWith("/")||(o+="/"),o+=".well-known/openid-configuration"),this.validateUrlForHttps(o)?this.http.get(o).subscribe(d=>{if(!this.validateDiscoveryDocument(d))return this.eventsSubject.next(new OAuthErrorEvent("discovery_document_validation_error",null)),void u("discovery_document_validation_error");this.loginUrl=d.authorization_endpoint,this.logoutUrl=d.end_session_endpoint||this.logoutUrl,this.grantTypesSupported=d.grant_types_supported,this.issuer=d.issuer,this.tokenEndpoint=d.token_endpoint,this.userinfoEndpoint=d.userinfo_endpoint||this.userinfoEndpoint,this.jwksUri=d.jwks_uri,this.sessionCheckIFrameUrl=d.check_session_iframe||this.sessionCheckIFrameUrl,this.discoveryDocumentLoaded=!0,this.discoveryDocumentLoadedSubject.next(d),this.revocationEndpoint=d.revocation_endpoint||this.revocationEndpoint,this.sessionChecksEnabled&&this.restartSessionChecksIfStillLoggedIn(),this.loadJwks().then(m=>{const S=new OAuthSuccessEvent("discovery_document_loaded",{discoveryDocument:d,jwks:m});this.eventsSubject.next(S),a(S)}).catch(m=>{this.eventsSubject.next(new OAuthErrorEvent("discovery_document_load_error",m)),u(m)})},d=>{this.logger.error("error loading discovery document",d),this.eventsSubject.next(new OAuthErrorEvent("discovery_document_load_error",d)),u(d)}):u("issuer  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).")})}loadJwks(){return new Promise((o,a)=>{this.jwksUri?this.http.get(this.jwksUri).subscribe(u=>{this.jwks=u,this.eventsSubject.next(new OAuthSuccessEvent("discovery_document_loaded")),o(u)},u=>{this.logger.error("error loading jwks",u),this.eventsSubject.next(new OAuthErrorEvent("jwks_load_error",u)),a(u)}):o(null)})}validateDiscoveryDocument(o){let a;return this.skipIssuerCheck||o.issuer===this.issuer?(a=this.validateUrlFromDiscoveryDocument(o.authorization_endpoint),a.length>0?(this.logger.error("error validating authorization_endpoint in discovery document",a),!1):(a=this.validateUrlFromDiscoveryDocument(o.end_session_endpoint),a.length>0?(this.logger.error("error validating end_session_endpoint in discovery document",a),!1):(a=this.validateUrlFromDiscoveryDocument(o.token_endpoint),a.length>0&&this.logger.error("error validating token_endpoint in discovery document",a),a=this.validateUrlFromDiscoveryDocument(o.revocation_endpoint),a.length>0&&this.logger.error("error validating revocation_endpoint in discovery document",a),a=this.validateUrlFromDiscoveryDocument(o.userinfo_endpoint),a.length>0?(this.logger.error("error validating userinfo_endpoint in discovery document",a),!1):(a=this.validateUrlFromDiscoveryDocument(o.jwks_uri),a.length>0?(this.logger.error("error validating jwks_uri in discovery document",a),!1):(this.sessionChecksEnabled&&!o.check_session_iframe&&this.logger.warn("sessionChecksEnabled is activated but discovery document does not contain a check_session_iframe field"),!0))))):(this.logger.error("invalid issuer in discovery document","expected: "+this.issuer,"current: "+o.issuer),!1)}fetchTokenUsingPasswordFlowAndLoadUserProfile(o,a,u=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.WM){return this.fetchTokenUsingPasswordFlow(o,a,u).then(()=>this.loadUserProfile())}loadUserProfile(){if(!this.hasValidAccessToken())throw new Error("Can not load User Profile without access_token");if(!this.validateUrlForHttps(this.userinfoEndpoint))throw new Error("userinfoEndpoint must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");return new Promise((o,a)=>{const u=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.WM).set("Authorization","Bearer "+this.getAccessToken());this.http.get(this.userinfoEndpoint,{headers:u,observe:"response",responseType:"text"}).subscribe(d=>{if(this.debug("userinfo received",JSON.stringify(d)),d.headers.get("content-type").startsWith("application/json")){let m=JSON.parse(d.body);const g=this.getIdentityClaims()||{};if(!this.skipSubjectCheck&&this.oidc&&(!g.sub||m.sub!==g.sub))return void a("if property oidc is true, the received user-id (sub) has to be the user-id of the user that has logged in with oidc.\nif you are not using oidc but just oauth2 password flow set oidc to false");m=Object.assign({},g,m),this._storage.setItem("id_token_claims_obj",JSON.stringify(m)),this.eventsSubject.next(new OAuthSuccessEvent("user_profile_loaded")),o({info:m})}else this.debug("userinfo is not JSON, treating it as JWE/JWS"),this.eventsSubject.next(new OAuthSuccessEvent("user_profile_loaded")),o(JSON.parse(d.body))},d=>{this.logger.error("error loading user info",d),this.eventsSubject.next(new OAuthErrorEvent("user_profile_load_error",d)),a(d)})})}fetchTokenUsingPasswordFlow(o,a,u=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.WM){return this.fetchTokenUsingGrant("password",{username:o,password:a},u)}fetchTokenUsingGrant(o,a,u=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.WM){this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let d=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.LE({encoder:new WebHttpUrlEncodingCodec}).set("grant_type",o).set("scope",this.scope);if(this.useHttpBasicAuth){const m=btoa(`${this.clientId}:${this.dummyClientSecret}`);u=u.set("Authorization","Basic "+m)}if(this.useHttpBasicAuth||(d=d.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(d=d.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const m of Object.getOwnPropertyNames(this.customQueryParams))d=d.set(m,this.customQueryParams[m]);for(const m of Object.keys(a))d=d.set(m,a[m]);return u=u.set("Content-Type","application/x-www-form-urlencoded"),new Promise((m,g)=>{this.http.post(this.tokenEndpoint,d,{headers:u}).subscribe(S=>{this.debug("tokenResponse",S),this.storeAccessTokenResponse(S.access_token,S.refresh_token,S.expires_in||this.fallbackAccessTokenExpirationTimeInSec,S.scope,this.extractRecognizedCustomParameters(S)),this.oidc&&S.id_token&&this.processIdToken(S.id_token,S.access_token).then(F=>{this.storeIdToken(F),m(S)}),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),m(S)},S=>{this.logger.error("Error performing ${grantType} flow",S),this.eventsSubject.next(new OAuthErrorEvent("token_error",S)),g(S)})})}refreshToken(){return this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint"),new Promise((o,a)=>{let u=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.LE({encoder:new WebHttpUrlEncodingCodec}).set("grant_type","refresh_token").set("scope",this.scope).set("refresh_token",this._storage.getItem("refresh_token")),d=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.WM).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const m=btoa(`${this.clientId}:${this.dummyClientSecret}`);d=d.set("Authorization","Basic "+m)}if(this.useHttpBasicAuth||(u=u.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(u=u.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const m of Object.getOwnPropertyNames(this.customQueryParams))u=u.set(m,this.customQueryParams[m]);this.http.post(this.tokenEndpoint,u,{headers:d}).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_10__.w)(m=>m.id_token?(0,rxjs__WEBPACK_IMPORTED_MODULE_11__.D)(this.processIdToken(m.id_token,m.access_token,!0)).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_5__.b)(g=>this.storeIdToken(g)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.U)(g=>m)):(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(m))).subscribe(m=>{this.debug("refresh tokenResponse",m),this.storeAccessTokenResponse(m.access_token,m.refresh_token,m.expires_in||this.fallbackAccessTokenExpirationTimeInSec,m.scope,this.extractRecognizedCustomParameters(m)),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),o(m)},m=>{this.logger.error("Error refreshing token",m),this.eventsSubject.next(new OAuthErrorEvent("token_refresh_error",m)),a(m)})})}removeSilentRefreshEventListener(){this.silentRefreshPostMessageEventListener&&(window.removeEventListener("message",this.silentRefreshPostMessageEventListener),this.silentRefreshPostMessageEventListener=null)}setupSilentRefreshEventListener(){this.removeSilentRefreshEventListener(),this.silentRefreshPostMessageEventListener=o=>{const a=this.processMessageEventMessage(o);this.tryLogin({customHashFragment:a,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri||this.redirectUri}).catch(u=>this.debug("tryLogin during silent refresh failed",u))},window.addEventListener("message",this.silentRefreshPostMessageEventListener)}silentRefresh(o={},a=!0){const u=this.getIdentityClaims()||{};if(this.useIdTokenHintForSilentRefresh&&this.hasValidIdToken()&&(o.id_token_hint=this.getIdToken()),!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(void 0===this.document)throw new Error("silent refresh is not supported on this platform");const d=this.document.getElementById(this.silentRefreshIFrameName);d&&this.document.body.removeChild(d),this.silentRefreshSubject=u.sub;const m=this.document.createElement("iframe");m.id=this.silentRefreshIFrameName,this.setupSilentRefreshEventListener(),this.createLoginUrl(null,null,this.silentRefreshRedirectUri||this.redirectUri,a,o).then(A=>{m.setAttribute("src",A),this.silentRefreshShowIFrame||(m.style.display="none"),this.document.body.appendChild(m)});const S=this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(A=>A instanceof OAuthErrorEvent),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.P)()),F=this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(A=>"token_received"===A.type),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.P)()),W=(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(new OAuthErrorEvent("silent_refresh_timeout",null)).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_8__.g)(this.silentRefreshTimeout));return(0,rxjs__WEBPACK_IMPORTED_MODULE_14__.S3)([S,F,W]).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.U)(A=>{if(A instanceof OAuthErrorEvent)throw"silent_refresh_timeout"===A.type||(A=new OAuthErrorEvent("silent_refresh_error",A)),this.eventsSubject.next(A),A;return"token_received"===A.type&&(A=new OAuthSuccessEvent("silently_refreshed"),this.eventsSubject.next(A)),A})).toPromise()}initImplicitFlowInPopup(o){return this.initLoginFlowInPopup(o)}initLoginFlowInPopup(o){return o=o||{},this.createLoginUrl(null,null,this.silentRefreshRedirectUri,!1,{display:"popup"}).then(a=>new Promise((u,d)=>{let S,g=null;o.windowRef?o.windowRef&&!o.windowRef.closed&&(g=o.windowRef,g.location.href=a):g=window.open(a,"ngx-oauth2-oidc-login",this.calculatePopupFeatures(o));const F=b=>{this.tryLogin({customHashFragment:b,preventClearHashAfterLogin:!0,customRedirectUri:this.silentRefreshRedirectUri}).then(()=>{A(),u(!0)},f=>{A(),d(f)})};g?S=window.setInterval(()=>{(!g||g.closed)&&(A(),d(new OAuthErrorEvent("popup_closed",{})))},500):d(new OAuthErrorEvent("popup_blocked",{}));const A=()=>{window.clearInterval(S),window.removeEventListener("storage",N),window.removeEventListener("message",B),null!==g&&g.close(),g=null},B=b=>{const f=this.processMessageEventMessage(b);f&&null!==f?(window.removeEventListener("storage",N),F(f)):console.log("false event firing")},N=b=>{"auth_hash"===b.key&&(window.removeEventListener("message",B),F(b.newValue))};window.addEventListener("message",B),window.addEventListener("storage",N)}))}calculatePopupFeatures(o){const a=o.height||470,u=o.width||500,d=window.screenLeft+(window.outerWidth-u)/2;return`location=no,toolbar=no,width=${u},height=${a},top=${window.screenTop+(window.outerHeight-a)/2},left=${d}`}processMessageEventMessage(o){let a="#";if(this.silentRefreshMessagePrefix&&(a+=this.silentRefreshMessagePrefix),!o||!o.data||"string"!=typeof o.data)return;const u=o.data;return u.startsWith(a)?"#"+u.substr(a.length):void 0}canPerformSessionCheck(){return!!this.sessionChecksEnabled&&(this.sessionCheckIFrameUrl?this.getSessionState()?void 0!==this.document:(console.warn("sessionChecksEnabled is activated but there is no session_state"),!1):(console.warn("sessionChecksEnabled is activated but there is no sessionCheckIFrameUrl"),!1))}setupSessionCheckEventListener(){this.removeSessionCheckEventListener(),this.sessionCheckEventListener=o=>{const a=o.origin.toLowerCase(),u=this.issuer.toLowerCase();if(this.debug("sessionCheckEventListener"),u.startsWith(a)){switch(o.data){case"unchanged":this.ngZone.run(()=>{this.handleSessionUnchanged()});break;case"changed":this.ngZone.run(()=>{this.handleSessionChange()});break;case"error":this.ngZone.run(()=>{this.handleSessionError()})}this.debug("got info from session check inframe",o)}else this.debug("sessionCheckEventListener","wrong origin",a,"expected",u,"event",o)},this.ngZone.runOutsideAngular(()=>{window.addEventListener("message",this.sessionCheckEventListener)})}handleSessionUnchanged(){this.debug("session check","session unchanged"),this.eventsSubject.next(new OAuthInfoEvent("session_unchanged"))}handleSessionChange(){this.eventsSubject.next(new OAuthInfoEvent("session_changed")),this.stopSessionCheckTimer(),this.useSilentRefresh||"code"!==this.responseType?this.silentRefreshRedirectUri?(this.silentRefresh().catch(o=>this.debug("silent refresh failed after session changed")),this.waitForSilentRefreshAfterSessionChange()):(this.eventsSubject.next(new OAuthInfoEvent("session_terminated")),this.logOut(!0)):this.refreshToken().then(o=>{this.debug("token refresh after session change worked")}).catch(o=>{this.debug("token refresh did not work after session changed"),this.eventsSubject.next(new OAuthInfoEvent("session_terminated")),this.logOut(!0)})}waitForSilentRefreshAfterSessionChange(){this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(o=>"silently_refreshed"===o.type||"silent_refresh_timeout"===o.type||"silent_refresh_error"===o.type),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_13__.P)()).subscribe(o=>{"silently_refreshed"!==o.type&&(this.debug("silent refresh did not work after session changed"),this.eventsSubject.next(new OAuthInfoEvent("session_terminated")),this.logOut(!0))})}handleSessionError(){this.stopSessionCheckTimer(),this.eventsSubject.next(new OAuthInfoEvent("session_error"))}removeSessionCheckEventListener(){this.sessionCheckEventListener&&(window.removeEventListener("message",this.sessionCheckEventListener),this.sessionCheckEventListener=null)}initSessionCheck(){if(!this.canPerformSessionCheck())return;const o=this.document.getElementById(this.sessionCheckIFrameName);o&&this.document.body.removeChild(o);const a=this.document.createElement("iframe");a.id=this.sessionCheckIFrameName,this.setupSessionCheckEventListener(),a.setAttribute("src",this.sessionCheckIFrameUrl),a.style.display="none",this.document.body.appendChild(a),this.startSessionCheckTimer()}startSessionCheckTimer(){this.stopSessionCheckTimer(),this.ngZone.runOutsideAngular(()=>{this.sessionCheckTimer=setInterval(this.checkSession.bind(this),this.sessionCheckIntervall)})}stopSessionCheckTimer(){this.sessionCheckTimer&&(clearInterval(this.sessionCheckTimer),this.sessionCheckTimer=null)}checkSession(){const o=this.document.getElementById(this.sessionCheckIFrameName);o||this.logger.warn("checkSession did not find iframe",this.sessionCheckIFrameName);const a=this.getSessionState();a||this.stopSessionCheckTimer(),o.contentWindow.postMessage(this.clientId+" "+a,this.issuer)}createLoginUrl(o="",a="",u="",d=!1,m={}){return(0,tslib__WEBPACK_IMPORTED_MODULE_2__.mG)(this,void 0,void 0,function*(){const g=this;let S;S=u||this.redirectUri;const F=yield this.createAndSaveNonce();if(o=o?F+this.config.nonceStateSeparator+encodeURIComponent(o):F,!this.requestAccessToken&&!this.oidc)throw new Error("Either requestAccessToken or oidc or both must be true");this.responseType=this.config.responseType?this.config.responseType:this.oidc&&this.requestAccessToken?"id_token token":this.oidc&&!this.requestAccessToken?"id_token":"token";const W=g.loginUrl.indexOf("?")>-1?"&":"?";let A=g.scope;this.oidc&&!A.match(/(^|\s)openid($|\s)/)&&(A="openid "+A);let B=g.loginUrl+W+"response_type="+encodeURIComponent(g.responseType)+"&client_id="+encodeURIComponent(g.clientId)+"&state="+encodeURIComponent(o)+"&redirect_uri="+encodeURIComponent(S)+"&scope="+encodeURIComponent(A);if(this.responseType.includes("code")&&!this.disablePKCE){const[N,b]=yield this.createChallangeVerifierPairForPKCE();this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.setItem("PKCE_verifier",b):this._storage.setItem("PKCE_verifier",b),B+="&code_challenge="+N,B+="&code_challenge_method=S256"}a&&(B+="&login_hint="+encodeURIComponent(a)),g.resource&&(B+="&resource="+encodeURIComponent(g.resource)),g.oidc&&(B+="&nonce="+encodeURIComponent(F)),d&&(B+="&prompt=none");for(const N of Object.keys(m))B+="&"+encodeURIComponent(N)+"="+encodeURIComponent(m[N]);if(this.customQueryParams)for(const N of Object.getOwnPropertyNames(this.customQueryParams))B+="&"+N+"="+encodeURIComponent(this.customQueryParams[N]);return B})}initImplicitFlowInternal(o="",a=""){if(this.inImplicitFlow)return;if(this.inImplicitFlow=!0,!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let u={},d=null;"string"==typeof a?d=a:"object"==typeof a&&(u=a),this.createLoginUrl(o,d,null,!1,u).then(this.config.openUri).catch(m=>{console.error("Error in initImplicitFlow",m),this.inImplicitFlow=!1})}initImplicitFlow(o="",a=""){""!==this.loginUrl?this.initImplicitFlowInternal(o,a):this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(u=>"discovery_document_loaded"===u.type)).subscribe(u=>this.initImplicitFlowInternal(o,a))}resetImplicitFlow(){this.inImplicitFlow=!1}callOnTokenReceivedIfExists(o){const a=this;if(o.onTokenReceived){const u={idClaims:a.getIdentityClaims(),idToken:a.getIdToken(),accessToken:a.getAccessToken(),state:a.state};o.onTokenReceived(u)}}storeAccessTokenResponse(o,a,u,d,m){if(this._storage.setItem("access_token",o),d&&!Array.isArray(d)?this._storage.setItem("granted_scopes",JSON.stringify(d.split(" "))):d&&Array.isArray(d)&&this._storage.setItem("granted_scopes",JSON.stringify(d)),this._storage.setItem("access_token_stored_at",""+this.dateTimeService.now()),u){const g=1e3*u,F=this.dateTimeService.new().getTime()+g;this._storage.setItem("expires_at",""+F)}a&&this._storage.setItem("refresh_token",a),m&&m.forEach((g,S)=>{this._storage.setItem(S,g)})}tryLogin(o=null){return"code"===this.config.responseType?this.tryLoginCodeFlow(o).then(a=>!0):this.tryLoginImplicitFlow(o)}parseQueryString(o){return o&&0!==o.length?("?"===o.charAt(0)&&(o=o.substr(1)),this.urlHelper.parseQueryString(o)):{}}tryLoginCodeFlow(o=null){const a=(o=o||{}).customHashFragment?o.customHashFragment.substring(1):window.location.search,u=this.getCodePartsFromUrl(a),d=u.code,m=u.state,g=u.session_state;if(!o.preventClearHashAfterLogin){const W=location.origin+location.pathname+location.search.replace(/code=[^&\$]*/,"").replace(/scope=[^&\$]*/,"").replace(/state=[^&\$]*/,"").replace(/session_state=[^&\$]*/,"").replace(/^\?&/,"?").replace(/&$/,"").replace(/^\?$/,"").replace(/&+/g,"&").replace(/\?&/,"?").replace(/\?$/,"")+location.hash;history.replaceState(null,window.name,W)}let[S,F]=this.parseState(m);if(this.state=F,u.error){this.debug("error trying to login"),this.handleLoginError(o,u);const W=new OAuthErrorEvent("code_error",{},u);return this.eventsSubject.next(W),Promise.reject(W)}if(!o.disableNonceCheck){if(!S)return Promise.resolve();if(!o.disableOAuth2StateCheck&&!this.validateNonce(S)){const A=new OAuthErrorEvent("invalid_nonce_in_state",null);return this.eventsSubject.next(A),Promise.reject(A)}return this.storeSessionState(g),d?this.getTokenFromCode(d,o).then(W=>null):Promise.resolve()}}getCodePartsFromUrl(o){return o&&0!==o.length?("?"===o.charAt(0)&&(o=o.substr(1)),this.urlHelper.parseQueryString(o)):this.urlHelper.getHashFragmentParams()}getTokenFromCode(o,a){let u=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.LE({encoder:new WebHttpUrlEncodingCodec}).set("grant_type","authorization_code").set("code",o).set("redirect_uri",a.customRedirectUri||this.redirectUri);if(!this.disablePKCE){let d;d=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("PKCE_verifier"):this._storage.getItem("PKCE_verifier"),d?u=u.set("code_verifier",d):console.warn("No PKCE verifier found in oauth storage!")}return this.fetchAndProcessToken(u,a)}fetchAndProcessToken(o,a){a=a||{},this.assertUrlNotNullAndCorrectProtocol(this.tokenEndpoint,"tokenEndpoint");let u=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.WM).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const d=btoa(`${this.clientId}:${this.dummyClientSecret}`);u=u.set("Authorization","Basic "+d)}return this.useHttpBasicAuth||(o=o.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(o=o.set("client_secret",this.dummyClientSecret)),new Promise((d,m)=>{if(this.customQueryParams)for(let g of Object.getOwnPropertyNames(this.customQueryParams))o=o.set(g,this.customQueryParams[g]);this.http.post(this.tokenEndpoint,o,{headers:u}).subscribe(g=>{this.debug("refresh tokenResponse",g),this.storeAccessTokenResponse(g.access_token,g.refresh_token,g.expires_in||this.fallbackAccessTokenExpirationTimeInSec,g.scope,this.extractRecognizedCustomParameters(g)),this.oidc&&g.id_token?this.processIdToken(g.id_token,g.access_token,a.disableNonceCheck).then(S=>{this.storeIdToken(S),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),d(g)}).catch(S=>{this.eventsSubject.next(new OAuthErrorEvent("token_validation_error",S)),console.error("Error validating tokens"),console.error(S),m(S)}):(this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.eventsSubject.next(new OAuthSuccessEvent("token_refreshed")),d(g))},g=>{console.error("Error getting token",g),this.eventsSubject.next(new OAuthErrorEvent("token_refresh_error",g)),m(g)})})}tryLoginImplicitFlow(o=null){let a;a=(o=o||{}).customHashFragment?this.urlHelper.getHashFragmentParams(o.customHashFragment):this.urlHelper.getHashFragmentParams(),this.debug("parsed url",a);const u=a.state;let[d,m]=this.parseState(u);if(this.state=m,a.error){this.debug("error trying to login"),this.handleLoginError(o,a);const A=new OAuthErrorEvent("token_error",{},a);return this.eventsSubject.next(A),Promise.reject(A)}const g=a.access_token,S=a.id_token,F=a.session_state,W=a.scope;if(!this.requestAccessToken&&!this.oidc)return Promise.reject("Either requestAccessToken or oidc (or both) must be true.");if(this.requestAccessToken&&!g||this.requestAccessToken&&!o.disableOAuth2StateCheck&&!u||this.oidc&&!S)return Promise.resolve(!1);if(this.sessionChecksEnabled&&!F&&this.logger.warn("session checks (Session Status Change Notification) were activated in the configuration but the id_token does not contain a session_state claim"),this.requestAccessToken&&!o.disableNonceCheck&&!this.validateNonce(d)){const B=new OAuthErrorEvent("invalid_nonce_in_state",null);return this.eventsSubject.next(B),Promise.reject(B)}return this.requestAccessToken&&this.storeAccessTokenResponse(g,null,a.expires_in||this.fallbackAccessTokenExpirationTimeInSec,W),this.oidc?this.processIdToken(S,g,o.disableNonceCheck).then(A=>o.validationHandler?o.validationHandler({accessToken:g,idClaims:A.idTokenClaims,idToken:A.idToken,state:u}).then(B=>A):A).then(A=>(this.storeIdToken(A),this.storeSessionState(F),this.clearHashAfterLogin&&!o.preventClearHashAfterLogin&&this.clearLocationHash(),this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.callOnTokenReceivedIfExists(o),this.inImplicitFlow=!1,!0)).catch(A=>(this.eventsSubject.next(new OAuthErrorEvent("token_validation_error",A)),this.logger.error("Error validating tokens"),this.logger.error(A),Promise.reject(A))):(this.eventsSubject.next(new OAuthSuccessEvent("token_received")),this.clearHashAfterLogin&&!o.preventClearHashAfterLogin&&this.clearLocationHash(),this.callOnTokenReceivedIfExists(o),Promise.resolve(!0))}parseState(o){let a=o,u="";if(o){const d=o.indexOf(this.config.nonceStateSeparator);d>-1&&(a=o.substr(0,d),u=o.substr(d+this.config.nonceStateSeparator.length))}return[a,u]}validateNonce(o){let a;return a=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("nonce"):this._storage.getItem("nonce"),a===o||(console.error("Validating access_token failed, wrong state/nonce.",a,o),!1)}storeIdToken(o){this._storage.setItem("id_token",o.idToken),this._storage.setItem("id_token_claims_obj",o.idTokenClaimsJson),this._storage.setItem("id_token_expires_at",""+o.idTokenExpiresAt),this._storage.setItem("id_token_stored_at",""+this.dateTimeService.now())}storeSessionState(o){this._storage.setItem("session_state",o)}getSessionState(){return this._storage.getItem("session_state")}handleLoginError(o,a){o.onLoginError&&o.onLoginError(a),this.clearHashAfterLogin&&!o.preventClearHashAfterLogin&&this.clearLocationHash()}getClockSkewInMsec(o=6e5){return this.clockSkewInSec?1e3*this.clockSkewInSec:o}processIdToken(o,a,u=!1){const d=o.split("."),g=b64DecodeUnicode(this.padBase64(d[0])),S=JSON.parse(g),W=b64DecodeUnicode(this.padBase64(d[1])),A=JSON.parse(W);let B;if(B=this.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.getItem("nonce"):this._storage.getItem("nonce"),Array.isArray(A.aud)){if(A.aud.every(M=>M!==this.clientId)){const M="Wrong audience: "+A.aud.join(",");return this.logger.warn(M),Promise.reject(M)}}else if(A.aud!==this.clientId){const M="Wrong audience: "+A.aud;return this.logger.warn(M),Promise.reject(M)}if(!A.sub){const M="No sub claim in id_token";return this.logger.warn(M),Promise.reject(M)}if(this.sessionChecksEnabled&&this.silentRefreshSubject&&this.silentRefreshSubject!==A.sub){const M=`After refreshing, we got an id_token for another user (sub). Expected sub: ${this.silentRefreshSubject}, received sub: ${A.sub}`;return this.logger.warn(M),Promise.reject(M)}if(!A.iat){const M="No iat claim in id_token";return this.logger.warn(M),Promise.reject(M)}if(!this.skipIssuerCheck&&A.iss!==this.issuer){const M="Wrong issuer: "+A.iss;return this.logger.warn(M),Promise.reject(M)}if(!u&&A.nonce!==B){const M="Wrong nonce: "+A.nonce;return this.logger.warn(M),Promise.reject(M)}if(this.hasOwnProperty("responseType")&&("code"===this.responseType||"id_token"===this.responseType)&&(this.disableAtHashCheck=!0),!this.disableAtHashCheck&&this.requestAccessToken&&!A.at_hash){const M="An at_hash is needed!";return this.logger.warn(M),Promise.reject(M)}const N=this.dateTimeService.now(),b=1e3*A.iat,f=1e3*A.exp,C=this.getClockSkewInMsec();if(b-C>=N||f+C<=N){const M="Token has expired";return console.error(M),console.error({now:N,issuedAtMSec:b,expiresAtMSec:f}),Promise.reject(M)}const H={accessToken:a,idToken:o,jwks:this.jwks,idTokenClaims:A,idTokenHeader:S,loadKeys:()=>this.loadJwks()};return this.disableAtHashCheck?this.checkSignature(H).then(M=>({idToken:o,idTokenClaims:A,idTokenClaimsJson:W,idTokenHeader:S,idTokenHeaderJson:g,idTokenExpiresAt:f})):this.checkAtHash(H).then(M=>{if(!this.disableAtHashCheck&&this.requestAccessToken&&!M){const re="Wrong at_hash";return this.logger.warn(re),Promise.reject(re)}return this.checkSignature(H).then(re=>{const te={idToken:o,idTokenClaims:A,idTokenClaimsJson:W,idTokenHeader:S,idTokenHeaderJson:g,idTokenExpiresAt:f};return this.disableAtHashCheck?te:this.checkAtHash(H).then(G=>{if(this.requestAccessToken&&!G){const L="Wrong at_hash";return this.logger.warn(L),Promise.reject(L)}return te})})})}getIdentityClaims(){const o=this._storage.getItem("id_token_claims_obj");return o?JSON.parse(o):null}getGrantedScopes(){const o=this._storage.getItem("granted_scopes");return o?JSON.parse(o):null}getIdToken(){return this._storage?this._storage.getItem("id_token"):null}padBase64(o){for(;o.length%4!=0;)o+="=";return o}getAccessToken(){return this._storage?this._storage.getItem("access_token"):null}getRefreshToken(){return this._storage?this._storage.getItem("refresh_token"):null}getAccessTokenExpiration(){return this._storage.getItem("expires_at")?parseInt(this._storage.getItem("expires_at"),10):null}getAccessTokenStoredAt(){return parseInt(this._storage.getItem("access_token_stored_at"),10)}getIdTokenStoredAt(){return parseInt(this._storage.getItem("id_token_stored_at"),10)}getIdTokenExpiration(){return this._storage.getItem("id_token_expires_at")?parseInt(this._storage.getItem("id_token_expires_at"),10):null}hasValidAccessToken(){if(this.getAccessToken()){const o=this._storage.getItem("expires_at"),a=this.dateTimeService.new();return!(o&&parseInt(o,10)<a.getTime()-this.getClockSkewInMsec())}return!1}hasValidIdToken(){if(this.getIdToken()){const o=this._storage.getItem("id_token_expires_at"),a=this.dateTimeService.new();return!(o&&parseInt(o,10)<a.getTime()-this.getClockSkewInMsec())}return!1}getCustomTokenResponseProperty(o){return this._storage&&this.config.customTokenParameters&&this.config.customTokenParameters.indexOf(o)>=0&&null!==this._storage.getItem(o)?JSON.parse(this._storage.getItem(o)):null}authorizationHeader(){return"Bearer "+this.getAccessToken()}logOut(o={},a=""){let u=!1;"boolean"==typeof o&&(u=o,o={});const d=this.getIdToken();if(this._storage.removeItem("access_token"),this._storage.removeItem("id_token"),this._storage.removeItem("refresh_token"),this.saveNoncesInLocalStorage?(localStorage.removeItem("nonce"),localStorage.removeItem("PKCE_verifier")):(this._storage.removeItem("nonce"),this._storage.removeItem("PKCE_verifier")),this._storage.removeItem("expires_at"),this._storage.removeItem("id_token_claims_obj"),this._storage.removeItem("id_token_expires_at"),this._storage.removeItem("id_token_stored_at"),this._storage.removeItem("access_token_stored_at"),this._storage.removeItem("granted_scopes"),this._storage.removeItem("session_state"),this.config.customTokenParameters&&this.config.customTokenParameters.forEach(g=>this._storage.removeItem(g)),this.silentRefreshSubject=null,this.eventsSubject.next(new OAuthInfoEvent("logout")),!this.logoutUrl||u||!d&&!this.postLogoutRedirectUri)return;let m;if(!this.validateUrlForHttps(this.logoutUrl))throw new Error("logoutUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");if(this.logoutUrl.indexOf("{{")>-1)m=this.logoutUrl.replace(/\{\{id_token\}\}/,encodeURIComponent(d)).replace(/\{\{client_id\}\}/,encodeURIComponent(this.clientId));else{let g=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.LE({encoder:new WebHttpUrlEncodingCodec});d&&(g=g.set("id_token_hint",d));const S=this.postLogoutRedirectUri||this.redirectUriAsPostLogoutRedirectUriFallback&&this.redirectUri||"";S&&(g=g.set("post_logout_redirect_uri",S),a&&(g=g.set("state",a)));for(let F in o)g=g.set(F,o[F]);m=this.logoutUrl+(this.logoutUrl.indexOf("?")>-1?"&":"?")+g.toString()}this.config.openUri(m)}createAndSaveNonce(){const o=this;return this.createNonce().then(function(a){return o.saveNoncesInLocalStorage&&void 0!==window.localStorage?localStorage.setItem("nonce",a):o._storage.setItem("nonce",a),a})}ngOnDestroy(){this.clearAccessTokenTimer(),this.clearIdTokenTimer(),this.removeSilentRefreshEventListener();const o=this.document.getElementById(this.silentRefreshIFrameName);o&&o.remove(),this.stopSessionCheckTimer(),this.removeSessionCheckEventListener();const a=this.document.getElementById(this.sessionCheckIFrameName);a&&a.remove()}createNonce(){return new Promise(o=>{if(this.rngUrl)throw new Error("createNonce with rng-web-api has not been implemented so far");const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let u=45,d="";const m="undefined"==typeof self?null:self.crypto||self.msCrypto;if(m){let g=new Uint8Array(u);m.getRandomValues(g),g.map||(g.map=Array.prototype.map),g=g.map(S=>a.charCodeAt(S%a.length)),d=String.fromCharCode.apply(null,g)}else for(;0<u--;)d+=a[Math.random()*a.length|0];o(base64UrlEncode(d))})}checkAtHash(o){return(0,tslib__WEBPACK_IMPORTED_MODULE_2__.mG)(this,void 0,void 0,function*(){return this.tokenValidationHandler?this.tokenValidationHandler.validateAtHash(o):(this.logger.warn("No tokenValidationHandler configured. Cannot check at_hash."),!0)})}checkSignature(o){return this.tokenValidationHandler?this.tokenValidationHandler.validateSignature(o):(this.logger.warn("No tokenValidationHandler configured. Cannot check signature."),Promise.resolve(null))}initLoginFlow(o="",a={}){return"code"===this.responseType?this.initCodeFlow(o,a):this.initImplicitFlow(o,a)}initCodeFlow(o="",a={}){""!==this.loginUrl?this.initCodeFlowInternal(o,a):this.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(u=>"discovery_document_loaded"===u.type)).subscribe(u=>this.initCodeFlowInternal(o,a))}initCodeFlowInternal(o="",a={}){if(!this.validateUrlForHttps(this.loginUrl))throw new Error("loginUrl  must use HTTPS (with TLS), or config value for property 'requireHttps' must be set to 'false' and allow HTTP (without TLS).");let u={},d=null;"string"==typeof a?d=a:"object"==typeof a&&(u=a),this.createLoginUrl(o,d,null,!1,u).then(this.config.openUri).catch(m=>{console.error("Error in initAuthorizationCodeFlow"),console.error(m)})}createChallangeVerifierPairForPKCE(){return(0,tslib__WEBPACK_IMPORTED_MODULE_2__.mG)(this,void 0,void 0,function*(){if(!this.crypto)throw new Error("PKCE support for code flow needs a CryptoHander. Did you import the OAuthModule using forRoot() ?");const o=yield this.createNonce();return[base64UrlEncode(yield this.crypto.calcHash(o,"sha-256")),o]})}extractRecognizedCustomParameters(o){let a=new Map;return this.config.customTokenParameters&&this.config.customTokenParameters.forEach(u=>{o[u]&&a.set(u,JSON.stringify(o[u]))}),a}revokeTokenAndLogout(o={},a=!1){let u=this.revocationEndpoint,d=this.getAccessToken(),m=this.getRefreshToken();if(!d)return;let g=new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.LE({encoder:new WebHttpUrlEncodingCodec}),S=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_9__.WM).set("Content-Type","application/x-www-form-urlencoded");if(this.useHttpBasicAuth){const F=btoa(`${this.clientId}:${this.dummyClientSecret}`);S=S.set("Authorization","Basic "+F)}if(this.useHttpBasicAuth||(g=g.set("client_id",this.clientId)),!this.useHttpBasicAuth&&this.dummyClientSecret&&(g=g.set("client_secret",this.dummyClientSecret)),this.customQueryParams)for(const F of Object.getOwnPropertyNames(this.customQueryParams))g=g.set(F,this.customQueryParams[F]);return new Promise((F,W)=>{let A,B;if(d){let N=g.set("token",d).set("token_type_hint","access_token");A=this.http.post(u,N,{headers:S})}else A=(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(null);if(m){let N=g.set("token",m).set("token_type_hint","refresh_token");B=this.http.post(u,N,{headers:S})}else B=(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(null);a&&(A=A.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(N=>0===N.status?(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(null):(0,rxjs__WEBPACK_IMPORTED_MODULE_16__._)(N))),B=B.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(N=>0===N.status?(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(null):(0,rxjs__WEBPACK_IMPORTED_MODULE_16__._)(N)))),(0,rxjs__WEBPACK_IMPORTED_MODULE_17__.aj)([A,B]).subscribe(N=>{this.logOut(o),F(N),this.logger.info("Token successfully revoked")},N=>{this.logger.error("Error revoking token",N),this.eventsSubject.next(new OAuthErrorEvent("token_revoke_error",N)),W(N)})})}clearLocationHash(){""!=location.hash&&(location.hash="")}}return _.\u0275fac=function(o){return new(o||_)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(_angular_core__WEBPACK_IMPORTED_MODULE_1__.NgZone),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(_angular_common_http__WEBPACK_IMPORTED_MODULE_9__.eN),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(OAuthStorage,8),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(ValidationHandler,8),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(AuthConfig,8),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(UrlHelperService),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(OAuthLogger),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(HashHandler,8),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(_angular_common__WEBPACK_IMPORTED_MODULE_18__.K0),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(DateTimeProvider))},_.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac}),_})();class OAuthModuleConfig{}class OAuthResourceServerConfig{}class OAuthResourceServerErrorHandler{}class OAuthNoopResourceServerErrorHandler{handleError(E){return(0,rxjs__WEBPACK_IMPORTED_MODULE_16__._)(E)}}let DefaultOAuthInterceptor=(()=>{class _{constructor(o,a,u){this.oAuthService=o,this.errorHandler=a,this.moduleConfig=u}checkUrl(o){return this.moduleConfig.resourceServer.customUrlValidation?this.moduleConfig.resourceServer.customUrlValidation(o):!this.moduleConfig.resourceServer.allowedUrls||!!this.moduleConfig.resourceServer.allowedUrls.find(a=>o.toLowerCase().startsWith(a.toLowerCase()))}intercept(o,a){const u=o.url.toLowerCase();return this.moduleConfig&&this.moduleConfig.resourceServer&&this.checkUrl(u)?this.moduleConfig.resourceServer.sendAccessToken?(0,rxjs__WEBPACK_IMPORTED_MODULE_19__.T)((0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(this.oAuthService.getAccessToken()).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(m=>!!m)),this.oAuthService.events.pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_4__.h)(m=>"token_received"===m.type),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_20__.V)(this.oAuthService.waitForTokenInMsec||0),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(m=>(0,rxjs__WEBPACK_IMPORTED_MODULE_7__.of)(null)),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_12__.U)(m=>this.oAuthService.getAccessToken()))).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_21__.q)(1),(0,rxjs_operators__WEBPACK_IMPORTED_MODULE_22__.zg)(m=>{if(m){const S=o.headers.set("Authorization","Bearer "+m);o=o.clone({headers:S})}return a.handle(o).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(g=>this.errorHandler.handleError(g)))})):a.handle(o).pipe((0,rxjs_operators__WEBPACK_IMPORTED_MODULE_15__.K)(m=>this.errorHandler.handleError(m))):a.handle(o)}}return _.\u0275fac=function(o){return new(o||_)(_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(OAuthService),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(OAuthResourceServerErrorHandler),_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275inject(OAuthModuleConfig,8))},_.\u0275prov=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineInjectable({token:_,factory:_.\u0275fac}),_})();class NullValidationHandler{validateSignature(E){return Promise.resolve(null)}validateAtHash(E){return Promise.resolve(!0)}}function createDefaultLogger(){return console}function createDefaultStorage(){return"undefined"!=typeof sessionStorage?sessionStorage:new MemoryStorage}let OAuthModule=(()=>{class _{static forRoot(o=null,a=NullValidationHandler){return{ngModule:_,providers:[OAuthService,UrlHelperService,{provide:OAuthLogger,useFactory:createDefaultLogger},{provide:OAuthStorage,useFactory:createDefaultStorage},{provide:ValidationHandler,useClass:a},{provide:HashHandler,useClass:DefaultHashHandler},{provide:OAuthResourceServerErrorHandler,useClass:OAuthNoopResourceServerErrorHandler},{provide:OAuthModuleConfig,useValue:o},{provide:_angular_common_http__WEBPACK_IMPORTED_MODULE_9__.TP,useClass:DefaultOAuthInterceptor,multi:!0},{provide:DateTimeProvider,useClass:SystemDateTimeProvider}]}}}return _.\u0275fac=function(o){return new(o||_)},_.\u0275mod=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineNgModule({type:_}),_.\u0275inj=_angular_core__WEBPACK_IMPORTED_MODULE_1__.\u0275\u0275defineInjector({imports:[[_angular_common__WEBPACK_IMPORTED_MODULE_18__.ez]]}),_})();const err="PLEASE READ THIS CAREFULLY:\n\nBeginning with angular-oauth2-oidc version 9, the JwksValidationHandler\nhas been moved to an library of its own. If you need it for implementing\nOAuth2/OIDC **implicit flow**, please install it using npm:\n\n  npm i angular-oauth2-oidc-jwks --save\n\nAfter that, you can import it into your application:\n\n  import { JwksValidationHandler } from 'angular-oauth2-oidc-jwks';\n\nPlease note, that this dependency is not needed for the **code flow**,\nwhich is nowadays the **recommented** one for single page applications.\nThis also results in smaller bundle sizes.\n";class JwksValidationHandler extends NullValidationHandler{constructor(){super(),console.error(err)}}const AUTH_CONFIG=new _angular_core__WEBPACK_IMPORTED_MODULE_1__.InjectionToken("AUTH_CONFIG")},1302:function(_,E,o){var a;!function(u,d){var m={};!function(u){"use strict";u.__esModule=!0,u.digestLength=32,u.blockSize=64;var d=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function m(f,C,H,M,re){for(var ce,te,G,L,x,Ce,Pe,fe,Te,O,U,k,I;re>=64;){for(ce=C[0],te=C[1],G=C[2],L=C[3],x=C[4],Ce=C[5],Pe=C[6],fe=C[7],O=0;O<16;O++)f[O]=(255&H[U=M+4*O])<<24|(255&H[U+1])<<16|(255&H[U+2])<<8|255&H[U+3];for(O=16;O<64;O++)f[O]=((k=((Te=f[O-2])>>>17|Te<<15)^(Te>>>19|Te<<13)^Te>>>10)+f[O-7]|0)+((I=((Te=f[O-15])>>>7|Te<<25)^(Te>>>18|Te<<14)^Te>>>3)+f[O-16]|0);for(O=0;O<64;O++)k=(((x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7))+(x&Ce^~x&Pe)|0)+(fe+(d[O]+f[O]|0)|0)|0,I=((ce>>>2|ce<<30)^(ce>>>13|ce<<19)^(ce>>>22|ce<<10))+(ce&te^ce&G^te&G)|0,fe=Pe,Pe=Ce,Ce=x,x=L+k|0,L=G,G=te,te=ce,ce=k+I|0;C[0]+=ce,C[1]+=te,C[2]+=G,C[3]+=L,C[4]+=x,C[5]+=Ce,C[6]+=Pe,C[7]+=fe,M+=64,re-=64}return M}var g=function(){function f(){this.digestLength=u.digestLength,this.blockSize=u.blockSize,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}return f.prototype.reset=function(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this},f.prototype.clean=function(){for(var C=0;C<this.buffer.length;C++)this.buffer[C]=0;for(C=0;C<this.temp.length;C++)this.temp[C]=0;this.reset()},f.prototype.update=function(C,H){if(void 0===H&&(H=C.length),this.finished)throw new Error("SHA256: can't update because hash was finished.");var M=0;if(this.bytesHashed+=H,this.bufferLength>0){for(;this.bufferLength<64&&H>0;)this.buffer[this.bufferLength++]=C[M++],H--;64===this.bufferLength&&(m(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(H>=64&&(M=m(this.temp,this.state,C,M,H),H%=64);H>0;)this.buffer[this.bufferLength++]=C[M++],H--;return this},f.prototype.finish=function(C){if(!this.finished){var H=this.bytesHashed,M=this.bufferLength,re=H/536870912|0,ce=H<<3,te=H%64<56?64:128;this.buffer[M]=128;for(var G=M+1;G<te-8;G++)this.buffer[G]=0;this.buffer[te-8]=re>>>24&255,this.buffer[te-7]=re>>>16&255,this.buffer[te-6]=re>>>8&255,this.buffer[te-5]=re>>>0&255,this.buffer[te-4]=ce>>>24&255,this.buffer[te-3]=ce>>>16&255,this.buffer[te-2]=ce>>>8&255,this.buffer[te-1]=ce>>>0&255,m(this.temp,this.state,this.buffer,0,te),this.finished=!0}for(G=0;G<8;G++)C[4*G+0]=this.state[G]>>>24&255,C[4*G+1]=this.state[G]>>>16&255,C[4*G+2]=this.state[G]>>>8&255,C[4*G+3]=this.state[G]>>>0&255;return this},f.prototype.digest=function(){var C=new Uint8Array(this.digestLength);return this.finish(C),C},f.prototype._saveState=function(C){for(var H=0;H<this.state.length;H++)C[H]=this.state[H]},f.prototype._restoreState=function(C,H){for(var M=0;M<this.state.length;M++)this.state[M]=C[M];this.bytesHashed=H,this.finished=!1,this.bufferLength=0},f}();u.Hash=g;var S=function(){function f(C){this.inner=new g,this.outer=new g,this.blockSize=this.inner.blockSize,this.digestLength=this.inner.digestLength;var H=new Uint8Array(this.blockSize);if(C.length>this.blockSize)(new g).update(C).finish(H).clean();else for(var M=0;M<C.length;M++)H[M]=C[M];for(M=0;M<H.length;M++)H[M]^=54;for(this.inner.update(H),M=0;M<H.length;M++)H[M]^=106;for(this.outer.update(H),this.istate=new Uint32Array(8),this.ostate=new Uint32Array(8),this.inner._saveState(this.istate),this.outer._saveState(this.ostate),M=0;M<H.length;M++)H[M]=0}return f.prototype.reset=function(){return this.inner._restoreState(this.istate,this.inner.blockSize),this.outer._restoreState(this.ostate,this.outer.blockSize),this},f.prototype.clean=function(){for(var C=0;C<this.istate.length;C++)this.ostate[C]=this.istate[C]=0;this.inner.clean(),this.outer.clean()},f.prototype.update=function(C){return this.inner.update(C),this},f.prototype.finish=function(C){return this.outer.finished?this.outer.finish(C):(this.inner.finish(C),this.outer.update(C,this.digestLength).finish(C)),this},f.prototype.digest=function(){var C=new Uint8Array(this.digestLength);return this.finish(C),C},f}();function F(f){var C=(new g).update(f),H=C.digest();return C.clean(),H}function W(f,C){var H=new S(f).update(C),M=H.digest();return H.clean(),M}function A(f,C,H,M){var re=M[0];if(0===re)throw new Error("hkdf: cannot expand more");C.reset(),re>1&&C.update(f),H&&C.update(H),C.update(M),C.finish(f),M[0]++}u.HMAC=S,u.hash=F,u.default=F,u.hmac=W;var B=new Uint8Array(u.digestLength);u.hkdf=function(f,C,H,M){void 0===C&&(C=B),void 0===M&&(M=32);for(var re=new Uint8Array([1]),ce=W(C,f),te=new S(ce),G=new Uint8Array(te.digestLength),L=G.length,x=new Uint8Array(M),Ce=0;Ce<M;Ce++)L===G.length&&(A(G,te,H,re),L=0),x[Ce]=G[L++];return te.clean(),G.fill(0),re.fill(0),x},u.pbkdf2=function(f,C,H,M){for(var re=new S(f),ce=re.digestLength,te=new Uint8Array(4),G=new Uint8Array(ce),L=new Uint8Array(ce),x=new Uint8Array(M),Ce=0;Ce*ce<M;Ce++){var Pe=Ce+1;te[0]=Pe>>>24&255,te[1]=Pe>>>16&255,te[2]=Pe>>>8&255,te[3]=Pe>>>0&255,re.reset(),re.update(C),re.update(te),re.finish(L);for(var fe=0;fe<ce;fe++)G[fe]=L[fe];for(fe=2;fe<=H;fe++){re.reset(),re.update(L).finish(L);for(var Te=0;Te<ce;Te++)G[Te]^=L[Te]}for(fe=0;fe<ce&&Ce*ce+fe<M;fe++)x[Ce*ce+fe]=G[fe]}for(Ce=0;Ce<ce;Ce++)G[Ce]=L[Ce]=0;for(Ce=0;Ce<4;Ce++)te[Ce]=0;return re.clean(),x}}(m);var g=m.default;for(var S in m)g[S]=m[S];"object"==typeof _.exports?_.exports=g:void 0!==(a=function(){return g}.call(m,o,m,_))&&(_.exports=a)}()},11405:(_,E,o)=>{"use strict";o.d(E,{e7:()=>N,YC:()=>B});var a=o(6435),d=(o(34182),o(69808));let g=(()=>{class b{constructor(C){this.zone=C,this.windowGrecaptcha="grecaptcha",this.windowOnLoadCallbackProperty="ngx_captcha_onload_callback",this.globalDomain="recaptcha.net",this.defaultDomain="google.com"}registerCaptchaScript(C,H,M,re){if(this.grecaptchaScriptLoaded())return void this.zone.run(()=>{M(window[this.windowGrecaptcha])});window[this.windowOnLoadCallbackProperty]=()=>this.zone.run(M.bind(this,window[this.windowGrecaptcha]));const ce=document.createElement("script");ce.innerHTML="",ce.src=this.getCaptchaScriptUrl(C,H,re),ce.async=!0,ce.defer=!0,document.getElementsByTagName("head")[0].appendChild(ce)}cleanup(){window[this.windowOnLoadCallbackProperty]=void 0,window[this.windowGrecaptcha]=void 0}grecaptchaScriptLoaded(){return!(!window[this.windowOnLoadCallbackProperty]||!window[this.windowGrecaptcha])}getLanguageParam(C){return C?`&hl=${C}`:""}getCaptchaScriptUrl(C,H,M){return`https://www.${C?this.globalDomain:this.defaultDomain}/recaptcha/api.js?onload=${this.windowOnLoadCallbackProperty}&render=${H}${this.getLanguageParam(M)}`}}return b.\u0275fac=function(C){return new(C||b)(a.\u0275\u0275inject(a.NgZone))},b.\u0275prov=a.\u0275\u0275defineInjectable({token:b,factory:b.\u0275fac}),b})(),B=(()=>{class b{constructor(C,H){this.scriptService=C,this.zone=H}execute(C,H,M,re,ce){this.executeAsPromise(C,H,re).then(M).catch(te=>ce?ce(te):console.error(te))}executeAsPromise(C,H,M){return new Promise((re,ce)=>{this.scriptService.registerCaptchaScript(!(!M||!M.useGlobalDomain),C,L=>{this.zone.runOutsideAngular(()=>{try{L.execute(C,{action:H}).then(x=>this.zone.run(()=>re(x)))}catch(x){ce(x)}})})})}}return b.\u0275fac=function(C){return new(C||b)(a.\u0275\u0275inject(g),a.\u0275\u0275inject(a.NgZone))},b.\u0275prov=a.\u0275\u0275defineInjectable({token:b,factory:b.\u0275fac}),b})(),N=(()=>{class b{}return b.\u0275fac=function(C){return new(C||b)},b.\u0275mod=a.\u0275\u0275defineNgModule({type:b}),b.\u0275inj=a.\u0275\u0275defineInjector({providers:[g,B],imports:[[d.ez]]}),b})()},61946:(_,E,o)=>{"use strict";o.d(E,{S3:()=>g});var a=o(66688),u=o(33009),d=o(826),m=o(40448);function g(...W){if(1===W.length){if(!(0,a.k)(W[0]))return W[0];W=W[0]}return(0,u.n)(W,void 0).lift(new S)}class S{call(A,B){return B.subscribe(new F(A))}}class F extends d.L{constructor(A){super(A),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}_next(A){this.observables.push(A)}_complete(){const A=this.observables,B=A.length;if(0===B)this.destination.complete();else{for(let N=0;N<B&&!this.hasFirst;N++){const f=(0,m.D)(this,A[N],void 0,N);this.subscriptions&&this.subscriptions.push(f),this.add(f)}this.observables=null}}notifyNext(A,B,N){if(!this.hasFirst){this.hasFirst=!0;for(let b=0;b<this.subscriptions.length;b++)if(b!==N){let f=this.subscriptions[b];f.unsubscribe(),this.remove(f)}this.subscriptions=null}this.destination.next(B)}}},40943:(_,E,o)=>{"use strict";o.d(E,{g:()=>g});var a=o(20353),u=o(82697),d=o(43489),m=o(29312);function g(A,B=a.P){const b=(0,u.J)(A)?+A-B.now():Math.abs(A);return f=>f.lift(new S(b,B))}class S{constructor(B,N){this.delay=B,this.scheduler=N}call(B,N){return N.subscribe(new F(B,this.delay,this.scheduler))}}class F extends d.L{constructor(B,N,b){super(B),this.delay=N,this.scheduler=b,this.queue=[],this.active=!1,this.errored=!1}static dispatch(B){const N=B.source,b=N.queue,f=B.scheduler,C=B.destination;for(;b.length>0&&b[0].time-f.now()<=0;)b.shift().notification.observe(C);if(b.length>0){const H=Math.max(0,b[0].time-f.now());this.schedule(B,H)}else this.unsubscribe(),N.active=!1}_schedule(B){this.active=!0,this.destination.add(B.schedule(F.dispatch,this.delay,{source:this,destination:this.destination,scheduler:B}))}scheduleNotification(B){if(!0===this.errored)return;const N=this.scheduler,b=new W(N.now()+this.delay,B);this.queue.push(b),!1===this.active&&this._schedule(N)}_next(B){this.scheduleNotification(m.P.createNext(B))}_error(B){this.errored=!0,this.queue=[],this.destination.error(B),this.unsubscribe()}_complete(){this.scheduleNotification(m.P.createComplete()),this.unsubscribe()}}class W{constructor(B,N){this.time=B,this.notification=N}}},46227:(_,E,o)=>{"use strict";o.d(E,{V:()=>B});var a=o(20353);const d=(()=>{function N(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return N.prototype=Object.create(Error.prototype),N})();var m=o(82697),g=o(41177);class F{constructor(b,f,C,H){this.waitFor=b,this.absoluteTimeout=f,this.withObservable=C,this.scheduler=H}call(b,f){return f.subscribe(new W(b,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))}}class W extends g.Ds{constructor(b,f,C,H,M){super(b),this.absoluteTimeout=f,this.waitFor=C,this.withObservable=H,this.scheduler=M,this.scheduleTimeout()}static dispatchTimeout(b){const{withObservable:f}=b;b._unsubscribeAndRecycle(),b.add((0,g.ft)(f,new g.IY(b)))}scheduleTimeout(){const{action:b}=this;b?this.action=b.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(W.dispatchTimeout,this.waitFor,this))}_next(b){this.absoluteTimeout||this.scheduleTimeout(),super._next(b)}_unsubscribe(){this.action=void 0,this.scheduler=null,this.withObservable=null}}var A=o(61737);function B(N,b=a.P){return function(N,b,f=a.P){return C=>{let H=(0,m.J)(N),M=H?+N-f.now():Math.abs(N);return C.lift(new F(M,H,b,f))}}(N,(0,A._)(new d),b)}},82697:(_,E,o)=>{"use strict";function a(u){return u instanceof Date&&!isNaN(+u)}o.d(E,{J:()=>a})},65168:(_,E,o)=>{"use strict";function W(O,U,k,I){return new(k||(k=Promise))(function(z,y){function ve(ge){try{se(I.next(ge))}catch(He){y(He)}}function Ae(ge){try{se(I.throw(ge))}catch(He){y(He)}}function se(ge){ge.done?z(ge.value):function(z){return z instanceof k?z:new k(function(y){y(z)})}(ge.value).then(ve,Ae)}se((I=I.apply(O,U||[])).next())})}o.d(E,{mG:()=>W})}}]);